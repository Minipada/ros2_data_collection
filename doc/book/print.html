<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js navy">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Data Collection for ROS 2</title>
        <meta name="robots" content="noindex" />


        <!-- Custom HTML head -->
        
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="open-in.css">
        <link rel="stylesheet" href="./css/mdbook-admonish.css">

    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "navy";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('navy')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item "><a href="dc/introduction.html"><strong aria-hidden="true">1.</strong> Introduction</a></li><li class="chapter-item "><a href="dc/build.html"><strong aria-hidden="true">2.</strong> Build</a></li><li class="chapter-item "><a href="dc/getting_started.html"><strong aria-hidden="true">3.</strong> Getting Started</a></li><li class="chapter-item "><a href="dc/measurements.html"><strong aria-hidden="true">4.</strong> Measurements</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="dc/measurements/camera.html"><strong aria-hidden="true">4.1.</strong> Camera</a></li><li class="chapter-item "><a href="dc/measurements/cmd_vel.html"><strong aria-hidden="true">4.2.</strong> Command velocity</a></li><li class="chapter-item "><a href="dc/measurements/cpu.html"><strong aria-hidden="true">4.3.</strong> CPU</a></li><li class="chapter-item "><a href="dc/measurements/distance_traveled.html"><strong aria-hidden="true">4.4.</strong> Distance traveled</a></li><li class="chapter-item "><a href="dc/measurements/ip_camera.html"><strong aria-hidden="true">4.5.</strong> IP Camera</a></li><li class="chapter-item "><a href="dc/measurements/map.html"><strong aria-hidden="true">4.6.</strong> Map</a></li><li class="chapter-item "><a href="dc/measurements/memory.html"><strong aria-hidden="true">4.7.</strong> Memory</a></li><li class="chapter-item "><a href="dc/measurements/network.html"><strong aria-hidden="true">4.8.</strong> Network</a></li><li class="chapter-item "><a href="dc/measurements/os.html"><strong aria-hidden="true">4.9.</strong> OS</a></li><li class="chapter-item "><a href="dc/measurements/permissions.html"><strong aria-hidden="true">4.10.</strong> Permissions</a></li><li class="chapter-item "><a href="dc/measurements/position.html"><strong aria-hidden="true">4.11.</strong> Position</a></li><li class="chapter-item "><a href="dc/measurements/speed.html"><strong aria-hidden="true">4.12.</strong> Speed</a></li><li class="chapter-item "><a href="dc/measurements/storage.html"><strong aria-hidden="true">4.13.</strong> Storage</a></li><li class="chapter-item "><a href="dc/measurements/string_stamped.html"><strong aria-hidden="true">4.14.</strong> String stamped</a></li><li class="chapter-item "><a href="dc/measurements/uptime.html"><strong aria-hidden="true">4.15.</strong> Uptime</a></li></ol></li><li class="chapter-item "><a href="dc/conditions.html"><strong aria-hidden="true">5.</strong> Conditions</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="dc/conditions/moving.html"><strong aria-hidden="true">5.1.</strong> Moving</a></li></ol></li><li class="chapter-item "><a href="dc/data_validation.html"><strong aria-hidden="true">6.</strong> Data validation</a></li><li class="chapter-item "><a href="dc/groups.html"><strong aria-hidden="true">7.</strong> Groups</a></li><li class="chapter-item "><a href="dc/destinations.html"><strong aria-hidden="true">8.</strong> Destinations</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="dc/destinations/flb_file.html"><strong aria-hidden="true">8.1.</strong> Fluent Bit File</a></li><li class="chapter-item "><a href="dc/destinations/flb_files_metrics.html"><strong aria-hidden="true">8.2.</strong> Fluent Bit Files metrics</a></li><li class="chapter-item "><a href="dc/destinations/flb_http.html"><strong aria-hidden="true">8.3.</strong> Fluent Bit HTTP</a></li><li class="chapter-item "><a href="dc/destinations/flb_kinesis_data_streams.html"><strong aria-hidden="true">8.4.</strong> Fluent Bit AWS Kinesis Data Streams</a></li><li class="chapter-item "><a href="dc/destinations/flb_minio.html"><strong aria-hidden="true">8.5.</strong> Fluent Bit Minio</a></li><li class="chapter-item "><a href="dc/destinations/flb_pgsql.html"><strong aria-hidden="true">8.6.</strong> Fluent Bit PostgresSQL</a></li><li class="chapter-item "><a href="dc/destinations/flb_stdout.html"><strong aria-hidden="true">8.7.</strong> Fluent Bit Stdout</a></li><li class="chapter-item "><a href="dc/destinations/rcl.html"><strong aria-hidden="true">8.8.</strong> RCL</a></li></ol></li><li class="chapter-item "><a href="dc/future/future_work.html"><strong aria-hidden="true">9.</strong> Future Work and Roadmap</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="dc/future/roadmap.html"><strong aria-hidden="true">9.1.</strong> Roadmap</a></li></ol></li><li class="chapter-item "><a href="dc/about_contact.html"><strong aria-hidden="true">10.</strong> About and Contact</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Data Collection for ROS 2</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/brisa-robotics/ros2_data_collection" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="introduction"><a class="header" href="#introduction">Introduction</a></h1>
<p>The DC project aims at integrating data collection pipelines into ROS2. This is meant to plug to existing APIs, for analytics, not for live monitoring (some awesome tools exist already). There is currently no generic ROS based framework used to collect data from ROS based robots that are aimed at being analyzed (ros bags are great for developers but not for other software developers who don't know about ROS). Understanding and improving operations for any type of machine in any environment has become an important reason companies move to autonomous robots. This involves mostly pick and drop and inspection operations. This framework aims at giving the data to create such APIs and dashboards.</p>
<p>DC uses a modular approach, based on <a href="https://index.ros.org/p/pluginlib/">pluginlib</a> and greatly inspired of <a href="https://navigation.ros.org/">Nav2</a> for its architecture. Pluginlib is used to configure which measurements are collected and where the data goes. Measurements and destinations are pluginlib plugins. In addition to pluginlib, all current plugins use <a href="https://fluentbit.io/">Fluent bit</a> in the backend: <em>Fluent Bit is a super fast, lightweight, and highly scalable logging and metrics processor and forwarder. It is the preferred choice for cloud and containerized environments. Developed and interfaced in C, it has already many features we directly can use, especially: high performance, reliability and data integrity (backpressure handling and data buffering in memory and filesystem)</em>.</p>
<h1 id="main-features"><a class="header" href="#main-features">Main features</a></h1>
<ul>
<li>Can set polling interval for each measurement</li>
<li>Data is transported as JSON through ROS messages</li>
<li>Each measurement data can be validated through JSON schemas (based on <a href="https://json-schema.org/draft-07/json-schema-release-notes.html">JSON schema 07</a>)</li>
<li>Adding a new measurement or destination requires only to add a plugin</li>
<li>Can also get from any ROS topics if published as a StringStamped message, then use the StringStamped plugin</li>
<li>Can exclude JSON fields for each measurement</li>
<li>Data can be collected on conditions, e.g the robot is moving. Conditions are also plugins in the measurement node</li>
<li>Data collection can be triggered if all, any or no condition are met</li>
<li>Can configure number of samples to collect at start and when condition is activated</li>
<li>No 3rd party library to install: All 3rd party libraries have a <a href="https://answers.ros.org/question/332915/what-does-the-_vendor-suffix-mean-in-a-package-name/">vendor</a> package and all python code uses the standard library.</li>
<li>Fluent bit outputs can be added by using the GO or C interface. A Fluent bit plugin needs to be written in this case</li>
<li>Measurements can be grouped using the group node based on the ApproximateTimeSynchronizer</li>
<li>Groups can exclude data</li>
</ul>
<p>Some other features related to some plugins:</p>
<ul>
<li>Data inspection is included in the camera input plugin. Currently, only barcode and QR codes can be analyzed.</li>
</ul>
<p>And inherited from Fluent Bit and ROS2:</p>
<ul>
<li><a href="https://docs.fluentbit.io/manual/v/1.0/configuration/backpressure">Backpressure handling</a></li>
<li><a href="https://docs.fluentbit.io/manual/v/1.0/configuration/buffering">Data buffering in memory and filesystem</a></li>
</ul>
<pre class="mermaid">flowchart LR
    pl_camera1[&quot;Camera bottom&quot;]
    pl_camera2[&quot;Camera middle&quot;]
    pl_camera3[&quot;Camera top&quot;]
    pl_condition_moving[&quot;Moving&quot;]
    pl_cpu[&quot;CPU&quot;]
    pl_cmd_vel[&quot;Command velocity&quot;]
    pl_memory[&quot;Memory&quot;]
    pl_position[&quot;Position&quot;]
    pl_speed[&quot;Speed&quot;]
    pl_storage[&quot;Storage&quot;]
    pl_uptime[&quot;Uptime&quot;]
    pl_network[&quot;Network&quot;]
    pl_network_boot[&quot;Network&quot;]
    pl_os_boot[&quot;OS&quot;]

    subgraph m_n[&quot;Measurement node&quot;]
        subgraph cond[&quot;Condition plugins&quot;]
            pl_condition_moving
        end
        subgraph measurements[&quot;Measurement plugins&quot;]
            pl_camera1
            pl_camera2
            pl_camera3
            pl_cpu
            pl_cmd_vel
            pl_memory
            pl_position
            pl_speed
            pl_storage
            pl_uptime
            pl_network
            pl_network_boot
            pl_os_boot
        end
    end

    subgraph g_n[&quot;Group node&quot;]
        gr_boot_system[&quot;System (boot)&quot;]
        gr_system[&quot;System&quot;]
        gr_robot[&quot;Robot&quot;]
        gr_inspection[&quot;Inspection&quot;]
    end

    subgraph d_n[&quot;Destination node&quot;]
        pl_pgsql[&quot;PostgresSQL&quot;]
        pl_minio[&quot;Minio&quot;]
        pl_s3[&quot;S3&quot;]
    end

    pl_camera1 -- if not --&gt; pl_condition_moving --&gt; gr_inspection
    pl_camera2 -- if not --&gt; pl_condition_moving --&gt; gr_inspection
    pl_camera3 -- if not --&gt; pl_condition_moving --&gt; gr_inspection
    pl_cpu --&gt; gr_system
    pl_memory --&gt; gr_system
    pl_uptime --&gt; gr_boot_system
    pl_network_boot --&gt; gr_boot_system
    pl_os_boot --&gt; gr_boot_system
    pl_storage --&gt; gr_system
    pl_cmd_vel --&gt; gr_robot
    pl_position --&gt; gr_robot
    pl_speed --&gt; gr_robot

    pl_network -- Network ping and online status --&gt; pl_pgsql
    gr_boot_system -- os, network interfaces\n, permissions and uptime --&gt; pl_pgsql
    gr_robot -- Robot cmd_vel, position. speed --&gt; pl_pgsql
    gr_system -- Available space,\n memory used and cpu usage --&gt; pl_pgsql
    gr_inspection -- Image paths on s3 and minio --&gt; pl_pgsql
    gr_inspection -- Raw, rotated and/or inspected images --&gt; pl_minio
    gr_inspection -- Raw, rotated and/or inspected images --&gt; pl_s3
</pre>
<footer id="open-on-gh">Found a bug? <a href="https://github.com/brisa-robotics/ros2_data_collection/edit/main/doc/src/dc/introduction.md">Edit this page on GitHub.</a></footer><div style="break-before: page; page-break-before: always;"></div><h1 id="build"><a class="header" href="#build">Build</a></h1>
<h2 id="download-the-repository"><a class="header" href="#download-the-repository">Download the repository</a></h2>
<p>Given that there is no apt packages available, you will need to build from source.</p>
<p>Download the repository in your workspace</p>
<pre><code class="language-bash">$ git clone github.com/brisa-robotics/ros2_data_collection.git
</code></pre>
<h2 id="install-dependencies"><a class="header" href="#install-dependencies">Install dependencies</a></h2>
<pre><code>$ rosdep install --from-paths src --ignore-src -r -y
</code></pre>
<p>Some packages are external C++ packages but a vendor package has been included in the repository so colcon will handle it.
In addition, since this set of packages has no python external dependencies, you won't need anything else.</p>
<h2 id="build-1"><a class="header" href="#build-1">Build</a></h2>
<pre><code class="language-bash">$ colcon build
</code></pre>
<h2 id="issues"><a class="header" href="#issues">Issues</a></h2>
<p>If you run into any issues when building ROS2 Data Collection, you can use the search tool in the issues tab on <a href="https://github.com/brisa-robotics/ros2_data_collection">GitHub</a> and always feel free to <a href="https://github.com/brisa-robotics/ros2_data_collection">open a ticket</a>.</p>
<footer id="open-on-gh">Found a bug? <a href="https://github.com/brisa-robotics/ros2_data_collection/edit/main/doc/src/dc/build.md">Edit this page on GitHub.</a></footer><div style="break-before: page; page-break-before: always;"></div><h1 id="getting-started"><a class="header" href="#getting-started">Getting Started</a></h1>
<p>This document will take you through the process of starting the nodes.</p>
<div id="admonition-info" class="admonition info">
<div class="admonition-title">
<p>Info</p>
<p><a class="admonition-anchor-link" href="dc/getting_started.html#admonition-info"></a></p>
</div>
<div>
<p>By here, you must have built the workspace following the <a href="dc/./build.html">build guide</a>.</p>
</div>
</div>
<p>Examples are split in different categories:</p>
<ol>
<li><a href="dc/./getting_started/basics.html">Basics</a>: Understand how to start nodes, create your configuration and go around basic parameters</li>
</ol>
<h2 id="running-the-examples"><a class="header" href="#running-the-examples">Running the examples</a></h2>
<h3 id="example-1-uptime-to-fluent-bit-stdout-every-second-and-flush-data-every-second"><a class="header" href="#example-1-uptime-to-fluent-bit-stdout-every-second-and-flush-data-every-second">Example 1: Uptime to Fluent Bit Stdout every second and flush data every second</a></h3>
<h3 id="example-2-uptime-to-fluent-bit-stdout-every-second-and-flush-data-every-3-seconds"><a class="header" href="#example-2-uptime-to-fluent-bit-stdout-every-second-and-flush-data-every-3-seconds">Example 2: Uptime to Fluent Bit Stdout every second and flush data every 3 seconds</a></h3>
<h3 id="example-3-uptime-to-fluent-bit-stdout-only-at-start-and-3-times"><a class="header" href="#example-3-uptime-to-fluent-bit-stdout-only-at-start-and-3-times">Example 3: Uptime to Fluent Bit Stdout only at start and 3 times</a></h3>
<h3 id="example-4-cpu-and-memory-to-fluent-bit-stdout-every-5-seconds-forever"><a class="header" href="#example-4-cpu-and-memory-to-fluent-bit-stdout-every-5-seconds-forever">Example 4: CPU and Memory to Fluent Bit Stdout every 5 seconds forever</a></h3>
<h3 id="example-5-cpu-and-memory-as-a-group-to-fluent-bit-stdout-every-5-seconds-forever"><a class="header" href="#example-5-cpu-and-memory-as-a-group-to-fluent-bit-stdout-every-5-seconds-forever">Example 5: CPU and Memory as a group to Fluent Bit Stdout every 5 seconds forever</a></h3>
<h3 id="example-6-cpu-and-memory-as-a-group-to-fluent-bit-stdout-every-5-seconds-forever"><a class="header" href="#example-6-cpu-and-memory-as-a-group-to-fluent-bit-stdout-every-5-seconds-forever">Example 6: CPU and Memory as a group to Fluent Bit Stdout every 5 seconds forever</a></h3>
<footer id="open-on-gh">Found a bug? <a href="https://github.com/brisa-robotics/ros2_data_collection/edit/main/doc/src/dc/getting_started.md">Edit this page on GitHub.</a></footer><div style="break-before: page; page-break-before: always;"></div><h1 id="measurements"><a class="header" href="#measurements">Measurements</a></h1>
<h2 id="description"><a class="header" href="#description">Description</a></h2>
<p>Measurements are a single data unit presented in JSON format, that can contain different fields. For example, Memory measurement:</p>
<pre><code class="language-json">{
    &quot;date&quot;: &quot;2022-12-04T14:16:06.810999008&quot;,
    &quot;memory&quot;: {
        &quot;used&quot;: 76.007431
    },
    &quot;id&quot;: &quot;3c70afdcb6f248f28f4c3980734064c5&quot;,
    &quot;robot_name&quot;: &quot;C3PO&quot;,
    &quot;run_id&quot;: 358
}
</code></pre>
<h2 id="node-parameters"><a class="header" href="#node-parameters">Node parameters</a></h2>
<p>The node starts the fluent bit engine and its ros2 plugin and enables data collection from ROS2 topics. This plugin will subscribe to the configured ROS2 topics and data will be collected by Fluent bit to destinations enabled by the <a href="dc/./destinations.html">destination node</a>.
Each topic is configured in a measurement, which is loaded in this node with pluginlib.
In addition, conditions are pluginlibs plugin also loaded dynamically. They are optional plugins that allow to collect on some conditions, e.g robot is moving.</p>
<div class="table-wrapper"><table><thead><tr><th>Parameter name</th><th>Description</th><th>Type(s)</th><th>Default</th></tr></thead><tbody>
<tr><td>measurement_plugins</td><td>Name of the measurement plugins to load</td><td>list[str]</td><td>N/A (mandatory)</td></tr>
<tr><td>condition_plugins</td><td>Name of the condition plugins to load</td><td>list[str]</td><td>N/A (mandatory)</td></tr>
<tr><td>save_local_base_path</td><td>Path where files will be saved locally (e.g camera images). Expands $X to environment variables and =Y to custom string parameters</td><td>str</td><td>N/A (mandatory)</td></tr>
<tr><td>all_base_path</td><td>Path where files will be saved at their destination (S3, minio...). Expands $X to environment variables and =Y to</td><td>str</td><td>N/A (mandatory)</td></tr>
<tr><td>custom_str_params</td><td>Custom string parameters that can be used in other parameters.</td><td>list[str]</td><td>N/A (optional)</td></tr>
</tbody></table>
</div>
<h2 id="plugin-parameters"><a class="header" href="#plugin-parameters">Plugin parameters</a></h2>
<p>Each measurement is collected through a node and has these configuration parameters:</p>
<div class="table-wrapper"><table><thead><tr><th>Parameter name</th><th>Description</th><th>Type(s)</th><th>Default</th></tr></thead><tbody>
<tr><td>plugin</td><td>Name of the plugin to load</td><td>str</td><td>N/A (mandatory)</td></tr>
<tr><td>topic_output</td><td>Topic where result will be published</td><td>str</td><td>N/A (mandatory)</td></tr>
<tr><td>group_key</td><td>Value of the key used when grouped</td><td>str</td><td>N/A (mandatory)</td></tr>
<tr><td>polling_interval</td><td>Interval to which data is collected in milliseconds</td><td>int (&gt;=100)</td><td>1000</td></tr>
<tr><td>init_collect</td><td>Collect when the node starts instead of waiting the first tick</td><td>bool</td><td>true</td></tr>
<tr><td>init_max_measurements</td><td>Collect a maximum of n measurements when starting the node (-1 = never, 0 = infinite)</td><td>int</td><td>0</td></tr>
<tr><td>condition_max_measurements</td><td>Collect a maximum of n measurements when conditions are activated (-1 = never, 0 = infinite)</td><td>int</td><td>0</td></tr>
<tr><td>enable_validator</td><td>Will validate the data against a JSON schema</td><td>bool</td><td>false</td></tr>
<tr><td>remote_prefixes</td><td>Prefixes to apply to the paths when sending files to a destination</td><td>str</td><td>&quot;&quot;</td></tr>
<tr><td>remote_keys</td><td>Remote keys</td><td>str</td><td>&quot;&quot;</td></tr>
<tr><td>if_all_conditions</td><td>Collect only if all conditions are activated</td><td>list[str]</td><td>N/A (optional)</td></tr>
<tr><td>if_any_conditions</td><td>Collect if any conditions is activated</td><td>list[str]</td><td>N/A (optional)</td></tr>
<tr><td>if_none_conditions</td><td>Collect only if all conditions are not activated</td><td>list[str]</td><td>N/A (optional)</td></tr>
</tbody></table>
</div>
<h2 id="available-plugins"><a class="header" href="#available-plugins">Available plugins:</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Description</th></tr></thead><tbody>
<tr><td><a href="dc/./dc/measurements/camera.html">Camera</a></td><td>Camera images, images can be rotated and inspected to detect content in images. They are saved as files</td></tr>
<tr><td><a href="dc/./dc/measurements/cmd_vel.html">Command velocity</a></td><td>Command velocity: navigation commands</td></tr>
<tr><td><a href="dc/./dc/measurements/cpu.html">CPU</a></td><td>CPU statistics</td></tr>
<tr><td><a href="dc/./dc/measurements/distance_traveled.html">Distance traveled</a></td><td>Total distance traveled by the robot</td></tr>
<tr><td><a href="dc/./dc/measurements/ip_camera.html">IP Camera</a></td><td>IP camera videos as files</td></tr>
<tr><td><a href="dc/./dc/measurements/map.html">Map</a></td><td>ROS map files (yaml and pgm) and metadata used by the robot to localize and navigate</td></tr>
<tr><td><a href="dc/./dc/measurements/memory.html">Memory</a></td><td>System memory usage</td></tr>
<tr><td><a href="dc/./dc/measurements/network.html">Network</a></td><td>Network interfaces, availability</td></tr>
<tr><td><a href="dc/./dc/measurements/os.html">OS</a></td><td>Operating System information</td></tr>
<tr><td><a href="dc/./dc/measurements/permissions.html">Permissions</a></td><td>Permissions of a file or directory</td></tr>
<tr><td><a href="dc/./dc/measurements/position.html">Position</a></td><td>Robot position</td></tr>
<tr><td><a href="dc/./dc/measurements/speed.html">Speed</a></td><td>Robot speed</td></tr>
<tr><td><a href="dc/./dc/measurements/storage.html">Storage</a></td><td>Available and used space in a directory</td></tr>
<tr><td><a href="dc/./dc/measurements/string_stamped.html">String stamped</a></td><td>Republish a string stamped message, can be used for external data</td></tr>
<tr><td><a href="dc/./dc/measurements/uptime.html">Uptime</a></td><td>How long the machine has been turned on</td></tr>
</tbody></table>
</div>
<h2 id="example-configuration"><a class="header" href="#example-configuration">Example configuration</a></h2>
<pre><code class="language-yaml">measurement_server:
  ros__parameters:
    measurement_plugins: [
        &quot;camera&quot;,
        &quot;memory&quot;,
        &quot;cpu&quot;,
        &quot;uptime&quot;,
        &quot;storage&quot;,
        &quot;permission_home&quot;,
        &quot;cmd_vel&quot;,
        &quot;position&quot;,
        &quot;speed&quot;,
        &quot;map&quot;,
        &quot;uptime&quot;,
    ]
    condition_plugins: [&quot;moving&quot;]
    custom_str_params: [&quot;robot_name&quot;]
    save_local_base_path: &quot;$HOME/windrose/src/windrose/data/&quot;
    all_base_path: &quot;=fleet_name/=robot_name/%Y/%m/%d/%H&quot;
    not_loaded_param: &quot;a_param&quot; # Not being used because not in custom_str_params
    robot_name: &quot;r2d2&quot;
    moving:
      plugin: &quot;dc_conditions/Moving&quot;
    camera:
      plugin: &quot;dc_measurements/Camera&quot;
      group_key: &quot;camera&quot;
      topic_output: &quot;/dc/measurement/camera&quot;
      polling_interval: 1000
      init_collect: true
      node_name: &quot;dc_measurement_camera&quot;
      cam_topic: &quot;/camera/image_raw&quot;
      cam_name: my_cam
      enable_validator: false
      draw_det_barcodes: false
      save_raw_img: true
      save_rotated_img: true
      save_detections_img: true
      save_raw_path: &quot;camera/raw/%Y-%m-%dT%H:%M:%S&quot;
      save_rotated_path: &quot;camera/rotated/%Y-%m-%dT%H:%M:%S&quot;
      save_inspected_path: &quot;camera/inspected/%Y-%m-%dT%H:%M:%S&quot;
      rotation_angle: 0
      detection_modules: [&quot;barcode&quot;]
      remote_prefixes: [&quot;&quot;]
      remote_keys: [&quot;minio&quot;]
    cpu:
      plugin: &quot;dc_measurements/Cpu&quot;
      group_key: &quot;cpu&quot;
      topic_output: &quot;/dc/measurement/cpu&quot;
      polling_interval: 2000
      init_collect: True
      node_name: &quot;dc_measurement_cpu&quot;
      cpu_min: 5
      max_processes: 5
    memory:
      plugin: &quot;dc_measurements/Memory&quot;
      group_key: &quot;memory&quot;
      topic_output: &quot;/dc/measurement/memory&quot;
      polling_interval: 1500
      init_collect: False
      node_name: &quot;dc_measurement_memory&quot;
    uptime:
      plugin: &quot;dc_measurements/Uptime&quot;
      group_key: &quot;uptime&quot;
      topic_output: &quot;/dc/measurement/uptime&quot;
    storage:
      plugin: &quot;dc_measurements/Storage&quot;
      group_key: &quot;storage&quot;
      env: HOME
      topic_output: &quot;/dc/measurement/storage&quot;
    permission_home:
      plugin: &quot;dc_measurements/Permissions&quot;
      topic_output: &quot;/dc/measurement/permission_home&quot;
      group_key: &quot;permission_home&quot;
      env: HOME
      permission_format: 1
    cmd_vel:
      plugin: &quot;dc_measurements/CmdVel&quot;
      group_key: &quot;cmd_vel&quot;
      enable_validator: true
      topic_output: &quot;/dc/measurement/cmd_vel&quot;
    os:
      plugin: &quot;dc_measurements/OS&quot;
      group_key: &quot;os&quot;
      topic_output: &quot;/dc/measurement/os&quot;
    network: # Not loaded because not in measurement_plugins
      plugin: &quot;dc_measurements/Network&quot;
      group_key: &quot;network&quot;
      topic_output: &quot;/dc/measurement/network&quot;
    map:
      plugin: &quot;dc_measurements/Map&quot;
      group_key: &quot;map&quot;
      save_map_path: &quot;map/%Y-%m-%dT%H:%M:%S&quot;
      topic_output: &quot;/dc/measurement/map&quot;
    position:
      plugin: &quot;dc_measurements/Position&quot;
      group_key: &quot;position&quot;
      global_frame: &quot;map&quot;
      robot_base_frame: &quot;base_link&quot;
      transform_tolerance: 0.1
      topic_output: &quot;/dc/measurement/position&quot;
    speed:
      plugin: &quot;dc_measurements/Speed&quot;
      group_key: &quot;speed&quot;
      odom_topic: &quot;/odom&quot;
      topic_output: &quot;/dc/measurement/speed&quot;
</code></pre>
<footer id="open-on-gh">Found a bug? <a href="https://github.com/brisa-robotics/ros2_data_collection/edit/main/doc/src/dc/measurements.md">Edit this page on GitHub.</a></footer><div style="break-before: page; page-break-before: always;"></div><h1 id="camera"><a class="header" href="#camera">Camera</a></h1>
<h2 id="description-1"><a class="header" href="#description-1">Description</a></h2>
<p>Save camera image files: raw, rotated and/or inspected. Images can be inspected using different services (e.g barcode detection)</p>
<h2 id="parameters"><a class="header" href="#parameters">Parameters</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Parameter</th><th>Description</th><th>Type</th><th>Default</th></tr></thead><tbody>
<tr><td><strong>cam_name</strong></td><td>Name to give to the camera</td><td>str</td><td>N/A (mandatory)</td></tr>
<tr><td><strong>cam_topic</strong></td><td>Topic from where camera data needs to be fetched</td><td>str</td><td>N/A (mandatory)</td></tr>
<tr><td><strong>draw_det_barcodes</strong></td><td>Draw barcode detection on images</td><td>bool</td><td>true</td></tr>
<tr><td><strong>rotation_angle</strong></td><td>Rotate the image before inspecting it by this angle</td><td>int (90, 180, 270)</td><td>0</td></tr>
<tr><td><strong>save_raw_img</strong></td><td>Whether to save raw image captured by the camera</td><td>bool</td><td>false</td></tr>
<tr><td><strong>save_rotated_img</strong></td><td>Whether to save rotated image captured by the camera</td><td>bool</td><td>false</td></tr>
<tr><td><strong>save_detections_img</strong></td><td>Whether to save inspected image captured by the camera with detection shapes</td><td>bool</td><td>true</td></tr>
<tr><td><strong>save_raw_path</strong></td><td>Path to save the raw camera image. Expands environment variables and datetime</td><td>str</td><td>&quot;camera/raw/%Y-%m-%dT%H:%M:%S&quot;</td></tr>
<tr><td><strong>save_rotated_path</strong></td><td>Path to save the rotated camera image. Expands environment variables and datetime format are expanded</td><td>str</td><td>&quot;camera/rotated/%Y-%m-%dT%H:%M:%S&quot;</td></tr>
<tr><td><strong>save_inspected_path</strong></td><td>Path to save the inspected camera image. Expands environment variables and datetime format are expanded</td><td>str</td><td>&quot;camera/inspected/%Y-%m-%dT%H:%M:%S&quot;</td></tr>
<tr><td><strong>detection_modules</strong></td><td>Detection modules to use</td><td>list[str](barcode)</td><td>N/A (optional)</td></tr>
</tbody></table>
</div>
<h2 id="remote-keys"><a class="header" href="#remote-keys">Remote keys</a></h2>
<h3 id="measurement-node-configuration"><a class="header" href="#measurement-node-configuration">Measurement node configuration</a></h3>
<p>The remote paths are also saved in the JSON under <em>&lt;measurement_name&gt;.<destination>_img_paths.(raw|rotated|inspected)</em>. If images want to be sent to Minio, add &quot;minio&quot; in <em>remote_keys</em>. This will add a remote path that can later be used in your API.</p>
<p>Note that this remote key is not included in the JSON schema, which only contains the local paths. If you want to enforce the schema with your custom remote key, you will need to write it and load it manually.</p>
<p>Example:</p>
<pre><code class="language-yaml">...
camera:
    plugin: &quot;dc_measurements/Camera&quot;
    group_key: &quot;camera_with_codes&quot;
    topic_output: &quot;/dc/measurement/camera_with_codes&quot;
    polling_interval: 10000
    init_collect: true
    node_name: &quot;dc_measurement_camera&quot;
    cam_topic: &quot;/camera_with_codes&quot;
    cam_name: my_camera_with_codes
    enable_validator: false
    draw_det_barcodes: true
    save_raw_img: true
    save_rotated_img: false
    save_detections_img: true
    save_raw_path: &quot;camera_with_codes/raw/%Y-%m-%dT%H-%M-%S&quot;
    save_rotated_path: &quot;camera_with_codes/rotated/%Y-%m-%dT%H-%M-%S&quot;
    save_inspected_path: &quot;camera_with_codes/inspected/%Y-%m-%dT%H-%M-%S&quot;
    rotation_angle: 0
    detection_modules: [&quot;barcode&quot;]
    remote_prefixes: [&quot;&quot;]
    remote_keys: [&quot;minio&quot;] # Will create paths for Minio, does not send the file
</code></pre>
<h3 id="destination-node-configuration"><a class="header" href="#destination-node-configuration">Destination node configuration</a></h3>
<p>Now that the path is set, it can be used to know where to send the image:</p>
<pre><code class="language-yaml">...
flb_minio:
    verbose_plugin: false
    time_format: &quot;iso8601&quot;
    plugin: &quot;dc_destinations/Flbminio&quot;
    inputs: [&quot;/dc/group/cameras&quot;]
    endpoint: 127.0.0.1:9000
    access_key_id: XEYqG4ZcPY5jiq5i
    secret_access_key: ji011KCtI82ZeQS6UwsQAg8x9VR4lSaQ
    use_ssl: false
    create_bucket: true
    bucket: &quot;mybucket&quot;
    src_fields:
    [
        &quot;camera.local_img_paths.raw&quot;,
        &quot;camera.local_img_paths.rotated&quot;,
        &quot;camera_2.local_img_paths.raw&quot;,
        &quot;camera_2.local_img_paths.inspected&quot;,
    ]
    upload_fields: # Remote paths created by the measurement node configuration
    [
        &quot;camera.minio_img_paths.raw&quot;,
        &quot;camera.minio_img_paths.rotated&quot;,
        &quot;camera_2.minio_img_paths.raw&quot;,
        &quot;camera_2.minio_img_paths.inspected&quot;,
    ]
</code></pre>
<h2 id="schema"><a class="header" href="#schema">Schema</a></h2>
<pre><code class="language-json">{
    &quot;$schema&quot;: &quot;http://json-schema.org/draft-07/schema#&quot;,
    &quot;title&quot;: &quot;Camera&quot;,
    &quot;description&quot;: &quot;Camera images with detected objects&quot;,
    &quot;properties&quot;: {
        &quot;local_img_paths&quot;: {
            &quot;description&quot;: &quot;Paths of saved images&quot;,
            &quot;type&quot;: &quot;object&quot;,
            &quot;items&quot;: {
                &quot;$ref&quot;: &quot;#/$defs/local_img_paths&quot;
            }
        },
        &quot;inspected&quot;: {
            &quot;description&quot;: &quot;Inspected content of an image&quot;,
            &quot;type&quot;: &quot;object&quot;,
            &quot;items&quot;: {
                &quot;$ref&quot;: &quot;#/$defs/inspected&quot;
            }
        }
    },
    &quot;$defs&quot;: {
        &quot;local_img_paths&quot;: {
            &quot;type&quot;: &quot;object&quot;,
            &quot;properties&quot;: {
                &quot;raw&quot;: {
                    &quot;description&quot;: &quot;Raw image&quot;,
                    &quot;type&quot;: &quot;string&quot;
                },
                &quot;rotated&quot;: {
                    &quot;description&quot;: &quot;Rotated image&quot;,
                    &quot;type&quot;: &quot;string&quot;
                },
                &quot;inspected&quot;: {
                    &quot;description&quot;: &quot;Inspected image&quot;,
                    &quot;type&quot;: &quot;string&quot;
                }
            }
        },
        &quot;inspected&quot;: {
            &quot;type&quot;: &quot;object&quot;,
            &quot;properties&quot;: {
                &quot;barcode&quot;: {
                    &quot;description&quot;: &quot;Barcode inspected data&quot;,
                    &quot;type&quot;: &quot;array&quot;,
                    &quot;items&quot;: {
                        &quot;$ref&quot;: &quot;#/$defs/barcode&quot;
                    }
                }
            }
        },
        &quot;barcode&quot;: {
            &quot;type&quot;: &quot;object&quot;,
            &quot;properties&quot;: {
                &quot;data&quot;: {
                    &quot;description&quot;: &quot;Barcode data&quot;,
                    &quot;type&quot;: &quot;array&quot;,
                    &quot;items&quot;: {
                        &quot;type&quot;: &quot;integer&quot;
                    }
                },
                &quot;height&quot;: {
                    &quot;description&quot;: &quot;Barcode height&quot;,
                    &quot;type&quot;: &quot;integer&quot;
                },
                &quot;width&quot;: {
                    &quot;description&quot;: &quot;Barcode width&quot;,
                    &quot;type&quot;: &quot;integer&quot;
                },
                &quot;top&quot;: {
                    &quot;description&quot;: &quot;Barcode top position&quot;,
                    &quot;type&quot;: &quot;integer&quot;
                },
                &quot;left&quot;: {
                    &quot;description&quot;: &quot;Barcode left position&quot;,
                    &quot;type&quot;: &quot;integer&quot;
                },
                &quot;type&quot;: {
                    &quot;description&quot;: &quot;Barcode type&quot;,
                    &quot;type&quot;: &quot;string&quot;
                }
            }
        }
    },
    &quot;type&quot;: &quot;object&quot;
}
</code></pre>
<footer id="open-on-gh">Found a bug? <a href="https://github.com/brisa-robotics/ros2_data_collection/edit/main/doc/src/dc/measurements/camera.md">Edit this page on GitHub.</a></footer><div style="break-before: page; page-break-before: always;"></div><h1 id="cmd_vel"><a class="header" href="#cmd_vel">Cmd_vel</a></h1>
<h2 id="description-2"><a class="header" href="#description-2">Description</a></h2>
<p>Collect command velocity sent to the robot by subscribing to cmd_vel topic.</p>
<h2 id="parameters-1"><a class="header" href="#parameters-1">Parameters</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Parameter</th><th>Description</th><th>Type</th><th>Default</th></tr></thead><tbody>
<tr><td><strong>topic</strong></td><td>Topic to subscribe to to get the cmd_vel (geometry_msgs/Twist)</td><td>str</td><td>&quot;/cmd_vel&quot;</td></tr>
</tbody></table>
</div>
<h2 id="schema-1"><a class="header" href="#schema-1">Schema</a></h2>
<pre><code class="language-json">{
    &quot;$schema&quot;: &quot;http://json-schema.org/draft-07/schema#&quot;,
    &quot;title&quot;: &quot;Cmd_vel&quot;,
    &quot;description&quot;: &quot;Command velocity sent to the robot&quot;,
    &quot;properties&quot;: {
        &quot;linear&quot;: {
            &quot;description&quot;: &quot;Linear velocity as a vector&quot;,
            &quot;type&quot;: &quot;object&quot;,
            &quot;items&quot;: {
                &quot;$ref&quot;: &quot;#/$defs/vector3&quot;
            }
        },
        &quot;angular&quot;: {
            &quot;description&quot;: &quot;Angular velocity as a vector&quot;,
            &quot;type&quot;: &quot;object&quot;,
            &quot;items&quot;: {
                &quot;$ref&quot;: &quot;#/$defs/vector3&quot;
            }
        }
    },
    &quot;$defs&quot;: {
        &quot;vector3&quot;: {
            &quot;type&quot;: &quot;object&quot;,
            &quot;properties&quot;: {
                &quot;x&quot;: {
                    &quot;description&quot;: &quot;X speed&quot;,
                    &quot;type&quot;: &quot;number&quot;
                },
                &quot;y&quot;: {
                    &quot;description&quot;: &quot;Y speed&quot;,
                    &quot;type&quot;: &quot;number&quot;
                },
                &quot;z&quot;: {
                    &quot;description&quot;: &quot;Z speed&quot;,
                    &quot;type&quot;: &quot;number&quot;
                }
            }
        }
    },
    &quot;type&quot;: &quot;object&quot;
}
</code></pre>
<footer id="open-on-gh">Found a bug? <a href="https://github.com/brisa-robotics/ros2_data_collection/edit/main/doc/src/dc/measurements/cmd_vel.md">Edit this page on GitHub.</a></footer><div style="break-before: page; page-break-before: always;"></div><h1 id="cpu"><a class="header" href="#cpu">CPU</a></h1>
<h2 id="description-3"><a class="header" href="#description-3">Description</a></h2>
<p>Collect cpu usage: average cpu, number of processes running and processes sorted by cpu usage.</p>
<h2 id="parameters-2"><a class="header" href="#parameters-2">Parameters</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Parameter</th><th>Description</th><th>Type</th><th>Default</th></tr></thead><tbody>
<tr><td><strong>max_processes</strong></td><td>Max amount of processes to collect in the sorted field. -1 for all</td><td>int</td><td>5</td></tr>
<tr><td><strong>cpu_min</strong></td><td>Filters out processes using less than this cpu usage. -1 to disable</td><td>float</td><td>5.0</td></tr>
</tbody></table>
</div>
<h2 id="schema-2"><a class="header" href="#schema-2">Schema</a></h2>
<pre><code class="language-json">{
    &quot;$schema&quot;: &quot;http://json-schema.org/draft-07/schema#&quot;,
    &quot;title&quot;: &quot;Cpu&quot;,
    &quot;description&quot;: &quot;CPU statistics&quot;,
    &quot;properties&quot;: {
        &quot;average&quot;: {
            &quot;description&quot;: &quot;Average CPU&quot;,
            &quot;type&quot;: &quot;number&quot;,
            &quot;minimum&quot;: 0
        },
        &quot;processes&quot;: {
            &quot;description&quot;: &quot;Number of processes running&quot;,
            &quot;type&quot;: &quot;integer&quot;,
            &quot;minimum&quot;: 0
        },
        &quot;sorted&quot;: {
            &quot;description&quot;: &quot;Processes sorted by CPU usage&quot;,
            &quot;type&quot;: &quot;array&quot;,
            &quot;items&quot;: {
                &quot;$ref&quot;: &quot;#/$defs/process&quot;
            }
        }
    },
    &quot;$defs&quot;: {
        &quot;process&quot;: {
            &quot;type&quot;: &quot;object&quot;,
            &quot;description&quot;: &quot;Process information&quot;,
            &quot;properties&quot;: {
                &quot;pid&quot;: {
                    &quot;description&quot;: &quot;Process ID of the process&quot;,
                    &quot;type&quot;: &quot;integer&quot;
                },
                &quot;user&quot;: {
                    &quot;description&quot;: &quot;User who started the process&quot;,
                    &quot;type&quot;: &quot;string&quot;
                },
                &quot;cmd&quot;: {
                    &quot;description&quot;: &quot;Command that launched the process&quot;,
                    &quot;type&quot;: &quot;string&quot;
                },
                &quot;cpu&quot;: {
                    &quot;description&quot;: &quot;Process' current utilization as a percentage of total CPU time&quot;,
                    &quot;type&quot;: &quot;number&quot;
                },
                &quot;ram&quot;: {
                    &quot;description&quot;: &quot;Memory in use by this process in kb&quot;,
                    &quot;type&quot;: &quot;integer&quot;
                },
                &quot;uptime&quot;: {
                    &quot;description&quot;: &quot;Age of the process in seconds&quot;,
                    &quot;type&quot;: &quot;integer&quot;
                }
            }
        }
    },
    &quot;type&quot;: &quot;object&quot;
}
</code></pre>
<footer id="open-on-gh">Found a bug? <a href="https://github.com/brisa-robotics/ros2_data_collection/edit/main/doc/src/dc/measurements/cpu.md">Edit this page on GitHub.</a></footer><div style="break-before: page; page-break-before: always;"></div><h1 id="distance-traveled"><a class="header" href="#distance-traveled">Distance traveled</a></h1>
<h2 id="description-4"><a class="header" href="#description-4">Description</a></h2>
<p>Collect total distance traveled in the robot since it is powered.</p>
<h2 id="parameters-3"><a class="header" href="#parameters-3">Parameters</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Parameter</th><th>Description</th><th>Type</th><th>Default</th></tr></thead><tbody>
<tr><td><strong>global_frame</strong></td><td>Global frame</td><td>str</td><td>&quot;map&quot;</td></tr>
<tr><td><strong>robot_base_frame</strong></td><td>Robot base frame</td><td>str</td><td>&quot;base_link&quot;</td></tr>
<tr><td><strong>transform_timeout</strong></td><td>TF Timeout to use for transformation</td><td>float</td><td>0.1</td></tr>
</tbody></table>
</div>
<h2 id="schema-3"><a class="header" href="#schema-3">Schema</a></h2>
<pre><code class="language-json">{
    &quot;$schema&quot;: &quot;http://json-schema.org/draft-07/schema#&quot;,
    &quot;title&quot;: &quot;Distance traveled&quot;,
    &quot;description&quot;: &quot;Total distance traveled in meters by the robot&quot;,
    &quot;properties&quot;: {
        &quot;distance_traveled&quot;: {
            &quot;description&quot;: &quot;Total distance traveled in meters&quot;,
            &quot;type&quot;: &quot;number&quot;
        }
    },
    &quot;type&quot;: &quot;object&quot;
}
</code></pre>
<footer id="open-on-gh">Found a bug? <a href="https://github.com/brisa-robotics/ros2_data_collection/edit/main/doc/src/dc/measurements/distance_traveled.md">Edit this page on GitHub.</a></footer><div style="break-before: page; page-break-before: always;"></div><h1 id="ip-camera"><a class="header" href="#ip-camera">Ip Camera</a></h1>
<h2 id="description-5"><a class="header" href="#description-5">Description</a></h2>
<p>Records video in small segments (in case of a cut) and store it locally.
They are first stored in a temporary folder. Once the sample (of e.g 10 seconds) is done, it is moved to another directory.</p>
<p>Compared to other plugins, the collect function only moves the files from the temporary location, it does not start the recording. It takes some time to establish connection, so we avoid doing this every time. Recording is started at initialization by an ffmpeg process and saved in <a href="https://www.wikiwand.com/en/HTTP_Live_Streaming">HLS format</a>.</p>
<h2 id="parameters-4"><a class="header" href="#parameters-4">Parameters</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Parameter</th><th>Description</th><th>Type</th><th>Default</th></tr></thead><tbody>
<tr><td><strong>input</strong></td><td>Input url</td><td>str</td><td>N/A (Mandatory)</td></tr>
<tr><td><strong>video</strong></td><td>Enable video recording</td><td>bool</td><td>true</td></tr>
<tr><td><strong>audio</strong></td><td>Enable audio recording</td><td>bool</td><td>false</td></tr>
<tr><td><strong>bitrate_video</strong></td><td>Video bitrate</td><td>str</td><td>&quot;2M&quot;</td></tr>
<tr><td><strong>bitrate_audio</strong></td><td>Audio bitrate</td><td>str</td><td>&quot;192k&quot;</td></tr>
<tr><td><strong>segment</strong></td><td>Records by small segment, managed by ffmpeg</td><td>bool</td><td>bool</td></tr>
<tr><td><strong>segment_time</strong></td><td>Duration of a segment</td><td>int (&gt;0)</td><td>10</td></tr>
<tr><td><strong>ffmpeg_log_level</strong></td><td>Ffmpeg log level</td><td>str (See <a href="https://ffmpeg.org/ffmpeg.html">doc</a>)</td><td>&quot;info&quot;</td></tr>
<tr><td><strong>ffmpeg_banner</strong></td><td>Show ffmpeg banner in console</td><td>bool</td><td>true</td></tr>
<tr><td><strong>save_path</strong></td><td>Path used to save files with ffmpeg, UTC date is used. There can't be &quot;:&quot; in this string, ffmpeg does not parse it</td><td>str</td><td>&quot;ffmpeg_%Y-%m-%dT%H:%M:%S&quot;</td></tr>
</tbody></table>
</div>
<h2 id="schema-4"><a class="header" href="#schema-4">Schema</a></h2>
<pre><code class="language-json">{
    &quot;$schema&quot;: &quot;http://json-schema.org/draft-07/schema#&quot;,
    &quot;title&quot;: &quot;Ip Camera&quot;,
    &quot;description&quot;: &quot;Local and remote path where the remote camera video is recorded&quot;,
    &quot;properties&quot;: {
        &quot;local_path&quot;: {
            &quot;description&quot;: &quot;Local video path&quot;,
            &quot;type&quot;: &quot;string&quot;
        },
        &quot;remote_path&quot;: {
            &quot;description&quot;: &quot;Remote video path&quot;,
            &quot;type&quot;: &quot;string&quot;
        }
    },
    &quot;type&quot;: &quot;object&quot;
}
</code></pre>
<footer id="open-on-gh">Found a bug? <a href="https://github.com/brisa-robotics/ros2_data_collection/edit/main/doc/src/dc/measurements/ip_camera.md">Edit this page on GitHub.</a></footer><div style="break-before: page; page-break-before: always;"></div><h1 id="map"><a class="header" href="#map">Map</a></h1>
<h2 id="description-6"><a class="header" href="#description-6">Description</a></h2>
<p>Save map using nav2_map_server and collect the map of the local map saved. The measurement also includes metadata: width, heigh and x and y origin.</p>
<h2 id="parameters-5"><a class="header" href="#parameters-5">Parameters</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Parameter</th><th>Description</th><th>Type</th><th>Default</th></tr></thead><tbody>
<tr><td><strong>topic</strong></td><td>Topic to subscribe to to get the map</td><td>str</td><td>&quot;/map&quot;</td></tr>
<tr><td><strong>save_path</strong></td><td>Path to save the map to. Environment variables and datetime format are expanded</td><td>str</td><td>&quot;map/%Y-%m-%dT%H:%M:%S&quot;</td></tr>
</tbody></table>
</div>
<h2 id="schema-5"><a class="header" href="#schema-5">Schema</a></h2>
<pre><code class="language-json">{
    &quot;$schema&quot;: &quot;http://json-schema.org/draft-07/schema#&quot;,
    &quot;title&quot;: &quot;Map&quot;,
    &quot;description&quot;: &quot;Map saved metadata and paths&quot;,
    &quot;properties&quot;: {
        &quot;resolution&quot;: {
            &quot;description&quot;: &quot;Resolution of the map, meters/pixel&quot;,
            &quot;type&quot;: &quot;number&quot;,
            &quot;minimum&quot;: 0
        },
        &quot;local_paths&quot;: {
            &quot;description&quot;: &quot;Paths where metadata and image are stored&quot;,
            &quot;type&quot;: &quot;object&quot;,
            &quot;items&quot;: {
                &quot;$ref&quot;: &quot;#/$defs/paths&quot;
            }
        },
        &quot;origin&quot;: {
            &quot;description&quot;: &quot;Robot origin position in meters&quot;,
            &quot;type&quot;: &quot;object&quot;,
            &quot;items&quot;: {
                &quot;$ref&quot;: &quot;#/$defs/origin&quot;
            }
        },
        &quot;width&quot;: {
            &quot;description&quot;: &quot;Width of the PGM&quot;,
            &quot;type&quot;: &quot;integer&quot;,
            &quot;minimum&quot;: 0
        },
        &quot;height&quot;: {
            &quot;description&quot;: &quot;Height of the PGM&quot;,
            &quot;type&quot;: &quot;integer&quot;,
            &quot;minimum&quot;: 0
        }
    },
    &quot;$defs&quot;: {
        &quot;origin&quot;: {
            &quot;type&quot;: &quot;object&quot;,
            &quot;description&quot;: &quot;The 2-D pose of the lower-left pixel in the map, as (x, y, yaw), with yaw as counterclockwise rotation (yaw=0 means no rotation). Many parts of the system currently ignore yaw.&quot;,
            &quot;properties&quot;: {
                &quot;x&quot;: {
                    &quot;description&quot;: &quot;X origin of the robot&quot;,
                    &quot;type&quot;: &quot;number&quot;
                },
                &quot;y&quot;: {
                    &quot;description&quot;: &quot;Y origin of the robot&quot;,
                    &quot;type&quot;: &quot;number&quot;
                }
            }
        },
        &quot;paths&quot;: {
            &quot;type&quot;: &quot;object&quot;,
            &quot;properties&quot;: {
                &quot;yaml&quot;: {
                    &quot;description&quot;: &quot;Path to the map YAML file containing map metadata&quot;,
                    &quot;type&quot;: &quot;string&quot;
                },
                &quot;pgm&quot;: {
                    &quot;description&quot;: &quot;Path to the map PGM file containing the gray-scale image&quot;,
                    &quot;type&quot;: &quot;string&quot;
                }
            }
        }
    },
    &quot;type&quot;: &quot;object&quot;
}
</code></pre>
<footer id="open-on-gh">Found a bug? <a href="https://github.com/brisa-robotics/ros2_data_collection/edit/main/doc/src/dc/measurements/map.md">Edit this page on GitHub.</a></footer><div style="break-before: page; page-break-before: always;"></div><h1 id="memory"><a class="header" href="#memory">Memory</a></h1>
<h2 id="description-7"><a class="header" href="#description-7">Description</a></h2>
<p>Collect memory used in percentage.</p>
<h2 id="schema-6"><a class="header" href="#schema-6">Schema</a></h2>
<pre><code class="language-json">{
    &quot;$schema&quot;: &quot;http://json-schema.org/draft-07/schema#&quot;,
    &quot;title&quot;: &quot;Memory&quot;,
    &quot;description&quot;: &quot;Memory used&quot;,
    &quot;properties&quot;: {
        &quot;used&quot;: {
            &quot;description&quot;: &quot;Memory used in percent&quot;,
            &quot;type&quot;: &quot;number&quot;,
            &quot;minimum&quot;: 0
        }
    },
    &quot;type&quot;: &quot;object&quot;
}
</code></pre>
<footer id="open-on-gh">Found a bug? <a href="https://github.com/brisa-robotics/ros2_data_collection/edit/main/doc/src/dc/measurements/memory.md">Edit this page on GitHub.</a></footer><div style="break-before: page; page-break-before: always;"></div><h1 id="network"><a class="header" href="#network">Network</a></h1>
<h2 id="description-8"><a class="header" href="#description-8">Description</a></h2>
<p>Collects ping value, whether or not the PC is online and interfaces available.</p>
<h2 id="parameters-6"><a class="header" href="#parameters-6">Parameters</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Parameter</th><th>Description</th><th>Type</th><th>Default</th></tr></thead><tbody>
<tr><td><strong>ping_address</strong></td><td>IP address to test the ping to</td><td>str</td><td>&quot;8.8.8.8&quot;</td></tr>
<tr><td><strong>ping_timeout</strong></td><td>Time in ms before ping times out. Offline if superior to it</td><td>int</td><td>5000</td></tr>
</tbody></table>
</div>
<h2 id="schema-7"><a class="header" href="#schema-7">Schema</a></h2>
<pre><code class="language-json">{
    &quot;$schema&quot;: &quot;http://json-schema.org/draft-07/schema#&quot;,
    &quot;title&quot;: &quot;Network&quot;,
    &quot;description&quot;: &quot;Network accessibility and information&quot;,
    &quot;properties&quot;: {
        &quot;ping&quot;: {
            &quot;description&quot;: &quot;Time to ping the host in ms&quot;,
            &quot;type&quot;: &quot;integer&quot;,
            &quot;minimum&quot;: -1
        },
        &quot;online&quot;: {
            &quot;description&quot;: &quot;If the pc is online&quot;,
            &quot;type&quot;: &quot;boolean&quot;
        },
        &quot;interfaces&quot;: {
            &quot;description&quot;: &quot;List of network interfaces&quot;,
            &quot;type&quot;: &quot;array&quot;,
            &quot;items&quot;: {
                &quot;type&quot;: &quot;string&quot;
            }
        }
    },
    &quot;type&quot;: &quot;object&quot;
}
</code></pre>
<footer id="open-on-gh">Found a bug? <a href="https://github.com/brisa-robotics/ros2_data_collection/edit/main/doc/src/dc/measurements/network.md">Edit this page on GitHub.</a></footer><div style="break-before: page; page-break-before: always;"></div><h1 id="os"><a class="header" href="#os">OS</a></h1>
<h2 id="description-9"><a class="header" href="#description-9">Description</a></h2>
<p>Collects the Operating System information: cpus, operating system name and kernel information</p>
<h2 id="schema-8"><a class="header" href="#schema-8">Schema</a></h2>
<pre><code class="language-json">{
    &quot;$schema&quot;: &quot;http://json-schema.org/draft-07/schema#&quot;,
    &quot;title&quot;: &quot;OS&quot;,
    &quot;description&quot;: &quot;OS, kernel and CPUs information&quot;,
    &quot;properties&quot;: {
        &quot;os&quot;: {
            &quot;description&quot;: &quot;Host distribution name&quot;,
            &quot;type&quot;: &quot;string&quot;
        },
        &quot;kernel&quot;: {
            &quot;description&quot;: &quot;Kernel version&quot;,
            &quot;type&quot;: &quot;string&quot;
        },
        &quot;cpu&quot;: {
            &quot;description&quot;: &quot;number of CPUs&quot;,
            &quot;type&quot;: &quot;integer&quot;,
            &quot;minimum&quot;: 0
        }
    },
    &quot;type&quot;: &quot;object&quot;
}
</code></pre>
<footer id="open-on-gh">Found a bug? <a href="https://github.com/brisa-robotics/ros2_data_collection/edit/main/doc/src/dc/measurements/os.md">Edit this page on GitHub.</a></footer><div style="break-before: page; page-break-before: always;"></div><h1 id="permissions"><a class="header" href="#permissions">Permissions</a></h1>
<h2 id="description-10"><a class="header" href="#description-10">Description</a></h2>
<p>Collect UID, GID, if a file or directory exists and its permissions (in rwx or integer format).</p>
<h2 id="parameters-7"><a class="header" href="#parameters-7">Parameters</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Parameter</th><th>Description</th><th>Type</th><th>Default</th></tr></thead><tbody>
<tr><td><strong>path</strong></td><td>Path to the file or directory to collect data from</td><td>str</td><td>&quot;&quot;</td></tr>
<tr><td><strong>env</strong></td><td>Environment from which to get the path from</td><td>str</td><td>&quot;&quot;</td></tr>
<tr><td><strong>format</strong></td><td>Format to collect permissions in. RWX = 0, INT = 1</td><td>Enum(0 or 1)</td><td>0</td></tr>
</tbody></table>
</div>
<h2 id="schemas"><a class="header" href="#schemas">Schemas</a></h2>
<pre><code class="language-json">{
    &quot;$schema&quot;: &quot;http://json-schema.org/draft-07/schema#&quot;,
    &quot;title&quot;: &quot;Permissions&quot;,
    &quot;description&quot;: &quot;Permissions of a file/directory&quot;,
    &quot;properties&quot;: {
        &quot;uid&quot;: {
            &quot;description&quot;: &quot;File/directory User IDentifier&quot;,
            &quot;type&quot;: &quot;integer&quot;
        },
        &quot;gid&quot;: {
            &quot;description&quot;: &quot;File/directory Group IDentifier&quot;,
            &quot;type&quot;: &quot;integer&quot;
        },
        &quot;exists&quot;: {
            &quot;description&quot;: &quot;File/directory exists&quot;,
            &quot;type&quot;: &quot;boolean&quot;
        },
        &quot;permissions&quot;: {
            &quot;description&quot;: &quot;Permissions as rwx or integer&quot;,
            &quot;type&quot;: &quot;string&quot;
        }
    },
    &quot;type&quot;: &quot;object&quot;
}
</code></pre>
<footer id="open-on-gh">Found a bug? <a href="https://github.com/brisa-robotics/ros2_data_collection/edit/main/doc/src/dc/measurements/permissions.md">Edit this page on GitHub.</a></footer><div style="break-before: page; page-break-before: always;"></div><h1 id="permissions-1"><a class="header" href="#permissions-1">Permissions</a></h1>
<h2 id="description-11"><a class="header" href="#description-11">Description</a></h2>
<p>Collect x, y and yaw of the robot.</p>
<h2 id="parameters-8"><a class="header" href="#parameters-8">Parameters</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Parameter</th><th>Description</th><th>Type</th><th>Default</th></tr></thead><tbody>
<tr><td><strong>global_frame</strong></td><td>Global frame</td><td>str</td><td>&quot;map&quot;</td></tr>
<tr><td><strong>robot_base_frame</strong></td><td>Robot base frame</td><td>str</td><td>&quot;base_link&quot;</td></tr>
<tr><td><strong>transform_timeout</strong></td><td>TF Timeout to use for transformation</td><td>float</td><td>0.1</td></tr>
</tbody></table>
</div>
<h2 id="schema-9"><a class="header" href="#schema-9">Schema</a></h2>
<pre><code class="language-json">{
    &quot;$schema&quot;: &quot;http://json-schema.org/draft-07/schema#&quot;,
    &quot;title&quot;: &quot;Position&quot;,
    &quot;description&quot;: &quot;Position and orientation of the robot&quot;,
    &quot;properties&quot;: {
        &quot;x&quot;: {
            &quot;description&quot;: &quot;X position of the robot&quot;,
            &quot;type&quot;: &quot;number&quot;
        },
        &quot;y&quot;: {
            &quot;description&quot;: &quot;Y position of the robot&quot;,
            &quot;type&quot;: &quot;number&quot;
        },
        &quot;yaw&quot;: {
            &quot;description&quot;: &quot;Yaw angle of the robot&quot;,
            &quot;type&quot;: &quot;number&quot;
        }
    },
    &quot;type&quot;: &quot;object&quot;
}
</code></pre>
<footer id="open-on-gh">Found a bug? <a href="https://github.com/brisa-robotics/ros2_data_collection/edit/main/doc/src/dc/measurements/position.md">Edit this page on GitHub.</a></footer><div style="break-before: page; page-break-before: always;"></div><h1 id="speed"><a class="header" href="#speed">Speed</a></h1>
<h2 id="description-12"><a class="header" href="#description-12">Description</a></h2>
<p>Collect robot speed using the Odom topic.</p>
<h2 id="parameters-9"><a class="header" href="#parameters-9">Parameters</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Parameter</th><th>Description</th><th>Type</th><th>Default</th></tr></thead><tbody>
<tr><td><strong>odom_topic</strong></td><td>Topic to subscribe to to get the odometry (nav_msgs/Odometry)</td><td>str</td><td>&quot;/odom&quot;</td></tr>
</tbody></table>
</div>
<h2 id="schema-10"><a class="header" href="#schema-10">Schema</a></h2>
<pre><code class="language-json">{
    &quot;$schema&quot;: &quot;http://json-schema.org/draft-07/schema#&quot;,
    &quot;title&quot;: &quot;Speed&quot;,
    &quot;description&quot;: &quot;Computed, linear and angular speed of the robot&quot;,
    &quot;properties&quot;: {
        &quot;computed&quot;: {
            &quot;description&quot;: &quot;Computed speed in meter/s&quot;,
            &quot;type&quot;: &quot;number&quot;
        },
        &quot;linear&quot;: {
            &quot;description&quot;: &quot;Linear velocity as a vector&quot;,
            &quot;type&quot;: &quot;object&quot;,
            &quot;items&quot;: {
                &quot;$ref&quot;: &quot;#/$defs/vector3&quot;
            }
        },
        &quot;angular&quot;: {
            &quot;description&quot;: &quot;Angular velocity as a vector&quot;,
            &quot;type&quot;: &quot;object&quot;,
            &quot;items&quot;: {
                &quot;$ref&quot;: &quot;#/$defs/vector3&quot;
            }
        }
    },
    &quot;$defs&quot;: {
        &quot;vector3&quot;: {
            &quot;type&quot;: &quot;object&quot;,
            &quot;properties&quot;: {
                &quot;x&quot;: {
                    &quot;description&quot;: &quot;X speed&quot;,
                    &quot;type&quot;: &quot;number&quot;
                },
                &quot;y&quot;: {
                    &quot;description&quot;: &quot;Y speed&quot;,
                    &quot;type&quot;: &quot;number&quot;
                },
                &quot;z&quot;: {
                    &quot;description&quot;: &quot;Z speed&quot;,
                    &quot;type&quot;: &quot;number&quot;
                }
            }
        }
    },
    &quot;type&quot;: &quot;object&quot;
}
</code></pre>
<footer id="open-on-gh">Found a bug? <a href="https://github.com/brisa-robotics/ros2_data_collection/edit/main/doc/src/dc/measurements/speed.md">Edit this page on GitHub.</a></footer><div style="break-before: page; page-break-before: always;"></div><h1 id="storage"><a class="header" href="#storage">Storage</a></h1>
<h2 id="description-13"><a class="header" href="#description-13">Description</a></h2>
<p>Collect storage information on a directory. Use either path or env</p>
<h2 id="parameters-10"><a class="header" href="#parameters-10">Parameters</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Parameter</th><th>Description</th><th>Type</th><th>Default</th></tr></thead><tbody>
<tr><td><strong>path</strong></td><td>Absolute path to the directory to inspect</td><td>str</td><td>N/A (Mandatory)</td></tr>
<tr><td><strong>env</strong></td><td>Environment variable to inspect</td><td>str</td><td>N/A (Mandatory)</td></tr>
</tbody></table>
</div>
<h2 id="schema-11"><a class="header" href="#schema-11">Schema</a></h2>
<pre><code class="language-json">{
    &quot;$schema&quot;: &quot;http://json-schema.org/draft-07/schema#&quot;,
    &quot;title&quot;: &quot;Storage&quot;,
    &quot;description&quot;: &quot;Storage information of a directory&quot;,
    &quot;properties&quot;: {
        &quot;free_percent&quot;: {
            &quot;description&quot;: &quot;Free space on the filesystem, in percent&quot;,
            &quot;type&quot;: &quot;number&quot;,
            &quot;minimum&quot;: 0
        },
        &quot;free&quot;: {
            &quot;description&quot;: &quot;Free space on the filesystem, in bytes&quot;,
            &quot;type&quot;: &quot;integer&quot;,
            &quot;minimum&quot;: 0
        },
        &quot;capacity&quot;: {
            &quot;description&quot;: &quot;Total size of the filesystem, in bytes&quot;,
            &quot;type&quot;: &quot;integer&quot;,
            &quot;minimum&quot;: 0
        }
    },
    &quot;type&quot;: &quot;object&quot;
}
</code></pre>
<footer id="open-on-gh">Found a bug? <a href="https://github.com/brisa-robotics/ros2_data_collection/edit/main/doc/src/dc/measurements/storage.md">Edit this page on GitHub.</a></footer><div style="break-before: page; page-break-before: always;"></div><h1 id="string-stamped"><a class="header" href="#string-stamped">String stamped</a></h1>
<h2 id="description-14"><a class="header" href="#description-14">Description</a></h2>
<p>Collect generic data from a topic publishing a StringStamped message and republish it. It allows to fetch data from rclc, rclpy and your custom ROS2 nodes that don't have use a plugin, very practical for testing.</p>
<footer id="open-on-gh">Found a bug? <a href="https://github.com/brisa-robotics/ros2_data_collection/edit/main/doc/src/dc/measurements/string_stamped.md">Edit this page on GitHub.</a></footer><div style="break-before: page; page-break-before: always;"></div><h1 id="uptime"><a class="header" href="#uptime">Uptime</a></h1>
<h2 id="description-15"><a class="header" href="#description-15">Description</a></h2>
<p>Time since when the robot PC has been on.</p>
<h2 id="schema-12"><a class="header" href="#schema-12">Schema</a></h2>
<pre><code class="language-json">{
    &quot;$schema&quot;: &quot;http://json-schema.org/draft-07/schema#&quot;,
    &quot;title&quot;: &quot;Uptime&quot;,
    &quot;description&quot;: &quot;Time the system has been up&quot;,
    &quot;properties&quot;: {
        &quot;time&quot;: {
            &quot;description&quot;: &quot;Time the system has been up&quot;,
            &quot;type&quot;: &quot;integer&quot;,
            &quot;minimum&quot;: 0
        }
    },
    &quot;type&quot;: &quot;object&quot;
}
</code></pre>
<footer id="open-on-gh">Found a bug? <a href="https://github.com/brisa-robotics/ros2_data_collection/edit/main/doc/src/dc/measurements/uptime.md">Edit this page on GitHub.</a></footer><div style="break-before: page; page-break-before: always;"></div><h1 id="overview"><a class="header" href="#overview">Overview</a></h1>
<h2 id="description-16"><a class="header" href="#description-16">Description</a></h2>
<p>A condition enables or disables one or multiple measurements to be published and thus collected. We could for example enable collecting camera images only when a robot is stopped:</p>
<p>Each condition is enabled or disabled through a pluginlib plugin. It has these configuration parameters:</p>
<h2 id="available-plugins-1"><a class="header" href="#available-plugins-1">Available plugins:</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Description</th></tr></thead><tbody>
<tr><td><a href="dc/./dc/conditions/plugins/moving.html">Robot moving</a></td><td>Robot is moving</td></tr>
</tbody></table>
</div><footer id="open-on-gh">Found a bug? <a href="https://github.com/brisa-robotics/ros2_data_collection/edit/main/doc/src/dc/conditions.md">Edit this page on GitHub.</a></footer><div style="break-before: page; page-break-before: always;"></div><h1 id="moving"><a class="header" href="#moving">Moving</a></h1>
<h2 id="description-17"><a class="header" href="#description-17">Description</a></h2>
<p>Use a <a href="https://www.wikiwand.com/en/Hysteresis">hysteresis</a> on robot position to know whether the robot is moving.</p>
<h2 id="parameters-11"><a class="header" href="#parameters-11">Parameters</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Parameter</th><th>Description</th><th>Type</th><th>Default</th></tr></thead><tbody>
<tr><td><strong>odom_topic</strong></td><td>Topic from where odom is used to know if the robot is moving</td><td>str</td><td>&quot;/odom&quot;</td></tr>
<tr><td><strong>speed_threshold</strong></td><td>Speed threshold used in the hysteresis</td><td>float</td><td>0.2</td></tr>
<tr><td><strong>count_limit</strong></td><td>Counter to know if the robot is moving</td><td>int</td><td>8</td></tr>
<tr><td><strong>count_hysteresis</strong></td><td>Hysteresis counter</td><td>int</td><td>5</td></tr>
</tbody></table>
</div><footer id="open-on-gh">Found a bug? <a href="https://github.com/brisa-robotics/ros2_data_collection/edit/main/doc/src/dc/conditions/moving.md">Edit this page on GitHub.</a></footer><div style="break-before: page; page-break-before: always;"></div><h1 id="data-validation"><a class="header" href="#data-validation">Data validation</a></h1>
<p>Each measurement cam validate its data with a model.</p>
<p>We use use <a href="https://github.com/pboettch/json-schema-validator">JSON schema validator for JSON for Modern C++</a>.</p>
<p>Schemas follow the JSON 7 model:</p>
<pre><code class="language-json">{
    &quot;$schema&quot;: &quot;http://json-schema.org/draft-07/schema#&quot;,
    &quot;title&quot;: &quot;Uptime&quot;,
    &quot;description&quot;: &quot;Time the system has been up&quot;,
    &quot;properties&quot;: {
        &quot;time&quot;: {
            &quot;description&quot;: &quot;Time the system has been up&quot;,
            &quot;type&quot;: &quot;integer&quot;,
            &quot;minimum&quot;: 0
        }
    },
    &quot;type&quot;: &quot;object&quot;
}
</code></pre>
<p>It is possible to enforce the validation. By default, it is disabled since some fields can be filtered out, and some are added dynamically (e.g remote paths).</p>
<p>Currently it is not possible to select another schema but it is planned to be able to pass a custom path later on.</p>
<footer id="open-on-gh">Found a bug? <a href="https://github.com/brisa-robotics/ros2_data_collection/edit/main/doc/src/dc/data_validation.md">Edit this page on GitHub.</a></footer><div style="break-before: page; page-break-before: always;"></div><h1 id="groups"><a class="header" href="#groups">Groups</a></h1>
<h2 id="description-18"><a class="header" href="#description-18">Description</a></h2>
<p>Each measurement is part of a group. This allows measurements to be grouped together later on. For example, having the measurements cpu and position belonging to the same group, data will be published together on <code>/dc/group/my_group</code></p>
<pre><code class="language-json">{
    &quot;cpu&quot;: ...,
    &quot;position&quot;: ...,
}
</code></pre>
<p>Currently, this node is written in python. The main reason for it is that we don't know how to allocate and pass different amount of variables to the TimeSynchronizer. In python it is quite simple, but not so in C++.</p>
<h2 id="node-parameters-1"><a class="header" href="#node-parameters-1">Node parameters</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Parameter</th><th>Description</th><th>Type</th><th>Default</th></tr></thead><tbody>
<tr><td>groups</td><td>Groups to enable</td><td>list[str]</td><td>N/A</td></tr>
</tbody></table>
</div>
<h2 id="group-parameters"><a class="header" href="#group-parameters">Group parameters</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Parameter</th><th>Description</th><th>Type</th><th>Default</th></tr></thead><tbody>
<tr><td>inputs</td><td>Name of the input topics to group</td><td>list[str]</td><td>N/A</td></tr>
<tr><td>output</td><td>Output topic to send the data to</td><td>str</td><td>&quot;/dc/group/{group}&quot;</td></tr>
<tr><td>sync_delay</td><td>Delay to wait during all subscriber data need to reach before being published again</td><td>float</td><td>5.0</td></tr>
<tr><td>group_key</td><td>Dictionary key under which data is grouped</td><td>str</td><td>{group_name}</td></tr>
<tr><td>exclude_keys</td><td>List of keys to exclude from the published data. Data depth is separated by a dot</td><td>list[str]</td><td>N/A</td></tr>
<tr><td>tags</td><td>Destination names, used to know where data will be forwarded to</td><td>list[str]</td><td>N/A</td></tr>
<tr><td>nested_data</td><td>Whether measurements are nested dictionaries or flat</td><td>bool</td><td>false</td></tr>
</tbody></table>
</div>
<h2 id="example"><a class="header" href="#example">Example</a></h2>
<pre><code class="language-yaml">group_server:
  ros__parameters:
    groups: [&quot;map&quot;, &quot;memory_uptime&quot;]
    memory_cpu:
      inputs: [&quot;/dc/measurement/memory&quot;, &quot;/dc/measurement/cpu&quot;]
      output: &quot;/dc/group/memory_cpu&quot;
      sync_delay: 5.0
      group_key: &quot;memory_cpu&quot;
      tags: [&quot;flb_pgsql&quot;]
    memory_uptime:
      inputs: [&quot;/dc/measurement/memory&quot;, &quot;/dc/measurement/uptime&quot;]
      output: &quot;/dc/group/memory_uptime&quot;
      sync_delay: 5.0
      group_key: &quot;memory_uptime&quot;
      tags: [&quot;flb_stdout&quot;]
    cameras:
      inputs: [&quot;/dc/measurement/camera&quot;]
      output: &quot;/dc/group/cameras&quot;
      sync_delay: 5.0
      group_key: &quot;cameras&quot;
      tags: [&quot;flb_minio&quot;, &quot;flb_stdout&quot;]
    map:
      inputs: [&quot;/dc/measurement/map&quot;]
      output: &quot;/dc/group/map&quot;
      sync_delay: 5.0
      group_key: &quot;map&quot;
      tags: [&quot;flb_minio&quot;, &quot;flb_stdout&quot;]
</code></pre>
<footer id="open-on-gh">Found a bug? <a href="https://github.com/brisa-robotics/ros2_data_collection/edit/main/doc/src/dc/groups.md">Edit this page on GitHub.</a></footer><div style="break-before: page; page-break-before: always;"></div><h1 id="overview-1"><a class="header" href="#overview-1">Overview</a></h1>
<h2 id="description-19"><a class="header" href="#description-19">Description</a></h2>
<p>A destination is where the data will be sent: AWS S3, stdout, AWS Kinesis. It has the possibility to use <a href="https://docs.fluentbit.io/manual/pipeline/outputs">outputs from fluentbit</a>.</p>
<p>The destination node is similar to the measurement one. It:</p>
<ul>
<li>Either subscribes to data in the main node and data is forwarded with ros based destination plugins</li>
<li>Either subscribes to data from the ros2 fluent bit plugin.</li>
</ul>
<p>The fluent bit plugin is the preferred one since when using it, we get all the benefits from fluent bit (especially data integrity). The ros2 fluent bit plugin uses rclc and is at the moment a fork of fluent bit. It could also be rewritten as a fluent bit plugin based on the GO interface, but pros and cons to move to it are not clear yet.</p>
<h2 id="node-parameters-2"><a class="header" href="#node-parameters-2">Node parameters</a></h2>
<p>Destinations parameters are loaded dynamically. Here are the static ones:</p>
<div class="table-wrapper"><table><thead><tr><th>Parameter name</th><th>Description</th><th>Type(s)</th><th>Default</th></tr></thead><tbody>
<tr><td><a href="https://docs.fluentbit.io/manual/v/1.3/service">flb.flush</a></td><td>Interval to flush output (seconds)</td><td>str</td><td>&quot;1&quot;</td></tr>
<tr><td><a href="https://docs.fluentbit.io/manual/v/1.3/service">flb.grace</a></td><td>Wait time (seconds) on exit</td><td>str</td><td>&quot;1&quot;</td></tr>
<tr><td><a href="https://docs.fluentbit.io/manual/v/1.3/service">flb.log_level</a></td><td>Diagnostic level (error/warning/info/debug/trace)</td><td>str</td><td>&quot;info&quot;</td></tr>
<tr><td><a href="https://docs.fluentbit.io/manual/administration/buffering-and-storage">flb.storage_path</a></td><td>Set an optional location in the file system to store streams and chunks of data. If this parameter is not set, Input plugins can only use in-memory buffering.</td><td>str</td><td>&quot;/var/log/flb-storage/&quot;</td></tr>
<tr><td><a href="https://docs.fluentbit.io/manual/administration/buffering-and-storage">flb.storage_sync</a></td><td>Configure the synchronization mode used to store the data into the file system. It can take the values normal or full.</td><td>str</td><td>&quot;normal&quot;</td></tr>
<tr><td><a href="https://docs.fluentbit.io/manual/administration/buffering-and-storage">flb.storage_checksum</a></td><td>Enable the data integrity check when writing and reading data from the filesystem. The storage layer uses the CRC32 algorithm.</td><td>str</td><td>&quot;off&quot;</td></tr>
<tr><td><a href="https://docs.fluentbit.io/manual/administration/buffering-and-storage">flb.storage_backlog_mem_limit</a></td><td>If storage.path is set, Fluent Bit will look for data chunks that were not delivered and are still in the storage layer, these are called backlog data. This option configure a hint of maximum value of memory to use when processing these records.</td><td>str</td><td>&quot;5M&quot;</td></tr>
<tr><td><a href="https://docs.fluentbit.io/manual/administration/scheduling-and-retries">flb.scheduler_cap</a></td><td>Set a maximum retry time in seconds. The property is supported from v1.8.7.</td><td>str</td><td>&quot;2000&quot;</td></tr>
<tr><td><a href="https://docs.fluentbit.io/manual/administration/scheduling-and-retries">flb.scheduler_base</a></td><td>Set a base of exponential backoff. The property is supported from v1.8.7.</td><td>str</td><td>&quot;5&quot;</td></tr>
<tr><td><a href="https://docs.fluentbit.io/manual/administration/buffering-and-storage">flb.metrics</a></td><td>f http_server option has been enabled in the main [SERVICE] section, this option registers a new endpoint where internal metrics of the storage layer can be consumed. For more details refer to the <a href="https://docs.fluentbit.io/manual/administration/monitoring">Monitoring</a> section</td><td>bool</td><td>false</td></tr>
<tr><td><a href="https://docs.fluentbit.io/manual/administration/buffering-and-storage#input-section-configuration">flb.in_storage_type</a></td><td>Specifies the buffering mechanism to use. It can be memory or filesystem.</td><td>str</td><td>&quot;filesystem&quot;</td></tr>
<tr><td><a href="https://docs.fluentbit.io/manual/administration/buffering-and-storage#input-section-configuration">flb.in_storage_pause_on_chunks_overlimit</a></td><td>Specifies if file storage is to be paused when reaching the chunk limit.</td><td>str</td><td>&quot;off&quot;</td></tr>
<tr><td>custom_str_params_list</td><td>Custom strings to use in other parameters. They are also appended in the json sent to the destination</td><td>list[str]</td><td>N/A</td></tr>
<tr><td>run_id.enabled</td><td>Identify which run the robot is. A new one is generated at every start of the node. Uses either a counter or UUID</td><td>str</td><td>&quot;true&quot;</td></tr>
<tr><td>run_id.counter</td><td>Enable counter for the run_id</td><td>str</td><td>&quot;true&quot;</td></tr>
<tr><td>run_id.counter_path</td><td>Path to store the last run. It is expanded with environment variables id</td><td>str</td><td>&quot;$HOME/run_id&quot;</td></tr>
<tr><td>run_id.uuid</td><td>Enable use of UUID.</td><td>str</td><td>&quot;false&quot;</td></tr>
</tbody></table>
</div>
<h2 id="plugin-parameters-1"><a class="header" href="#plugin-parameters-1">Plugin parameters</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Parameter name</th><th>Description</th><th>Type(s)</th><th>Default</th></tr></thead><tbody>
<tr><td>plugin</td><td>Plugins to load</td><td>list[str]</td><td>N/A</td></tr>
<tr><td>inputs</td><td>Topics to which to listen to get the data</td><td>list[str]</td><td>N/A</td></tr>
<tr><td>debug</td><td>Enable debug print</td><td>bool</td><td>false</td></tr>
<tr><td>time_format</td><td>Format the data will be printed</td><td>str(&quot;double&quot;, &quot;iso8601&quot;)</td><td>&quot;double&quot;</td></tr>
<tr><td>time_key</td><td>Dictionary key from which date will be taken from</td><td>str</td><td>&quot;date&quot;</td></tr>
</tbody></table>
</div>
<h2 id="available-plugins-2"><a class="header" href="#available-plugins-2">Available plugins:</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Description</th></tr></thead><tbody>
<tr><td><a href="dc/./dc/destinations/flb_file.html">flb_file</a></td><td>JSON in a file via Fluent bit</td></tr>
<tr><td><a href="dc/./dc/destinations/flb_http.html">flb_http</a></td><td>JSON to http request via Fluent bit</td></tr>
<tr><td><a href="dc/./dc/destinations/flb_kinesis_streams.html">flb_kinesis_streams</a></td><td>JSON to AWS Kinesis Streams via Fluent bit</td></tr>
<tr><td><a href="dc/./dc/destinations/flb_minio.html">flb_minio</a></td><td>JSON to Minio via Fluent bit</td></tr>
<tr><td><a href="dc/./dc/destinations/flb_pgsql.html">flb_pgsql</a></td><td>JSON to PostgreSQL via Fluent bit</td></tr>
<tr><td><a href="dc/./dc/destinations/flb_stdout.html">flb_stdout</a></td><td>JSON to STDOUT via Fluent bit</td></tr>
<tr><td><a href="dc/./dc/destinations/rcl.html">rcl</a></td><td>JSON to RCL</td></tr>
</tbody></table>
</div>
<h2 id="example-configuration-1"><a class="header" href="#example-configuration-1">Example configuration</a></h2>
<pre><code class="language-yaml">destination_server:
  ros__parameters:
    flb:
      flush: &quot;1&quot;
      flb_grace: &quot;1&quot;
      log_level: &quot;info&quot;
      storage_path: &quot;/var/log/flb-storage/&quot;
      storage_sync: &quot;full&quot;
      storage_checksum: &quot;off&quot;
      storage_backlog_mem_limit: &quot;1M&quot;
      scheduler_cap: &quot;2000&quot;
      scheduler_base: &quot;5&quot;
      metrics: true
      in_storage_type: &quot;filesystem&quot;
      in_storage_pause_on_chunks_overlimit: &quot;off&quot;
    destination_plugins: [&quot;flb_stdout&quot;]
    custom_str_params_list: [&quot;robot_name&quot;, &quot;id&quot;]
    custom_str_params:
      robot_name:
        name: robot_name
        value: david-pc
      id:
        name: id
        value_from_file: /etc/machine-id
    run_id:
      enabled: true
      counter: true
      counter_path: &quot;$HOME/run_id&quot;
      uuid: false
    flb_minio:
      plugin: &quot;dc_destinations/Flbminio&quot;
      inputs: [&quot;/dc/group/map&quot;]
      plugin_path: &quot;/root/ws/src/ros2_data_collection/dc_destinations/flb_plugins/lib/out_minio.so&quot;
      endpoint: 127.0.0.1:9000
      access_key_id: HgJdDWeDQBiBWCwm
      secret_access_key: plCMROO2VMZIKiqEwDd80dLJUCRvJ9iu
      use_ssl: &quot;false&quot;
      create_bucket: &quot;true&quot;
      bucket: &quot;mybucket&quot;
      src_fields: [&quot;camera.local_img_paths.raw&quot;,&quot;camera.local_img_paths.rotated&quot;, &quot;map.local_map_paths.yaml&quot;, &quot;map.local_map_paths.pgm&quot;]
      upload_fields: [&quot;camera.minio_img_paths.raw&quot;,&quot;camera.minio_img_paths.rotated&quot;, &quot;map.minio_map_paths.yaml&quot;, &quot;map.minio_map_paths.pgm&quot;]
    flb_pgsql:
      plugin: &quot;dc_destinations/Flbpgsql&quot;
      inputs: [&quot;/dc/group/memory_uptime&quot;]
      host: &quot;127.0.0.1&quot;
      port: &quot;5432&quot;
      user: fluentbit
      password: password
      database: &quot;fluentbit&quot;
      table: &quot;wr_table&quot;
      timestamp_key: &quot;date&quot;
      async: &quot;false&quot;
      time_format: &quot;double&quot;
      time_key: &quot;date&quot;
    rcl:
      plugin: &quot;dc_destinations/Rcl&quot;
      inputs: [&quot;/dc/group/memory_uptime&quot;]
    flb_stdout:
      plugin: &quot;dc_destinations/Flbstdout&quot;
      inputs: [&quot;/dc/group/cameras&quot;]
      inputs: [&quot;/dc/group/cameras&quot;]
      time_format: &quot;iso8601&quot;
      time_key: &quot;date&quot;
    flb_http:
      plugin: &quot;dc_destinations/Flbhttp&quot;
      inputs: [&quot;/dc/group/memory_uptime&quot;]
      debug: true
    flb_file:
      plugin: &quot;dc_destinations/Flbfile&quot;
      inputs: [&quot;/dc/group/memory_uptime&quot;]
      path: &quot;$HOME/data&quot;
      file: uptime
      debug: false
      throttle:
        enable: false
        rate: &quot;1&quot;
        window: &quot;5&quot;
        interval: &quot;10s&quot;
        print_status: &quot;true&quot;
</code></pre>
<footer id="open-on-gh">Found a bug? <a href="https://github.com/brisa-robotics/ros2_data_collection/edit/main/doc/src/dc/destinations.md">Edit this page on GitHub.</a></footer><div style="break-before: page; page-break-before: always;"></div><h1 id="file---fluent-bit"><a class="header" href="#file---fluent-bit">File - Fluent Bit</a></h1>
<h2 id="description-20"><a class="header" href="#description-20">Description</a></h2>
<p>The file output plugin allows to write the data received through the input plugin to file. See <a href="https://docs.fluentbit.io/manual/pipeline/outputs/file">fluent bit page</a> for more information.</p>
<h2 id="parameters-12"><a class="header" href="#parameters-12">Parameters</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Parameter</th><th>Description</th><th>Type</th><th>Default</th></tr></thead><tbody>
<tr><td><strong>path</strong></td><td>Topic from where odom is used to know if the robot is moving</td><td>str</td><td>&quot;$HOME/data&quot;</td></tr>
<tr><td><strong>file</strong></td><td>Speed threshold used in the hysteresis</td><td>str</td><td>&quot;data&quot;</td></tr>
<tr><td><strong>format</strong></td><td>Counter to know if the robot is moving</td><td>str</td><td>&quot;plain&quot;</td></tr>
<tr><td><strong>mkdir</strong></td><td>Create directory if missing</td><td>str</td><td>&quot;true&quot;</td></tr>
</tbody></table>
</div><footer id="open-on-gh">Found a bug? <a href="https://github.com/brisa-robotics/ros2_data_collection/edit/main/doc/src/dc/destinations/flb_file.md">Edit this page on GitHub.</a></footer><div style="break-before: page; page-break-before: always;"></div><h1 id="files-metrics---fluent-bit"><a class="header" href="#files-metrics---fluent-bit">Files metrics - Fluent Bit</a></h1>
<h2 id="description-21"><a class="header" href="#description-21">Description</a></h2>
<p>Tracks files (yaml files, jpg pictures etc.) sent to their destinations (s3, minio etc.). We can then delete files locally when they have been sent to all their storage destinations.</p>
<p>It loads a Fluent Bit plugin we wrote ourselves to do this task, located in the fluent_bit_plugins package.</p>
<p>It creates a table on the database (currently PostgresSQL only) to store each file status.</p>
<pre class="mermaid">erDiagram
    files_metrics {
        integer id
        timestamp timestamp
        text robot_name
        text robot_id
        text input_name
        double duration
        text local_path
        text remote_path
        bool uploaded
        bool on_filesystem
        bool deleted
        bool ignored
        text storage_type
        text content_type
        integer size
        timestamp created_at
        timestamp updated_at
    }
</pre>
<h2 id="parameters-13"><a class="header" href="#parameters-13">Parameters</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Parameter</th><th>Description</th><th>Type</th><th>Default</th></tr></thead><tbody>
<tr><td><strong>plugin_path</strong></td><td>Where data will be stored</td><td>str</td><td>&lt;install_path&gt;/lib/out_files_metrics.so</td></tr>
<tr><td><strong>file_storage</strong></td><td>Where data will be stored</td><td>list[str]</td><td>N/A (Mandatory)</td></tr>
<tr><td><strong>db_type</strong></td><td>Speed threshold used in the hysteresis</td><td>str</td><td>&quot;pgsql&quot;</td></tr>
<tr><td><strong>delete_when_sent</strong></td><td>Counter to know if the robot is moving</td><td>bool</td><td>true</td></tr>
<tr><td><strong>minio.endpoint</strong></td><td>Minio endpoint</td><td>str</td><td>&quot;127.0.0.1:9000&quot;</td></tr>
<tr><td><strong>minio.access_key_id</strong></td><td>Minio Access key ID</td><td>str</td><td>N/A (Mandatory)</td></tr>
<tr><td><strong>minio.secret_access_key</strong></td><td>Minio Secret access key</td><td>str</td><td>N/A (Mandatory)</td></tr>
<tr><td><strong>minio.use_ssl</strong></td><td>Use SSL for Minio</td><td>bool</td><td>true</td></tr>
<tr><td><strong>minio.bucket</strong></td><td>Minio Bucket name</td><td>str</td><td>&quot;dc_bucket&quot;</td></tr>
<tr><td><strong>minio.src_fields</strong></td><td>Local paths for Minio</td><td>str</td><td>N/A (Mandatory)</td></tr>
<tr><td><strong>minio.upload_fields</strong></td><td>Remote paths for Minio</td><td>str</td><td>N/A (Mandatory)</td></tr>
<tr><td><strong>s3.endpoint</strong></td><td>Hysteresis counter</td><td>str</td><td>N/A (Mandatory)</td></tr>
<tr><td><strong>s3.access_key_id</strong></td><td>Hysteresis counter</td><td>str</td><td>N/A (Mandatory)</td></tr>
<tr><td><strong>s3.secret_access_key</strong></td><td>Hysteresis counter</td><td>str</td><td>N/A (Mandatory)</td></tr>
<tr><td><strong>s3.bucket</strong></td><td>Hysteresis counter</td><td>str</td><td>N/A (Mandatory)</td></tr>
<tr><td><strong>s3.src_fields</strong></td><td>Hysteresis counter</td><td>str</td><td>N/A (Mandatory)</td></tr>
<tr><td><strong>s3.upload_fields</strong></td><td>Hysteresis counter</td><td>str</td><td>N/A (Mandatory)</td></tr>
<tr><td><strong>pgsql.host</strong></td><td>Hysteresis counter</td><td>str</td><td>&quot;127.0.0.1&quot;</td></tr>
<tr><td><strong>pgsql.port</strong></td><td>Hysteresis counter</td><td>str</td><td>&quot;5432&quot;</td></tr>
<tr><td><strong>pgsql.user</strong></td><td>Hysteresis counter</td><td>str</td><td>&lt;system_username&gt;</td></tr>
<tr><td><strong>pgsql.password</strong></td><td>Hysteresis counter</td><td>str</td><td>&quot;&quot;</td></tr>
<tr><td><strong>pgsql.database</strong></td><td>Hysteresis counter</td><td>str</td><td>&lt;system_username&gt;</td></tr>
<tr><td><strong>pgsql.table</strong></td><td>Hysteresis counter</td><td>str</td><td>&quot;pg_table&quot;</td></tr>
<tr><td><strong>pgsql.ssl</strong></td><td>Hysteresis counter</td><td>bool</td><td>true</td></tr>
</tbody></table>
</div>
<h2 id="example-1"><a class="header" href="#example-1">Example</a></h2>
<pre><code class="language-yaml">flb_files_metrics:
    plugin: &quot;dc_destinations/Flbfilesmetrics&quot;
    inputs: [&quot;/dc/group/map&quot;]
    file_storage: [&quot;minio&quot;, &quot;s3&quot;]
    db_type: &quot;pgsql&quot;
    debug: true
    delete_when_sent: true
    minio:
        endpoint: 127.0.0.1:9000
        access_key_id: XEYqG4ZcPY5jiq5i
        secret_access_key: ji011KCtI82ZeQS6UwsQAg8x9VR4lSaQ
        use_ssl: false
        bucket: &quot;mybucket&quot;
        src_fields: [&quot;map.local_paths.pgm&quot;, &quot;map.local_paths.yaml&quot;]
        upload_fields: [&quot;map.minio_paths.pgm&quot;, &quot;map.minio_paths.yaml&quot;]
    s3:
        endpoint: 127.0.0.1:9000
        access_key_id: XEYqG4ZcPY5jiq5i
        secret_access_key: ji011KCtI82ZeQS6UwsQAg8x9VR4lSaQ
        bucket: &quot;mybucket&quot;
        src_fields: [&quot;map.local_paths.yaml&quot;]
        upload_fields: [&quot;map.s3_paths.yaml&quot;]
    pgsql:
        host: &quot;127.0.0.1&quot;
        port: &quot;5432&quot;
        user: fluentbit
        password: password
        database: &quot;fluentbit&quot;
        table: &quot;files_metrics&quot;
        timestamp_key: &quot;date&quot;
        time_format: &quot;double&quot;
        time_key: &quot;date&quot;
        ssl: false
</code></pre>
<footer id="open-on-gh">Found a bug? <a href="https://github.com/brisa-robotics/ros2_data_collection/edit/main/doc/src/dc/destinations/flb_files_metrics.md">Edit this page on GitHub.</a></footer><div style="break-before: page; page-break-before: always;"></div><h1 id="http---fluent-bit"><a class="header" href="#http---fluent-bit">HTTP - Fluent Bit</a></h1>
<h2 id="description-22"><a class="header" href="#description-22">Description</a></h2>
<p>The http output plugin allows to flush your records into a HTTP endpoint. For now the functionality is pretty basic and it issues a POST request with the data records in <a href="http://msgpack.org/">MessagePack</a> (or JSON) format. See <a href="https://docs.fluentbit.io/manual/pipeline/outputs/http">fluent bit page</a> for more information.</p>
<h2 id="parameters-14"><a class="header" href="#parameters-14">Parameters</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Parameter</th><th>Description</th><th>Type</th><th>Default</th></tr></thead><tbody>
<tr><td><strong>host</strong></td><td>IP address or hostname of the target HTTP Server</td><td>str</td><td>&quot;127.0.0.1&quot;</td></tr>
<tr><td><strong>port</strong></td><td>TCP port of the target HTTP Server</td><td>str</td><td>&quot;80&quot;</td></tr>
<tr><td><strong>uri</strong></td><td>Specify an optional HTTP URI for the target web server, e.g: /something</td><td>str</td><td>&quot;/&quot;</td></tr>
<tr><td><strong>format</strong></td><td>Specify the data format to be used in the HTTP request body, by default it uses msgpack. Other supported formats are json, json_stream and json_lines and gelf.</td><td>str</td><td>&quot;json&quot;</td></tr>
<tr><td><strong>header</strong></td><td>Add a HTTP header key/value pair. Multiple headers can be set.</td><td>str</td><td>N/A</td></tr>
<tr><td><strong>headers_key</strong></td><td>Specify the key to use as the headers of the request (must prefix with &quot;$&quot;). The key must contain a map, which will have the contents merged on the request headers. This can be used for many purposes, such as specifying the content-type of the data contained in body_key.</td><td>str</td><td>N/A</td></tr>
<tr><td><strong>header_tag</strong></td><td>Specify an optional HTTP header field for the original message tag.</td><td>str</td><td>N/A</td></tr>
<tr><td><strong>json_date_key</strong></td><td>Specify the name of the time key in the output record. To disable the time key just set the value to false.</td><td>str</td><td>&quot;date&quot;</td></tr>
<tr><td><strong>json_date_format</strong></td><td>Specify the format of the date. Supported formats are double, epoch, iso8601 (eg: 2018-05-30T09:39:52.000681Z) and java_sql_timestamp (eg: 2018-05-30 09:39:52.000681)</td><td>str</td><td>&quot;double&quot;</td></tr>
<tr><td><strong>http_user</strong></td><td>Basic Auth Username</td><td>str</td><td>N/A</td></tr>
<tr><td><strong>http_passwd</strong></td><td>Basic Auth Password. Requires HTTP_User to be set</td><td>str</td><td>N/A</td></tr>
<tr><td><strong>log_response_payload</strong></td><td>Specify if the response paylod should be logged or not.</td><td>str</td><td>&quot;true&quot;</td></tr>
<tr><td><strong>allow_duplicated_headers</strong></td><td>Specify if duplicated headers are allowed. If a duplicated header is found, the latest key/value set is preserved.</td><td>str</td><td>&quot;true&quot;</td></tr>
</tbody></table>
</div><footer id="open-on-gh">Found a bug? <a href="https://github.com/brisa-robotics/ros2_data_collection/edit/main/doc/src/dc/destinations/flb_http.md">Edit this page on GitHub.</a></footer><div style="break-before: page; page-break-before: always;"></div><h1 id="aws-kinesis-data-streams---fluent-bit"><a class="header" href="#aws-kinesis-data-streams---fluent-bit">AWS Kinesis Data Streams - Fluent Bit</a></h1>
<h2 id="description-23"><a class="header" href="#description-23">Description</a></h2>
<p>The Amazon Kinesis Data Streams output plugin allows to ingest your records into the <a href="https://aws.amazon.com/kinesis/data-streams/">Kinesis</a> service. This is the documentation for the core Fluent Bit Kinesis plugin written in C. It has all the core features of the <a href="https://github.com/aws/amazon-kinesis-streams-for-fluent-bit">aws/amazon-kinesis-streams-for-fluent-bit</a>. Golang Fluent Bit plugin released in 2019. The Golang plugin was named kinesis; this new high performance and highly efficient kinesis plugin is called kinesis_streams to prevent conflicts/confusion. See <a href="https://github.com/fluent/fluent-bit-docs/tree/43c4fe134611da471e706b0edb2f9acd7cdfdbc3/administration/aws-credentials.md">here</a> for details on how AWS credentials are fetched. See <a href="https://docs.fluentbit.io/manual/pipeline/outputs/kinesis">fluent bit page</a> for more information.</p>
<h2 id="parameters-15"><a class="header" href="#parameters-15">Parameters</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Parameter</th><th>Description</th><th>Type</th><th>Default</th></tr></thead><tbody>
<tr><td><strong>region</strong></td><td>The AWS region.</td><td>str</td><td>N/A</td></tr>
<tr><td><strong>stream</strong></td><td>The name of the Kinesis Streams Delivery stream that you want log records sent to.</td><td>str</td><td>N/A</td></tr>
<tr><td><strong>role_arn</strong></td><td>ARN of an IAM role to assume (for cross account access).</td><td>str</td><td>N/A</td></tr>
<tr><td><strong>time_key</strong></td><td>Add the timestamp to the record under this key. By default the timestamp from Fluent Bit will not be added to records sent to Kinesis.</td><td>str</td><td>N/A</td></tr>
<tr><td><strong>time_key_format</strong></td><td>strftime compliant format string for the timestamp; for example, the default is '%Y-%m-%dT%H:%M:%S'. Supports millisecond precision with '%3N' and supports nanosecond precision with '%9N' and '%L'; for example, adding '%3N' to support millisecond '%Y-%m-%dT%H:%M:%S.%3N'. This option is used with time_key.</td><td>str</td><td>&quot;%Y-%m-%dT%H:%M:%S&quot;</td></tr>
<tr><td><strong>log_key</strong></td><td>By default, the whole log record will be sent to Kinesis. If you specify a key name with this option, then only the value of that key will be sent to Kinesis. For example, if you are using the Fluentd Docker log driver, you can specify log_key log and only the log message will be sent to Kinesis. Server</td><td>str</td><td>N/A</td></tr>
<tr><td><strong>endpoint</strong></td><td>Specify a custom endpoint for the Kinesis API.Server</td><td>str</td><td>N/A</td></tr>
<tr><td><strong>auto_retry_requests</strong></td><td>Immediately retry failed requests to AWS services once. This option does not affect the normal Fluent Bit retry mechanism with backoff. Instead, it enables an immediate retry with no delay for networking errors, which may help improve throughput when there are transient/random networking issues. This option defaults to true.Server</td><td>str</td><td>&quot;true&quot;</td></tr>
</tbody></table>
</div><footer id="open-on-gh">Found a bug? <a href="https://github.com/brisa-robotics/ros2_data_collection/edit/main/doc/src/dc/destinations/flb_kinesis_data_streams.md">Edit this page on GitHub.</a></footer><div style="break-before: page; page-break-before: always;"></div><h1 id="minio---fluent-bit"><a class="header" href="#minio---fluent-bit">Minio - Fluent Bit</a></h1>
<h2 id="description-24"><a class="header" href="#description-24">Description</a></h2>
<p>The Minio Plugin allows to send files to Minio. It uses the GO interface provided by Fluent bit.</p>
<h2 id="difference-with-fluent-bit-s3-plugin"><a class="header" href="#difference-with-fluent-bit-s3-plugin">Difference with Fluent bit S3 Plugin</a></h2>
<p>The <a href="https://docs.fluentbit.io/manual/pipeline/outputs/s3">S3 plugin</a> sends data as JSON to S3 or Minio but does not send files themselves (e.g yaml, images etc.).</p>
<h2 id="parameters-16"><a class="header" href="#parameters-16">Parameters</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Parameter</th><th>Description</th><th>Type</th><th>Default</th></tr></thead><tbody>
<tr><td><strong>plugin_path</strong></td><td>Shared library path compiled by go</td><td>str</td><td>&quot;{package_share_directory}/flb_plugins/lib/out_minio.so&quot;</td></tr>
<tr><td><strong>endpoint</strong></td><td>Endpoint for the S3 API. An endpoint can contain scheme and port.</td><td>str</td><td>&quot;127.0.0.1:9000&quot;</td></tr>
<tr><td><strong>access_key_id</strong></td><td>Access keys are long-term credentials for an IAM user or the AWS account root user</td><td>str</td><td>N/A</td></tr>
<tr><td><strong>secret_access_key</strong></td><td>Secret-like password to connect along he access key id</td><td>str</td><td>N/A</td></tr>
<tr><td><strong>use_ssl</strong></td><td>If set to true, https is used instead of http. Default is true.</td><td>str</td><td>&quot;true&quot;</td></tr>
<tr><td><strong>create_bucket</strong></td><td>Whether the bucket will be created</td><td>str</td><td>&quot;true&quot;</td></tr>
<tr><td><strong>bucket</strong></td><td>Bucket name</td><td>str</td><td>&quot;dc_bucket&quot;</td></tr>
<tr><td><strong>upload_fields</strong></td><td>Fields containing remote paths, separated by dots</td><td>list[str]</td><td>N/A</td></tr>
<tr><td><strong>src_fields</strong></td><td>Fields containing local paths, separated by dots</td><td>list[str]</td><td>N/A</td></tr>
</tbody></table>
</div><footer id="open-on-gh">Found a bug? <a href="https://github.com/brisa-robotics/ros2_data_collection/edit/main/doc/src/dc/destinations/flb_minio.md">Edit this page on GitHub.</a></footer><div style="break-before: page; page-break-before: always;"></div><h1 id="postgresql---fluent-bit"><a class="header" href="#postgresql---fluent-bit">PostgreSQL - Fluent Bit</a></h1>
<h2 id="description-25"><a class="header" href="#description-25">Description</a></h2>
<p>PostgreSQL is a very popular and versatile open source database management system that supports the SQL language and that is capable of storing both structured and unstructured data, such as JSON objects.
. See <a href="https://docs.fluentbit.io/manual/pipeline/outputs/postgresql">fluent bit page</a> for more information.</p>
<h2 id="parameters-17"><a class="header" href="#parameters-17">Parameters</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Parameter</th><th>Description</th><th>Type</th><th>Default</th></tr></thead><tbody>
<tr><td><strong>host</strong></td><td>Hostname/IP address of the PostgreSQL instance</td><td>str</td><td>&quot;127.0.0.1&quot;</td></tr>
<tr><td><strong>port</strong></td><td>PostgreSQL port</td><td>str</td><td>&quot;5432&quot;</td></tr>
<tr><td><strong>user</strong></td><td>PostgreSQL username</td><td>str</td><td>&quot;{username}&quot;</td></tr>
<tr><td><strong>password</strong></td><td>Password of PostgreSQL username</td><td>str</td><td>N/A</td></tr>
<tr><td><strong>database</strong></td><td>Database name to connect to</td><td>str</td><td>&quot;{username}&quot;</td></tr>
<tr><td><strong>table</strong></td><td>Table name where to store data</td><td>str</td><td>N/A</td></tr>
<tr><td><strong>timestamp_Key</strong></td><td>Key in the JSON object containing the record timestamp</td><td>str</td><td>&quot;date&quot;</td></tr>
<tr><td><strong>async</strong></td><td>Define if we will use async or sync connections</td><td>str</td><td>&quot;false&quot;</td></tr>
<tr><td><strong>min_pool_size</strong></td><td>Minimum number of connection in async mode</td><td>str</td><td>&quot;1&quot;</td></tr>
<tr><td><strong>max_pool_size</strong></td><td>Maximum amount of connections in async mode</td><td>str</td><td>&quot;4&quot;</td></tr>
<tr><td><strong>cockroachdb</strong></td><td>Set to true if you will connect the plugin with a CockroachDB</td><td>str</td><td>&quot;false&quot;</td></tr>
</tbody></table>
</div><footer id="open-on-gh">Found a bug? <a href="https://github.com/brisa-robotics/ros2_data_collection/edit/main/doc/src/dc/destinations/flb_pgsql.md">Edit this page on GitHub.</a></footer><div style="break-before: page; page-break-before: always;"></div><h1 id="file---fluent-bit-1"><a class="header" href="#file---fluent-bit-1">File - Fluent Bit</a></h1>
<h2 id="description-26"><a class="header" href="#description-26">Description</a></h2>
<p>The stdout output plugin allows to print to the standard output the data received through the input plugin. See <a href="https://docs.fluentbit.io/manual/pipeline/outputs/standard-output">fluent bit page</a> for more information.</p>
<h2 id="parameters-18"><a class="header" href="#parameters-18">Parameters</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Parameter</th><th>Description</th><th>Type</th><th>Default</th></tr></thead><tbody>
<tr><td><strong>format</strong></td><td>Specify the data format to be printed. Supported formats are msgpack json, json_lines and json_stream.</td><td>str</td><td>&quot;json&quot;</td></tr>
<tr><td><strong>json_date_key</strong></td><td>Specify the name of the time key in the output record. To disable the time key just set the value to false.</td><td>str</td><td>&quot;date&quot;</td></tr>
<tr><td><strong>json_date_format</strong></td><td>Specify the format of the date. Supported formats are double, epoch, iso8601 (eg: 2018-05-30T09:39:52.000681Z) and java_sql_timestamp (eg: 2018-05-30 09:39:52.000681)</td><td>str</td><td>&quot;double&quot;</td></tr>
</tbody></table>
</div><footer id="open-on-gh">Found a bug? <a href="https://github.com/brisa-robotics/ros2_data_collection/edit/main/doc/src/dc/destinations/flb_stdout.md">Edit this page on GitHub.</a></footer><div style="break-before: page; page-break-before: always;"></div><h1 id="rcl---rclcpp"><a class="header" href="#rcl---rclcpp">RCL - RCLCPP</a></h1>
<h2 id="description-27"><a class="header" href="#description-27">Description</a></h2>
<p>The RCL output collects the data with ROS and display it with <code>RCLCPP_INFO</code> call.</p>
<h2 id="warning"><a class="header" href="#warning">Warning</a></h2>
<p>Note that plugins which are not using Fluent Bit like this one don't have any data integrity and persistence. Do not use in production!</p>
<footer id="open-on-gh">Found a bug? <a href="https://github.com/brisa-robotics/ros2_data_collection/edit/main/doc/src/dc/destinations/rcl.md">Edit this page on GitHub.</a></footer><div style="break-before: page; page-break-before: always;"></div><h1 id="future-work"><a class="header" href="#future-work">Future work</a></h1>
<footer id="open-on-gh">Found a bug? <a href="https://github.com/brisa-robotics/ros2_data_collection/edit/main/doc/src/dc/future/future_work.md">Edit this page on GitHub.</a></footer><div style="break-before: page; page-break-before: always;"></div><h1 id="roadmap"><a class="header" href="#roadmap">Roadmap</a></h1>
<iframe title='ROS2 Data Collection - Organization Embed' style='border:0px; height:100vh; width:100%;' src='https://ros2-data-collection.hellonext.co/embed/home?no_header=true'></iframe>
<footer id="open-on-gh">Found a bug? <a href="https://github.com/brisa-robotics/ros2_data_collection/edit/main/doc/src/dc/future/roadmap.md">Edit this page on GitHub.</a></footer><div style="break-before: page; page-break-before: always;"></div><h1 id="about-and-contact"><a class="header" href="#about-and-contact">About and Contact</a></h1>
<h2 id="about"><a class="header" href="#about">About</a></h2>
<p>Our team currently includes:</p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>GitHub ID</th></tr></thead><tbody>
<tr><td>David Bensoussan</td><td><a href="dc/github.com/minipada/">minipada</a></td></tr>
</tbody></table>
</div>
<h2 id="contact"><a class="header" href="#contact">Contact</a></h2>
<p>For any inquiry, please contact David (<a href="dc/david.bensoussan@brisa.tech">david.bensoussan@brisa.tech</a>). If your inquiry relates to bugs or open-source feature requests, consider posting a ticket on our GitHub project. If your inquiry relates to configuration support or private feature development, reach out and we will be able to support you in your projects.</p>
<footer id="open-on-gh">Found a bug? <a href="https://github.com/brisa-robotics/ros2_data_collection/edit/main/doc/src/dc/about_contact.md">Edit this page on GitHub.</a></footer>
                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->


                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">

            </nav>

        </div>

        <!-- Livereload script (if served using the cli tool) -->
        <script>
            const wsProtocol = location.protocol === 'https:' ? 'wss:' : 'ws:';
            const wsAddress = wsProtocol + "//" + location.host + "/" + "__livereload";
            const socket = new WebSocket(wsAddress);
            socket.onmessage = function (event) {
                if (event.data === "reload") {
                    socket.close();
                    location.reload();
                }
            };

            window.onbeforeunload = function() {
                socket.close();
            }
        </script>



        <script>
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js"></script>
        <script src="mark.min.js"></script>
        <script src="searcher.js"></script>

        <script src="clipboard.min.js"></script>
        <script src="highlight.js"></script>
        <script src="book.js"></script>

        <!-- Custom JS scripts -->
        <script src="js/mermaid.js"></script>
        <script src="js/mermaid-init.js"></script>

        <script>
        window.addEventListener('load', function() {
            window.setTimeout(window.print, 100);
        });
        </script>

    </body>
</html>
