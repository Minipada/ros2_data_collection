<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js navy">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Introduction - Data Collection for ROS 2</title>


        <!-- Custom HTML head -->
        
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="open-in.css">
        <link rel="stylesheet" href="./css/mdbook-admonish.css">

    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "navy";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('navy')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="dc/introduction.html" class="active"><strong aria-hidden="true">1.</strong> Introduction</a></li><li class="chapter-item "><a href="dc/build.html"><strong aria-hidden="true">2.</strong> Build</a></li><li class="chapter-item "><a href="dc/getting_started.html"><strong aria-hidden="true">3.</strong> Getting Started</a></li><li class="chapter-item "><a href="dc/measurements.html"><strong aria-hidden="true">4.</strong> Measurements</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="dc/measurements/camera.html"><strong aria-hidden="true">4.1.</strong> Camera</a></li><li class="chapter-item "><a href="dc/measurements/cmd_vel.html"><strong aria-hidden="true">4.2.</strong> Command velocity</a></li><li class="chapter-item "><a href="dc/measurements/cpu.html"><strong aria-hidden="true">4.3.</strong> CPU</a></li><li class="chapter-item "><a href="dc/measurements/distance_traveled.html"><strong aria-hidden="true">4.4.</strong> Distance traveled</a></li><li class="chapter-item "><a href="dc/measurements/ip_camera.html"><strong aria-hidden="true">4.5.</strong> IP Camera</a></li><li class="chapter-item "><a href="dc/measurements/map.html"><strong aria-hidden="true">4.6.</strong> Map</a></li><li class="chapter-item "><a href="dc/measurements/memory.html"><strong aria-hidden="true">4.7.</strong> Memory</a></li><li class="chapter-item "><a href="dc/measurements/network.html"><strong aria-hidden="true">4.8.</strong> Network</a></li><li class="chapter-item "><a href="dc/measurements/os.html"><strong aria-hidden="true">4.9.</strong> OS</a></li><li class="chapter-item "><a href="dc/measurements/permissions.html"><strong aria-hidden="true">4.10.</strong> Permissions</a></li><li class="chapter-item "><a href="dc/measurements/position.html"><strong aria-hidden="true">4.11.</strong> Position</a></li><li class="chapter-item "><a href="dc/measurements/speed.html"><strong aria-hidden="true">4.12.</strong> Speed</a></li><li class="chapter-item "><a href="dc/measurements/storage.html"><strong aria-hidden="true">4.13.</strong> Storage</a></li><li class="chapter-item "><a href="dc/measurements/string_stamped.html"><strong aria-hidden="true">4.14.</strong> String stamped</a></li><li class="chapter-item "><a href="dc/measurements/uptime.html"><strong aria-hidden="true">4.15.</strong> Uptime</a></li></ol></li><li class="chapter-item "><a href="dc/conditions.html"><strong aria-hidden="true">5.</strong> Conditions</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="dc/conditions/moving.html"><strong aria-hidden="true">5.1.</strong> Moving</a></li></ol></li><li class="chapter-item "><a href="dc/data_validation.html"><strong aria-hidden="true">6.</strong> Data validation</a></li><li class="chapter-item "><a href="dc/groups.html"><strong aria-hidden="true">7.</strong> Groups</a></li><li class="chapter-item "><a href="dc/destinations.html"><strong aria-hidden="true">8.</strong> Destinations</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="dc/destinations/flb_file.html"><strong aria-hidden="true">8.1.</strong> Fluent Bit File</a></li><li class="chapter-item "><a href="dc/destinations/flb_files_metrics.html"><strong aria-hidden="true">8.2.</strong> Fluent Bit Files metrics</a></li><li class="chapter-item "><a href="dc/destinations/flb_http.html"><strong aria-hidden="true">8.3.</strong> Fluent Bit HTTP</a></li><li class="chapter-item "><a href="dc/destinations/flb_kinesis_data_streams.html"><strong aria-hidden="true">8.4.</strong> Fluent Bit AWS Kinesis Data Streams</a></li><li class="chapter-item "><a href="dc/destinations/flb_minio.html"><strong aria-hidden="true">8.5.</strong> Fluent Bit Minio</a></li><li class="chapter-item "><a href="dc/destinations/flb_pgsql.html"><strong aria-hidden="true">8.6.</strong> Fluent Bit PostgresSQL</a></li><li class="chapter-item "><a href="dc/destinations/flb_stdout.html"><strong aria-hidden="true">8.7.</strong> Fluent Bit Stdout</a></li><li class="chapter-item "><a href="dc/destinations/rcl.html"><strong aria-hidden="true">8.8.</strong> RCL</a></li></ol></li><li class="chapter-item "><a href="dc/future/future_work.html"><strong aria-hidden="true">9.</strong> Future Work and Roadmap</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="dc/future/roadmap.html"><strong aria-hidden="true">9.1.</strong> Roadmap</a></li></ol></li><li class="chapter-item "><a href="dc/about_contact.html"><strong aria-hidden="true">10.</strong> About and Contact</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Data Collection for ROS 2</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/brisa-robotics/ros2_data_collection" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="introduction"><a class="header" href="#introduction">Introduction</a></h1>
<p>The DC project aims at integrating data collection pipelines into ROS2. This is meant to plug to existing APIs, for analytics, not for live monitoring (some awesome tools exist already). There is currently no generic ROS based framework used to collect data from ROS based robots that are aimed at being analyzed (ros bags are great for developers but not for other software developers who don't know about ROS). Understanding and improving operations for any type of machine in any environment has become an important reason companies move to autonomous robots. This involves mostly pick and drop and inspection operations. This framework aims at giving the data to create such APIs and dashboards.</p>
<p>DC uses a modular approach, based on <a href="https://index.ros.org/p/pluginlib/">pluginlib</a> and greatly inspired of <a href="https://navigation.ros.org/">Nav2</a> for its architecture. Pluginlib is used to configure which measurements are collected and where the data goes. Measurements and destinations are pluginlib plugins. In addition to pluginlib, all current plugins use <a href="https://fluentbit.io/">Fluent bit</a> in the backend: <em>Fluent Bit is a super fast, lightweight, and highly scalable logging and metrics processor and forwarder. It is the preferred choice for cloud and containerized environments. Developed and interfaced in C, it has already many features we directly can use, especially: high performance, reliability and data integrity (backpressure handling and data buffering in memory and filesystem)</em>.</p>
<h1 id="main-features"><a class="header" href="#main-features">Main features</a></h1>
<ul>
<li>Can set polling interval for each measurement</li>
<li>Data is transported as JSON through ROS messages</li>
<li>Each measurement data can be validated through JSON schemas (based on <a href="https://json-schema.org/draft-07/json-schema-release-notes.html">JSON schema 07</a>)</li>
<li>Adding a new measurement or destination requires only to add a plugin</li>
<li>Can also get from any ROS topics if published as a StringStamped message, then use the StringStamped plugin</li>
<li>Can exclude JSON fields for each measurement</li>
<li>Data can be collected on conditions, e.g the robot is moving. Conditions are also plugins in the measurement node</li>
<li>Data collection can be triggered if all, any or no condition are met</li>
<li>Can configure number of samples to collect at start and when condition is activated</li>
<li>No 3rd party library to install: All 3rd party libraries have a <a href="https://answers.ros.org/question/332915/what-does-the-_vendor-suffix-mean-in-a-package-name/">vendor</a> package and all python code uses the standard library.</li>
<li>Fluent bit outputs can be added by using the GO or C interface. A Fluent bit plugin needs to be written in this case</li>
<li>Measurements can be grouped using the group node based on the ApproximateTimeSynchronizer</li>
<li>Groups can exclude data</li>
</ul>
<p>Some other features related to some plugins:</p>
<ul>
<li>Data inspection is included in the camera input plugin. Currently, only barcode and QR codes can be analyzed.</li>
</ul>
<p>And inherited from Fluent Bit and ROS2:</p>
<ul>
<li><a href="https://docs.fluentbit.io/manual/v/1.0/configuration/backpressure">Backpressure handling</a></li>
<li><a href="https://docs.fluentbit.io/manual/v/1.0/configuration/buffering">Data buffering in memory and filesystem</a></li>
</ul>
<pre class="mermaid">flowchart LR
    pl_camera1[&quot;Camera bottom&quot;]
    pl_camera2[&quot;Camera middle&quot;]
    pl_camera3[&quot;Camera top&quot;]
    pl_condition_moving[&quot;Moving&quot;]
    pl_cpu[&quot;CPU&quot;]
    pl_cmd_vel[&quot;Command velocity&quot;]
    pl_memory[&quot;Memory&quot;]
    pl_position[&quot;Position&quot;]
    pl_speed[&quot;Speed&quot;]
    pl_storage[&quot;Storage&quot;]
    pl_uptime[&quot;Uptime&quot;]
    pl_network[&quot;Network&quot;]
    pl_network_boot[&quot;Network&quot;]
    pl_os_boot[&quot;OS&quot;]

    subgraph m_n[&quot;Measurement node&quot;]
        subgraph cond[&quot;Condition plugins&quot;]
            pl_condition_moving
        end
        subgraph measurements[&quot;Measurement plugins&quot;]
            pl_camera1
            pl_camera2
            pl_camera3
            pl_cpu
            pl_cmd_vel
            pl_memory
            pl_position
            pl_speed
            pl_storage
            pl_uptime
            pl_network
            pl_network_boot
            pl_os_boot
        end
    end

    subgraph g_n[&quot;Group node&quot;]
        gr_boot_system[&quot;System (boot)&quot;]
        gr_system[&quot;System&quot;]
        gr_robot[&quot;Robot&quot;]
        gr_inspection[&quot;Inspection&quot;]
    end

    subgraph d_n[&quot;Destination node&quot;]
        pl_pgsql[&quot;PostgresSQL&quot;]
        pl_minio[&quot;Minio&quot;]
        pl_s3[&quot;S3&quot;]
    end

    pl_camera1 -- if not --&gt; pl_condition_moving --&gt; gr_inspection
    pl_camera2 -- if not --&gt; pl_condition_moving --&gt; gr_inspection
    pl_camera3 -- if not --&gt; pl_condition_moving --&gt; gr_inspection
    pl_cpu --&gt; gr_system
    pl_memory --&gt; gr_system
    pl_uptime --&gt; gr_boot_system
    pl_network_boot --&gt; gr_boot_system
    pl_os_boot --&gt; gr_boot_system
    pl_storage --&gt; gr_system
    pl_cmd_vel --&gt; gr_robot
    pl_position --&gt; gr_robot
    pl_speed --&gt; gr_robot

    pl_network -- Network ping and online status --&gt; pl_pgsql
    gr_boot_system -- os, network interfaces\n, permissions and uptime --&gt; pl_pgsql
    gr_robot -- Robot cmd_vel, position. speed --&gt; pl_pgsql
    gr_system -- Available space,\n memory used and cpu usage --&gt; pl_pgsql
    gr_inspection -- Image paths on s3 and minio --&gt; pl_pgsql
    gr_inspection -- Raw, rotated and/or inspected images --&gt; pl_minio
    gr_inspection -- Raw, rotated and/or inspected images --&gt; pl_s3
</pre>
<footer id="open-on-gh">Found a bug? <a href="https://github.com/brisa-robotics/ros2_data_collection/edit/main/doc/src/dc/introduction.md">Edit this page on GitHub.</a></footer>
                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->

                            <a rel="next" href="dc/build.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">

                    <a rel="next" href="dc/build.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>

        <!-- Livereload script (if served using the cli tool) -->
        <script>
            const wsProtocol = location.protocol === 'https:' ? 'wss:' : 'ws:';
            const wsAddress = wsProtocol + "//" + location.host + "/" + "__livereload";
            const socket = new WebSocket(wsAddress);
            socket.onmessage = function (event) {
                if (event.data === "reload") {
                    socket.close();
                    location.reload();
                }
            };

            window.onbeforeunload = function() {
                socket.close();
            }
        </script>



        <script>
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js"></script>
        <script src="mark.min.js"></script>
        <script src="searcher.js"></script>

        <script src="clipboard.min.js"></script>
        <script src="highlight.js"></script>
        <script src="book.js"></script>

        <!-- Custom JS scripts -->
        <script src="js/mermaid.js"></script>
        <script src="js/mermaid-init.js"></script>


    </body>
</html>
