<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js navy">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Uptime - Data Collection for ROS 2</title>


        <!-- Custom HTML head -->
        
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="../../favicon.svg">
        <link rel="shortcut icon" href="../../favicon.png">
        <link rel="stylesheet" href="../../css/variables.css">
        <link rel="stylesheet" href="../../css/general.css">
        <link rel="stylesheet" href="../../css/chrome.css">
        <link rel="stylesheet" href="../../css/lineicon.css">
        <link rel="stylesheet" href="../../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../../highlight.css">
        <link rel="stylesheet" href="../../tomorrow-night.css">
        <link rel="stylesheet" href="../../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="../../open-in.css">
        <link rel="stylesheet" href="../.././css/mdbook-admonish.css">
        <link rel="stylesheet" href="../../css/logo.css">
        <link rel="stylesheet" href="../../css/lineicon.css">
        <link rel="stylesheet" href="../../css/theme.css">

        <!-- MathJax -->
        <script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

        <!-- Hotjar -->
        <script>
            if (window.location.href.startsWith("https://minipada.github.io/ros2_data_collection")) {
            (function(h,o,t,j,a,r){
                h.hj=h.hj||function(){(h.hj.q=h.hj.q||[]).push(arguments)};
                h._hjSettings={hjid:3435761,hjsv:6};
                a=o.getElementsByTagName('head')[0];
                r=o.createElement('script');r.async=1;
                r.src=t+h._hjSettings.hjid+j+h._hjSettings.hjsv;
                a.appendChild(r);
            })(window,document,'https://static.hotjar.com/c/hotjar-','.js?sv=');
            }
        </script>
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "../../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "navy";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('navy')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <a href="/"><img id="logo-dc"></a>
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item "><a href="../../dc/introduction.html"><strong aria-hidden="true">1.</strong> Introduction</a></li><li class="chapter-item "><a href="../../dc/setup.html"><strong aria-hidden="true">2.</strong> Setup</a></li><li class="chapter-item expanded "><a href="../../dc/demos.html"><strong aria-hidden="true">3.</strong> Demos</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../dc/demos/uptime_stdout.html" class="active"><strong aria-hidden="true">3.1.</strong> Uptime</a></li><li class="chapter-item "><a href="../../dc/demos/memory_uptime_stdout.html"><strong aria-hidden="true">3.2.</strong> Group memory and uptime</a></li><li class="chapter-item "><a href="../../dc/demos/tb3_stdout.html"><strong aria-hidden="true">3.3.</strong> Turtlebot3</a></li><li class="chapter-item "><a href="../../dc/demos/tb3_aws_minio_pgsql.html"><strong aria-hidden="true">3.4.</strong> Turtlebot3 AWS Warehouse MinIO PostgreSQL</a></li><li class="chapter-item "><a href="../../dc/demos/qrcodes_minio_pgsql.html"><strong aria-hidden="true">3.5.</strong> QRcodes to PostgreSQL/MinIO</a></li><li class="chapter-item "><a href="../../dc/demos/custom_stdout.html"><strong aria-hidden="true">3.6.</strong> Custom plugin</a></li></ol></li><li class="chapter-item "><a href="../../dc/concepts.html"><strong aria-hidden="true">4.</strong> Concepts</a></li><li class="chapter-item "><a href="../../dc/data_pipeline.html"><strong aria-hidden="true">5.</strong> Data Pipeline</a></li><li class="chapter-item "><a href="../../dc/measurements.html"><strong aria-hidden="true">6.</strong> Measurements</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../dc/measurements/camera.html"><strong aria-hidden="true">6.1.</strong> Camera</a></li><li class="chapter-item "><a href="../../dc/measurements/cmd_vel.html"><strong aria-hidden="true">6.2.</strong> Command velocity</a></li><li class="chapter-item "><a href="../../dc/measurements/cpu.html"><strong aria-hidden="true">6.3.</strong> CPU</a></li><li class="chapter-item "><a href="../../dc/measurements/distance_traveled.html"><strong aria-hidden="true">6.4.</strong> Distance traveled</a></li><li class="chapter-item "><a href="../../dc/measurements/ip_camera.html"><strong aria-hidden="true">6.5.</strong> IP Camera</a></li><li class="chapter-item "><a href="../../dc/measurements/map.html"><strong aria-hidden="true">6.6.</strong> Map</a></li><li class="chapter-item "><a href="../../dc/measurements/memory.html"><strong aria-hidden="true">6.7.</strong> Memory</a></li><li class="chapter-item "><a href="../../dc/measurements/network.html"><strong aria-hidden="true">6.8.</strong> Network</a></li><li class="chapter-item "><a href="../../dc/measurements/os.html"><strong aria-hidden="true">6.9.</strong> OS</a></li><li class="chapter-item "><a href="../../dc/measurements/permissions.html"><strong aria-hidden="true">6.10.</strong> Permissions</a></li><li class="chapter-item "><a href="../../dc/measurements/position.html"><strong aria-hidden="true">6.11.</strong> Position</a></li><li class="chapter-item "><a href="../../dc/measurements/speed.html"><strong aria-hidden="true">6.12.</strong> Speed</a></li><li class="chapter-item "><a href="../../dc/measurements/storage.html"><strong aria-hidden="true">6.13.</strong> Storage</a></li><li class="chapter-item "><a href="../../dc/measurements/string_stamped.html"><strong aria-hidden="true">6.14.</strong> String stamped</a></li><li class="chapter-item "><a href="../../dc/measurements/tcp_health.html"><strong aria-hidden="true">6.15.</strong> TCP Health</a></li><li class="chapter-item "><a href="../../dc/measurements/uptime.html"><strong aria-hidden="true">6.16.</strong> Uptime</a></li></ol></li><li class="chapter-item "><a href="../../dc/conditions.html"><strong aria-hidden="true">7.</strong> Conditions</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../dc/conditions/bool_equal.html"><strong aria-hidden="true">7.1.</strong> Bool equal</a></li><li class="chapter-item "><a href="../../dc/conditions/double_equal.html"><strong aria-hidden="true">7.2.</strong> Double equal</a></li><li class="chapter-item "><a href="../../dc/conditions/double_inferior.html"><strong aria-hidden="true">7.3.</strong> Double inferior</a></li><li class="chapter-item "><a href="../../dc/conditions/double_superior.html"><strong aria-hidden="true">7.4.</strong> Double superior</a></li><li class="chapter-item "><a href="../../dc/conditions/exist.html"><strong aria-hidden="true">7.5.</strong> Exist</a></li><li class="chapter-item "><a href="../../dc/conditions/integer_equal.html"><strong aria-hidden="true">7.6.</strong> Integer equal</a></li><li class="chapter-item "><a href="../../dc/conditions/integer_inferior.html"><strong aria-hidden="true">7.7.</strong> Integer inferior</a></li><li class="chapter-item "><a href="../../dc/conditions/integer_superior.html"><strong aria-hidden="true">7.8.</strong> Integer superior</a></li><li class="chapter-item "><a href="../../dc/conditions/list_bool_equal.html"><strong aria-hidden="true">7.9.</strong> List bool equal</a></li><li class="chapter-item "><a href="../../dc/conditions/list_double_equal.html"><strong aria-hidden="true">7.10.</strong> List double equal</a></li><li class="chapter-item "><a href="../../dc/conditions/list_integer_equal.html"><strong aria-hidden="true">7.11.</strong> List integer equal</a></li><li class="chapter-item "><a href="../../dc/conditions/list_string_equal.html"><strong aria-hidden="true">7.12.</strong> List string equal</a></li><li class="chapter-item "><a href="../../dc/conditions/moving.html"><strong aria-hidden="true">7.13.</strong> Moving</a></li><li class="chapter-item "><a href="../../dc/conditions/same_as_previous.html"><strong aria-hidden="true">7.14.</strong> Same as previous</a></li><li class="chapter-item "><a href="../../dc/conditions/string_match.html"><strong aria-hidden="true">7.15.</strong> String match</a></li></ol></li><li class="chapter-item "><a href="../../dc/data_validation.html"><strong aria-hidden="true">8.</strong> Data validation</a></li><li class="chapter-item "><a href="../../dc/groups.html"><strong aria-hidden="true">9.</strong> Groups</a></li><li class="chapter-item "><a href="../../dc/destinations.html"><strong aria-hidden="true">10.</strong> Destinations</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../dc/destinations/flb_kinesis_data_streams.html"><strong aria-hidden="true">10.1.</strong> Fluent Bit AWS Kinesis Data Streams</a></li><li class="chapter-item "><a href="../../dc/destinations/flb_s3.html"><strong aria-hidden="true">10.2.</strong> Fluent Bit AWS S3</a></li><li class="chapter-item "><a href="../../dc/destinations/flb_file.html"><strong aria-hidden="true">10.3.</strong> Fluent Bit File</a></li><li class="chapter-item "><a href="../../dc/destinations/flb_files_metrics.html"><strong aria-hidden="true">10.4.</strong> Fluent Bit Files metrics</a></li><li class="chapter-item "><a href="../../dc/destinations/flb_http.html"><strong aria-hidden="true">10.5.</strong> Fluent Bit HTTP</a></li><li class="chapter-item "><a href="../../dc/destinations/flb_minio.html"><strong aria-hidden="true">10.6.</strong> Fluent Bit Minio</a></li><li class="chapter-item "><a href="../../dc/destinations/flb_null.html"><strong aria-hidden="true">10.7.</strong> Fluent Bit NULL</a></li><li class="chapter-item "><a href="../../dc/destinations/flb_pgsql.html"><strong aria-hidden="true">10.8.</strong> Fluent Bit PostgreSQL</a></li><li class="chapter-item "><a href="../../dc/destinations/flb_slack.html"><strong aria-hidden="true">10.9.</strong> Fluent Bit Slack</a></li><li class="chapter-item "><a href="../../dc/destinations/flb_stdout.html"><strong aria-hidden="true">10.10.</strong> Fluent Bit Stdout</a></li><li class="chapter-item "><a href="../../dc/destinations/rcl.html"><strong aria-hidden="true">10.11.</strong> RCL</a></li></ol></li><li class="chapter-item "><a href="../../dc/configuration_examples.html"><strong aria-hidden="true">11.</strong> Configuration examples</a></li><li class="chapter-item "><a href="../../dc/infrastructure_setup.html"><strong aria-hidden="true">12.</strong> Infrastructure setup</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../dc/infrastructure_setup/minio.html"><strong aria-hidden="true">12.1.</strong> MinIO</a></li><li class="chapter-item "><a href="../../dc/infrastructure_setup/postgresql.html"><strong aria-hidden="true">12.2.</strong> PostgreSQL</a></li><li class="chapter-item "><a href="../../dc/infrastructure_setup/ip_camera.html"><strong aria-hidden="true">12.3.</strong> Ip camera</a></li></ol></li><li class="chapter-item "><a href="../../dc/cli.html"><strong aria-hidden="true">13.</strong> CLI tools</a></li><li class="chapter-item "><a href="../../dc/requirements.html"><strong aria-hidden="true">14.</strong> Requirements</a></li><li class="chapter-item "><a href="../../dc/future_work.html"><strong aria-hidden="true">15.</strong> Future work and Roadmap</a></li><li class="chapter-item "><a href="../../dc/contributing.html"><strong aria-hidden="true">16.</strong> Contributing</a></li><li class="chapter-item "><a href="../../dc/faq.html"><strong aria-hidden="true">17.</strong> FAQ</a></li><li class="chapter-item "><a href="../../dc/about_contact.html"><strong aria-hidden="true">18.</strong> About and Contact</a></li></ol>
                <footer id="nav-separator"></footer>
                <a style="margin-right: 10px;" href="https://github.com/minipada/ros2_data_collection" target="_blank"><i  class="lni lni-github-original lni-32"></i></a>
                <a style="margin-right: 10px;" href="mailto:d.bensoussan@proton.me" target="_blank"><i  class="lni lni-envelope lni-32"></i></a>
                <div>Under <a target="_blank" style="color: var(--sidebar-active);"
                    href="https://tldrlegal.com/license/mozilla-public-license-2.0-(mpl-2)">MPL-2.0</a>
                license</a>
                </div>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Data Collection for ROS 2</h1>

                    <div class="right-buttons">
                        <a href="../../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/minipada/ros2_data_collection" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>
                        <a href="https://github.com/minipada/ros2_data_collection/edit/humble/doc/src/dc/demos/uptime_stdout.md" title="Suggest an edit" aria-label="Suggest an edit">
                            <i id="git-edit-button" class="fa fa-edit"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="uptime-to-stdout"><a class="header" href="#uptime-to-stdout">Uptime to stdout</a></h1>
<p>This is the most minimal example to run DC, it collects the system uptime every 5 seconds and sends it to Stdout.</p>
<p>Let's run it:</p>
<pre><code class="language-bash">$ ros2 launch dc_demos uptime_stdout.launch.py
</code></pre>
<p>At the end, the data is displayed:</p>
<pre><code>[component_container_isolated-1] [{&quot;date&quot;:1677668906.745817,&quot;time&quot;:92395,&quot;id&quot;:&quot;be781e5ffb1e7ee4f817fe7b63e92c32&quot;,&quot;robot_name&quot;:&quot;C3PO&quot;,&quot;run_id&quot;:&quot;218&quot;}]
[component_container_isolated-1] [{&quot;date&quot;:1677668911.700309,&quot;time&quot;:92400,&quot;id&quot;:&quot;be781e5ffb1e7ee4f817fe7b63e92c32&quot;,&quot;robot_name&quot;:&quot;C3PO&quot;,&quot;run_id&quot;:&quot;218&quot;}]
[component_container_isolated-1] [{&quot;date&quot;:1677668916.70031,&quot;time&quot;:92405,&quot;id&quot;:&quot;be781e5ffb1e7ee4f817fe7b63e92c32&quot;,&quot;robot_name&quot;:&quot;C3PO&quot;,&quot;run_id&quot;:&quot;218&quot;}]
[component_container_isolated-1] [{&quot;date&quot;:1677668921.700388,&quot;time&quot;:92410,&quot;id&quot;:&quot;be781e5ffb1e7ee4f817fe7b63e92c32&quot;,&quot;robot_name&quot;:&quot;C3PO&quot;,&quot;run_id&quot;:&quot;218&quot;}]
[component_container_isolated-1] [{&quot;date&quot;:1677668926.700422,&quot;time&quot;:92415,&quot;id&quot;:&quot;be781e5ffb1e7ee4f817fe7b63e92c32&quot;,&quot;robot_name&quot;:&quot;C3PO&quot;,&quot;run_id&quot;:&quot;218&quot;}]
</code></pre>
<p>This launchfile is a wrapper of <a href="https://github.com/Minipada/ros2_data_collection/blob/humble/dc_bringup/launch/dc_bringup.launch.py">dc_bringup/launch/bringup.launch.py</a> which loads a <a href="https://github.com/Minipada/ros2_data_collection/blob/humble/dc_demos/params/uptime_stdout.yaml">custom yaml configuration</a></p>
<h2 id="configuration"><a class="header" href="#configuration">Configuration</a></h2>
<h3 id="measurement"><a class="header" href="#measurement">Measurement</a></h3>
<pre><code class="language-yaml">measurement_server:
  ros__parameters:
    measurement_plugins: [&quot;uptime&quot;]
    uptime:
      plugin: &quot;dc_measurements/Uptime&quot;
      topic_output: &quot;/dc/measurement/uptime&quot;
      polling_interval: 5000
      enable_validator: true
      debug: true
      tags: [&quot;flb_stdout&quot;]
      init_collect: true
</code></pre>
<p><strong>measurement_plugins (Mandatory)</strong>: List all the plugins to enable. This is a custom string that is equal to the measurement plugin dictionary present in the same level. If not listed, will not be loaded.</p>
<p><strong>uptime.plugin (Mandatory)</strong>: Name of the plugin, if you are not sure which plugin is available, <a href="../cli.html">use the CLI tool</a> to list them</p>
<p><strong>uptime.tags (Mandatory)</strong>: This is used by Fluent Bit, to match inputs and outputs. More <a href="../concepts.html#tags">here</a></p>
<p><strong>uptime.polling_interval (Optional)</strong>: Interval to which data is collected in milliseconds</p>
<p><strong>uptime.enable_validator (Optional)</strong>: Will validate the data against a JSON schema. This file is located in the <a href="https://github.com/Minipada/ros2_data_collection/tree/humble/dc_measurements/plugins/measurements/json">dc_measurements package</a>. You can provide your own using the <code>json_schema_path</code> parameter, which we will explore later on</p>
<p><strong>uptime.debug (Optional)</strong>: More verbose output</p>
<p><strong>uptime.init_collect (Optional)</strong>: Collect when the node starts instead of waiting for the polling_interval time to pass</p>
<p>This will collect the uptime every 5 seconds (including when the node starts), will forward it to the <em>flb_stdout</em> destination.</p>
<div id="admonition-info" class="admonition info">
<div class="admonition-title">
<p>Info</p>
<p><a class="admonition-anchor-link" href="#admonition-info"></a></p>
</div>
<div>
<p>Note that this configuration alone, sent to Fluent Bit will not display the JSON on stdout since it requires the destination_server configuration</p>
</div>
</div>
<p>Find the complete measurements documentation <a href="../measurements.html">here</a></p>
<h3 id="destination"><a class="header" href="#destination">Destination</a></h3>
<pre><code class="language-yaml">destination_server:
  ros__parameters:
    flb:
      flush: 1
      flb_grace: 1
      log_level: &quot;info&quot;
      storage_path: &quot;/var/log/flb-storage/&quot;
      storage_sync: &quot;full&quot;
      storage_checksum: &quot;off&quot;
      storage_backlog_mem_limit: &quot;1M&quot;
      scheduler_cap: 200
      scheduler_base: 5
      http_server: true
      http_listen: &quot;0.0.0.0&quot;
      http_port: 2020
      in_storage_type: &quot;filesystem&quot;
      in_storage_pause_on_chunks_overlimit: &quot;off&quot;
    destination_plugins: [&quot;flb_stdout&quot;]
    custom_str_params_list: [&quot;robot_name&quot;, &quot;id&quot;]
    custom_str_params:
      robot_name:
        name: robot_name
        value: C3PO
      id:
        name: id
        value_from_file: /etc/machine-id
    run_id:
      enabled: true
      counter: true
      counter_path: &quot;$HOME/run_id&quot;
      uuid: false
    flb_stdout:
      plugin: &quot;dc_destinations/FlbStdout&quot;
      inputs: [&quot;/dc/measurement/uptime&quot;]
      time_format: &quot;double&quot;
      time_key: &quot;date&quot;
      debug: false
</code></pre>
<h4 id="destinations"><a class="header" href="#destinations">Destinations</a></h4>
<p>Let's analyze piece by piece. First, we select the plugin to enable, create its section containing the plugin name and the topic to subscribe to. We need the topic list because in the background, the ROS 2 Fluent Bit plugin subscribes to each topic.</p>
<p><strong>destination_plugins (Mandatory)</strong>: List all the plugins to enable. This is a custom string that is equal to the destination plugin dictionary present in the same level. If not listed, will not be loaded.</p>
<p><strong>flb_stdout.plugin (Mandatory)</strong>: Plugin to load</p>
<p><strong>flb_stdout.inputs (Mandatory)</strong>: Topics to which to listen to get the data</p>
<p><strong>flb_stdout.time_format (Optional)</strong>: Format the data will be printed</p>
<p><strong>flb_stdout.time_key (Optional)</strong>: Dictionary key from which date will be taken from</p>
<p><strong>flb_stdout.debug (Optional)</strong>: Verbose output</p>
<h4 id="fluent-bit"><a class="header" href="#fluent-bit">Fluent Bit</a></h4>
<p>Then, we configure Fluent Bit. This is not necessary but it is easy to do by using the ros parameters provided by the node.</p>
<p><strong>flb.flush (Optional)</strong>: Interval to flush output (seconds)</p>
<p><strong>flb.flb_grace (Optional)</strong>: Wait time (seconds) on exit</p>
<p><strong>flb.log_level (Optional)</strong>: Diagnostic level (error/warning/info/debug/trace)</p>
<p><strong>flb.storage_path (Optional)</strong>: Set an optional location in the file system to store streams and chunks of data. If this parameter is not set, Input plugins can only use in-memory buffering.</p>
<p><strong>flb.storage_sync (Optional)</strong>: Configure the synchronization mode used to store the data into the file system. It can take the values normal or full.</p>
<p><strong>flb.storage_checksum (Optional)</strong>: Enable the data integrity check when writing and reading data from the filesystem. The storage layer uses the CRC32 algorithm.</p>
<p><strong>flb.storage_backlog_mem_limit (Optional)</strong>: If storage.path is set, Fluent Bit will look for data chunks that were not delivered and are still in the storage layer, these are called backlog data. This option configure a hint of maximum value of memory to use when processing these records.</p>
<p><strong>flb.scheduler_cap (Optional)</strong>: Set a maximum retry time in seconds. The property is supported from v1.8.7.</p>
<p><strong>flb.scheduler_base (Optional)</strong>: Set a base of exponential backoff. The property is supported from v1.8.7.</p>
<p><strong>flb.http_server (Optional)</strong>: If true enable statistics HTTP server</p>
<p><strong>flb.http_listen (Optional)</strong>: Address to listen (e.g. 0.0.0.0)</p>
<p><strong>flb.http_port (Optional)</strong>: Port to listen (e.g. 8888)</p>
<p><strong>flb.in_storage_type (Optional)</strong>: Specifies the buffering mechanism to use. It can be memory or filesystem.</p>
<p><strong>flb.in_storage_pause_on_chunks_overlimit (Optional)</strong>: Specifies if file storage is to be paused when reaching the chunk limit.</p>
<h4 id="inject-custom-data-for-each-record"><a class="header" href="#inject-custom-data-for-each-record">Inject custom data for each record</a></h4>
<p>Here, we want to append some content in every record: the robot name and its ID. While the robot name comes from a fixed variable in the parameter file, the id comes from the machine-id file.</p>
<p><strong>custom_str_params_list (Optional)</strong>: Look for those keys in this configuration to add them as keys and values in each record.</p>
<p><strong>custom_str_params.robot_name (Optional)</strong>: This parameter is loaded since it is mentioned in custom_str_params_list</p>
<p><strong>custom_str_params.robot_name.name (Optional)</strong>: Key in the dictionary to add</p>
<p><strong>custom_str_params.robot_name.value (Optional)</strong>: Value associated to the key in the dictionary to add</p>
<p><strong>custom_str_params.id.name (Optional)</strong>: Key in the dictionary to add</p>
<p><strong>custom_str_params.id.value_from_file (Optional)</strong>: Value associated to the key in the dictionary to add taken from the content of a file</p>
<h4 id="inject-run-id-at-each-record"><a class="header" href="#inject-run-id-at-each-record">Inject run id at each record</a></h4>
<p>Finally, we set the run id. This is used later on when fetching data for a run. It can come from a counter which is incremented at each start of the node or from a random UUID generated. The counter mechanism writes and read on a file on the system (take care of not deleting it), you can set its path as a parameter.</p>
<p><strong>run_id.enabled (Optional)</strong>: Identify which run the robot is. A new one is generated at every start of the node. Uses either a counter that increment at each restart of the node or UUID</p>
<p><strong>run_id.counter (Optional)</strong>: Enable counter for the run_id</p>
<p><strong>run_id.counter_path (Optional)</strong>: Path to store the last run. It is expanded with environment variables id</p>
<p><strong>run_id.uuid (Optional)</strong>: Generate a new run ID by using a random UUID</p>
<p>Find the complete destinations documentation <a href="../destinations.html">here</a></p>
<h2 id="console-output"><a class="header" href="#console-output">Console output</a></h2>
<p>Now that the node started, let us see what's displayed in the console</p>
<pre><code>[component_container_isolated-1] [INFO] [1677668906.621492168] [dc_container]: Load Library: /root/ws/install/dc_measurements/lib/libmeasurement_server_core.so
[component_container_isolated-1] [INFO] [1677668906.634130562] [dc_container]: Found class: rclcpp_components::NodeFactoryTemplate&lt;measurement_server::MeasurementServer&gt;
[component_container_isolated-1] [INFO] [1677668906.634246977] [dc_container]: Instantiate class: rclcpp_components::NodeFactoryTemplate&lt;measurement_server::MeasurementServer&gt;
[component_container_isolated-1] [INFO] [1677668906.655803692] [measurement_server]:
	measurement_server lifecycle node launched.
	Waiting on external lifecycle transitions to activate
	See https://design.ros2.org/articles/node_lifecycle.html for more information.
[component_container_isolated-1] [INFO] [1677668906.670233932] [dc_container]: Load Library: /root/ws/install/dc_destinations/lib/libdestination_server_core.so
[component_container_isolated-1] [INFO] [1677668906.675826543] [dc_container]: Found class: rclcpp_components::NodeFactoryTemplate&lt;destination_server::DestinationServer&gt;
[component_container_isolated-1] [INFO] [1677668906.675864319] [dc_container]: Instantiate class: rclcpp_components::NodeFactoryTemplate&lt;destination_server::DestinationServer&gt;
[component_container_isolated-1] [INFO] [1677668906.680499515] [destination_server]:
[component_container_isolated-1] 	destination_server lifecycle node launched.
[component_container_isolated-1] 	Waiting on external lifecycle transitions to activate
[component_container_isolated-1] 	See https://design.ros2.org/articles/node_lifecycle.html for more information.
[INFO] [launch_ros.actions.load_composable_nodes]: Loaded node '/destination_server' in container 'dc_container'
[component_container_isolated-1] [INFO] [1677668906.684802172] [dc_container]: Load Library: /opt/ros/humble/lib/libnav2_lifecycle_manager_core.so
[component_container_isolated-1] [INFO] [1677668906.685487672] [dc_container]: Found class: rclcpp_components::NodeFactoryTemplate&lt;nav2_lifecycle_manager::LifecycleManager&gt;
[component_container_isolated-1] [INFO] [1677668906.685510016] [dc_container]: Instantiate class: rclcpp_components::NodeFactoryTemplate&lt;nav2_lifecycle_manager::LifecycleManager&gt;
[component_container_isolated-1] [INFO] [1677668906.691075881] [lifecycle_manager_navigation]: Creating
[INFO] [launch_ros.actions.load_composable_nodes]: Loaded node '/lifecycle_manager_navigation' in container 'dc_container'
[component_container_isolated-1] [INFO] [1677668906.692954854] [lifecycle_manager_navigation]: Creating and initializing lifecycle service clients
[component_container_isolated-1] [INFO] [1677668906.695025050] [lifecycle_manager_navigation]: Starting managed nodes bringup...
</code></pre>
<p>Measurement server and destination server are starting in the Lifecycle, you can read more about it <a href="../concepts.html#lifecycle-nodes-and-bond">here</a></p>
<p>Afterward, the measurement_server starts:</p>
<pre><code>[component_container_isolated-1] [INFO] [1677668906.695056624] [lifecycle_manager_navigation]: Configuring measurement_server
[component_container_isolated-1] [INFO] [1677668906.695181755] [measurement_server]: Configuring
[component_container_isolated-1] [INFO] [1677668906.698019687] [measurement_server]: Creating measurement plugin uptime: Type dc_measurements/Uptime, Group key: uptime, Polling interval: 5000, Debug: 1, Validator enabled: 1, Schema path: , Tags: [flb_stdout], Init collect: 1, Init Max measurement: 0, Include measurement name: 0, Include measurement plugin name: 0, Remote keys: , Remote prefixes: , Include measurement plugin name: 0, Max measurement on condition: 0, If all condition: , If any condition: , If none condition:
[component_container_isolated-1] [INFO] [1677668906.698932685] [measurement_server]: Configuring uptime
[component_container_isolated-1] [INFO] [1677668906.699937310] [measurement_server]: Done configuring uptime
[component_container_isolated-1] [INFO] [1677668906.700162355] [measurement_server]: Looking for schema at /root/ws/install/dc_measurements/share/dc_measurements/plugins/measurements/json/uptime.json
[component_container_isolated-1] [INFO] [1677668906.700192161] [measurement_server]: schema: {&quot;$schema&quot;:&quot;http://json-schema.org/draft-07/schema#&quot;,&quot;description&quot;:&quot;Time the system has been up&quot;,&quot;properties&quot;:{&quot;time&quot;:{&quot;description&quot;:&quot;Time the system has been up&quot;,&quot;minimum&quot;:0,&quot;type&quot;:&quot;integer&quot;}},&quot;title&quot;:&quot;Uptime&quot;,&quot;type&quot;:&quot;object&quot;}
</code></pre>
<p>Plugins are loaded one by one (here only one is, the uptime one) and configured. The configuration for each is displayed and the validation schema is also loaded and its path printed.</p>
<p>Then, the destination_server starts:</p>
<pre><code>[component_container_isolated-1] [INFO] [1677668906.700528260] [lifecycle_manager_navigation]: Configuring destination_server
[component_container_isolated-1] [INFO] [1677668906.700620104] [destination_server]: Configuring
[component_container_isolated-1] [INFO] [1677668906.701246047] [destination_server]: Fluent Bit service initialized
[component_container_isolated-1] [INFO] [1677668906.701470896] [destination_server]: Creating destination plugin flb_stdout: Type dc_destinations/FlbStdout, Debug: 0, Time format: double. Time key: date
[component_container_isolated-1] [INFO] [1677668906.702670279] [destination_server]: Configuring Flb plugin flb_stdout
[component_container_isolated-1] [INFO] [1677668906.702871127] [destination_server]: Loaded lua filter. Match=ros2, code=function concatenate(tag, timestamp, record) if (type(record[&quot;tags&quot;]) == &quot;table&quot;) then record[&quot;tags&quot;] = table.concat(record[&quot;tags&quot;], &quot;,&quot;) end  return 2, timestamp, record end
[component_container_isolated-1] [INFO] [1677668906.702912686] [destination_server]: Loaded rewrite_tag filter. Match=ros2, Rule=$tags .*(flb_stdout).* flb_stdout true
[component_container_isolated-1] [INFO] [1677668906.703021628] [destination_server]: Done configuring Flb plugin flb_stdout
[component_container_isolated-1] [INFO] [1677668906.703049312] [destination_server]: Loading input ros2 shared library /root/ws/install/fluent_bit_plugins/lib/flb-in_ros2.so...
[component_container_isolated-1] [INFO] [1677668906.703818806] [destination_server]: Loaded input ros2 shared library /root/ws/install/fluent_bit_plugins/lib/flb-in_ros2.so
[component_container_isolated-1] [INFO] [1677668906.703899346] [destination_server]: Flb ros2 plugin initialized. ret=0
[component_container_isolated-1] [INFO] [1677668906.703908977] [destination_server]: Starting Flb engine...
[component_container_isolated-1] [2023/03/01 11:08:26] [ info] [fluent bit] version=2.0.7, commit=1ab360f79c, pid=31126
[component_container_isolated-1] [2023/03/01 11:08:26] [ info] [storage] ver=1.3.0, type=memory+filesystem, sync=full, checksum=off, max_chunks_up=128
[component_container_isolated-1] [2023/03/01 11:08:26] [ info] [storage] backlog input plugin: storage_backlog.1
[component_container_isolated-1] [2023/03/01 11:08:26] [ info] [cmetrics] version=0.5.7
[component_container_isolated-1] [2023/03/01 11:08:26] [ info] [ctraces ] version=0.2.5
[component_container_isolated-1] [2023/03/01 11:08:26] [ info] [input:ros2:ros2.0] initializing
[component_container_isolated-1] [2023/03/01 11:08:26] [ info] [input:ros2:ros2.0] storage_strategy='filesystem' (memory + filesystem)
[component_container_isolated-1] [2023/03/01 11:08:26] [ info] Started node fluentbit_rclc
[component_container_isolated-1] [2023/03/01 11:08:26] [ info] Created subscriber /dc/measurement/uptime
[component_container_isolated-1] [2023/03/01 11:08:26] [ info] [input:storage_backlog:storage_backlog.1] initializing
[component_container_isolated-1] [2023/03/01 11:08:26] [ info] [input:storage_backlog:storage_backlog.1] storage_strategy='memory' (memory only)
[component_container_isolated-1] [2023/03/01 11:08:26] [ info] [input:storage_backlog:storage_backlog.1] queue memory limit: 976.6K
[component_container_isolated-1] [2023/03/01 11:08:26] [ info] [input:emitter:emitter_for_rewrite_tag.2] initializing
[component_container_isolated-1] [2023/03/01 11:08:26] [ info] [input:emitter:emitter_for_rewrite_tag.2] storage_strategy='filesystem' (memory + filesystem)
[component_container_isolated-1] [2023/03/01 11:08:26] [ info] [output:stdout:stdout.0] worker #0 started
[component_container_isolated-1] [2023/03/01 11:08:26] [ info] [http_server] listen iface=0.0.0.0 tcp_port=2020
[component_container_isolated-1] [2023/03/01 11:08:26] [ info] [sp] stream processor started
[component_container_isolated-1] [INFO] [1677668906.744577163] [destination_server]: Started Flb engine
</code></pre>
<p>It starts the <a href="../destinations/flb_stdout.html">FlbStdout destination plugin</a>, filters used internally by Fluent to edit Timestamps and tags. It then loads the ROS 2 Fluent Bit shared library and initialize it with the topics we provided as parameter.</p>
<p>Afterward, Fluent Bit starts, it prints its version, storage strategy and buffer configuration and lists which plugins are loaded.</p>
<p>Then, the measurement and destination server nodes are activated:</p>
<pre><code>[component_container_isolated-1] [INFO] [1677668906.745180268] [lifecycle_manager_navigation]: Activating measurement_server
[component_container_isolated-1] [INFO] [1677668906.745462265] [measurement_server]: Activating
[component_container_isolated-1] [INFO] [1677668906.745558665] [measurement_server]: Activating uptime
[component_container_isolated-1] [INFO] [1677668906.746014639] [measurement_server]: Creating bond (measurement_server) to lifecycle manager.
[component_container_isolated-1] [INFO] [1677668906.853199899] [lifecycle_manager_navigation]: Server measurement_server connected with bond.
[component_container_isolated-1] [INFO] [1677668906.853316226] [lifecycle_manager_navigation]: Activating destination_server
[component_container_isolated-1] [INFO] [1677668906.853620571] [destination_server]: Activating
[component_container_isolated-1] [INFO] [1677668906.853722659] [destination_server]: Activating flb_stdout
[component_container_isolated-1] [INFO] [1677668906.853796078] [destination_server]: Creating bond (destination_server) to lifecycle manager.
[component_container_isolated-1] [INFO] [1677668906.961666207] [lifecycle_manager_navigation]: Server destination_server connected with bond.
[component_container_isolated-1] [INFO] [1677668906.961777773] [lifecycle_manager_navigation]: Managed nodes are active
[component_container_isolated-1] [INFO] [1677668906.961820078] [lifecycle_manager_navigation]: Creating bond timer...
</code></pre>
<p>Finally, we see the data:</p>
<pre><code>[component_container_isolated-1] [{&quot;date&quot;:1677668906.745817,&quot;time&quot;:92395,&quot;id&quot;:&quot;be781e5ffb1e7ee4f817fe7b63e92c32&quot;,&quot;robot_name&quot;:&quot;C3PO&quot;,&quot;run_id&quot;:&quot;218&quot;}]
[component_container_isolated-1] [{&quot;date&quot;:1677668911.700309,&quot;time&quot;:92400,&quot;id&quot;:&quot;be781e5ffb1e7ee4f817fe7b63e92c32&quot;,&quot;robot_name&quot;:&quot;C3PO&quot;,&quot;run_id&quot;:&quot;218&quot;}]
[component_container_isolated-1] [{&quot;date&quot;:1677668916.70031,&quot;time&quot;:92405,&quot;id&quot;:&quot;be781e5ffb1e7ee4f817fe7b63e92c32&quot;,&quot;robot_name&quot;:&quot;C3PO&quot;,&quot;run_id&quot;:&quot;218&quot;}]
[component_container_isolated-1] [{&quot;date&quot;:1677668921.700388,&quot;time&quot;:92410,&quot;id&quot;:&quot;be781e5ffb1e7ee4f817fe7b63e92c32&quot;,&quot;robot_name&quot;:&quot;C3PO&quot;,&quot;run_id&quot;:&quot;218&quot;}]
[component_container_isolated-1] [{&quot;date&quot;:1677668926.700422,&quot;time&quot;:92415,&quot;id&quot;:&quot;be781e5ffb1e7ee4f817fe7b63e92c32&quot;,&quot;robot_name&quot;:&quot;C3PO&quot;,&quot;run_id&quot;:&quot;218&quot;}]
</code></pre>
<p>So...what happened?</p>
<ol>
<li>The measurement plugin starts publishing data to /dc/measurement/uptime, which contains the JSON, tags and timestamp of the message</li>
<li>Run ID and robot_name is appended in the JSON</li>
<li>The ROS 2 Fluent Bit plugin, which subscribes to this topic, receive the data and pass it on to Fluent Bit</li>
<li>Fluent Bit receives it, applies the timestamp filter (which modifies the timestamp to the desired format)</li>
<li>Fluent Bit applies changes the tag with another filter. This tag is used to match to the destination afterward.</li>
<li>Data is flushed</li>
<li>The Fluent Bit stdout output plugin receives the data because tags match (the flb_stdout tag is used) and forwards it to Stdout</li>
</ol>
<footer id="open-on-gh">Found a bug? <a href="https://github.com/minipada/ros2_data_collection/edit/main/doc/src/dc/demos/uptime_stdout.md">Edit this page on GitHub.</a></footer>
                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../../dc/demos.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next" href="../../dc/demos/memory_uptime_stdout.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../../dc/demos.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next" href="../../dc/demos/memory_uptime_stdout.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>



        <script>
            window.playground_line_numbers = true;
        </script>

        <script>
            window.playground_copyable = true;
        </script>

        <script src="../../ace.js"></script>
        <script src="../../editor.js"></script>
        <script src="../../mode-rust.js"></script>
        <script src="../../theme-dawn.js"></script>
        <script src="../../theme-tomorrow_night.js"></script>

        <script src="../../elasticlunr.min.js"></script>
        <script src="../../mark.min.js"></script>
        <script src="../../searcher.js"></script>

        <script src="../../clipboard.min.js"></script>
        <script src="../../highlight.js"></script>
        <script src="../../book.js"></script>

        <!-- Custom JS scripts -->
        <script src="../../js/mermaid.js"></script>
        <script src="../../js/mermaid-init.js"></script>
        <script src="../../js/theme.js"></script>


    </body>
</html>
