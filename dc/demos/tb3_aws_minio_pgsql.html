<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js navy">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Turtlebot3 AWS Warehouse MinIO PostgreSQL - Data Collection for ROS 2</title>


        <!-- Custom HTML head -->
        
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="../../favicon.svg">
        <link rel="shortcut icon" href="../../favicon.png">
        <link rel="stylesheet" href="../../css/variables.css">
        <link rel="stylesheet" href="../../css/general.css">
        <link rel="stylesheet" href="../../css/chrome.css">
        <link rel="stylesheet" href="../../css/lineicon.css">
        <link rel="stylesheet" href="../../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../../highlight.css">
        <link rel="stylesheet" href="../../tomorrow-night.css">
        <link rel="stylesheet" href="../../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="../../open-in.css">
        <link rel="stylesheet" href="../.././css/mdbook-admonish.css">
        <link rel="stylesheet" href="../../css/logo.css">
        <link rel="stylesheet" href="../../css/lineicon.css">
        <link rel="stylesheet" href="../../css/theme.css">

        <!-- MathJax -->
        <script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

        <!-- Hotjar -->
        <script>
            if (window.location.href.startsWith("https://minipada.github.io/ros2_data_collection")) {
            (function(h,o,t,j,a,r){
                h.hj=h.hj||function(){(h.hj.q=h.hj.q||[]).push(arguments)};
                h._hjSettings={hjid:3435761,hjsv:6};
                a=o.getElementsByTagName('head')[0];
                r=o.createElement('script');r.async=1;
                r.src=t+h._hjSettings.hjid+j+h._hjSettings.hjsv;
                a.appendChild(r);
            })(window,document,'https://static.hotjar.com/c/hotjar-','.js?sv=');
            }
        </script>
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "../../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "navy";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('navy')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <a href="/"><img id="logo-dc"></a>
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item "><a href="../../dc/introduction.html"><strong aria-hidden="true">1.</strong> Introduction</a></li><li class="chapter-item "><a href="../../dc/setup.html"><strong aria-hidden="true">2.</strong> Setup</a></li><li class="chapter-item "><a href="../../dc/concepts.html"><strong aria-hidden="true">3.</strong> Concepts</a></li><li class="chapter-item "><a href="../../dc/data_pipeline.html"><strong aria-hidden="true">4.</strong> Data Pipeline</a></li><li class="chapter-item "><a href="../../dc/measurements.html"><strong aria-hidden="true">5.</strong> Measurements</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../dc/measurements/camera.html"><strong aria-hidden="true">5.1.</strong> Camera</a></li><li class="chapter-item "><a href="../../dc/measurements/cmd_vel.html"><strong aria-hidden="true">5.2.</strong> Command velocity</a></li><li class="chapter-item "><a href="../../dc/measurements/cpu.html"><strong aria-hidden="true">5.3.</strong> CPU</a></li><li class="chapter-item "><a href="../../dc/measurements/distance_traveled.html"><strong aria-hidden="true">5.4.</strong> Distance traveled</a></li><li class="chapter-item "><a href="../../dc/measurements/ip_camera.html"><strong aria-hidden="true">5.5.</strong> IP Camera</a></li><li class="chapter-item "><a href="../../dc/measurements/map.html"><strong aria-hidden="true">5.6.</strong> Map</a></li><li class="chapter-item "><a href="../../dc/measurements/memory.html"><strong aria-hidden="true">5.7.</strong> Memory</a></li><li class="chapter-item "><a href="../../dc/measurements/network.html"><strong aria-hidden="true">5.8.</strong> Network</a></li><li class="chapter-item "><a href="../../dc/measurements/os.html"><strong aria-hidden="true">5.9.</strong> OS</a></li><li class="chapter-item "><a href="../../dc/measurements/permissions.html"><strong aria-hidden="true">5.10.</strong> Permissions</a></li><li class="chapter-item "><a href="../../dc/measurements/position.html"><strong aria-hidden="true">5.11.</strong> Position</a></li><li class="chapter-item "><a href="../../dc/measurements/speed.html"><strong aria-hidden="true">5.12.</strong> Speed</a></li><li class="chapter-item "><a href="../../dc/measurements/storage.html"><strong aria-hidden="true">5.13.</strong> Storage</a></li><li class="chapter-item "><a href="../../dc/measurements/string_stamped.html"><strong aria-hidden="true">5.14.</strong> String stamped</a></li><li class="chapter-item "><a href="../../dc/measurements/tcp_health.html"><strong aria-hidden="true">5.15.</strong> TCP Health</a></li><li class="chapter-item "><a href="../../dc/measurements/uptime.html"><strong aria-hidden="true">5.16.</strong> Uptime</a></li></ol></li><li class="chapter-item "><a href="../../dc/conditions.html"><strong aria-hidden="true">6.</strong> Conditions</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../dc/conditions/bool_equal.html"><strong aria-hidden="true">6.1.</strong> Bool equal</a></li><li class="chapter-item "><a href="../../dc/conditions/double_equal.html"><strong aria-hidden="true">6.2.</strong> Double equal</a></li><li class="chapter-item "><a href="../../dc/conditions/double_inferior.html"><strong aria-hidden="true">6.3.</strong> Double inferior</a></li><li class="chapter-item "><a href="../../dc/conditions/double_superior.html"><strong aria-hidden="true">6.4.</strong> Double superior</a></li><li class="chapter-item "><a href="../../dc/conditions/exist.html"><strong aria-hidden="true">6.5.</strong> Exist</a></li><li class="chapter-item "><a href="../../dc/conditions/integer_equal.html"><strong aria-hidden="true">6.6.</strong> Integer equal</a></li><li class="chapter-item "><a href="../../dc/conditions/integer_inferior.html"><strong aria-hidden="true">6.7.</strong> Integer inferior</a></li><li class="chapter-item "><a href="../../dc/conditions/integer_superior.html"><strong aria-hidden="true">6.8.</strong> Integer superior</a></li><li class="chapter-item "><a href="../../dc/conditions/list_bool_equal.html"><strong aria-hidden="true">6.9.</strong> List bool equal</a></li><li class="chapter-item "><a href="../../dc/conditions/list_double_equal.html"><strong aria-hidden="true">6.10.</strong> List double equal</a></li><li class="chapter-item "><a href="../../dc/conditions/list_integer_equal.html"><strong aria-hidden="true">6.11.</strong> List integer equal</a></li><li class="chapter-item "><a href="../../dc/conditions/list_string_equal.html"><strong aria-hidden="true">6.12.</strong> List string equal</a></li><li class="chapter-item "><a href="../../dc/conditions/moving.html"><strong aria-hidden="true">6.13.</strong> Moving</a></li><li class="chapter-item "><a href="../../dc/conditions/same_as_previous.html"><strong aria-hidden="true">6.14.</strong> Same as previous</a></li><li class="chapter-item "><a href="../../dc/conditions/string_match.html"><strong aria-hidden="true">6.15.</strong> String match</a></li></ol></li><li class="chapter-item "><a href="../../dc/data_validation.html"><strong aria-hidden="true">7.</strong> Data validation</a></li><li class="chapter-item "><a href="../../dc/groups.html"><strong aria-hidden="true">8.</strong> Groups</a></li><li class="chapter-item "><a href="../../dc/destinations.html"><strong aria-hidden="true">9.</strong> Destinations</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../dc/destinations/flb_kinesis_data_streams.html"><strong aria-hidden="true">9.1.</strong> Fluent Bit AWS Kinesis Data Streams</a></li><li class="chapter-item "><a href="../../dc/destinations/flb_s3.html"><strong aria-hidden="true">9.2.</strong> Fluent Bit AWS S3</a></li><li class="chapter-item "><a href="../../dc/destinations/flb_file.html"><strong aria-hidden="true">9.3.</strong> Fluent Bit File</a></li><li class="chapter-item "><a href="../../dc/destinations/flb_files_metrics.html"><strong aria-hidden="true">9.4.</strong> Fluent Bit Files metrics</a></li><li class="chapter-item "><a href="../../dc/destinations/flb_http.html"><strong aria-hidden="true">9.5.</strong> Fluent Bit HTTP</a></li><li class="chapter-item "><a href="../../dc/destinations/flb_minio.html"><strong aria-hidden="true">9.6.</strong> Fluent Bit Minio</a></li><li class="chapter-item "><a href="../../dc/destinations/flb_null.html"><strong aria-hidden="true">9.7.</strong> Fluent Bit NULL</a></li><li class="chapter-item "><a href="../../dc/destinations/flb_pgsql.html"><strong aria-hidden="true">9.8.</strong> Fluent Bit PostgreSQL</a></li><li class="chapter-item "><a href="../../dc/destinations/flb_slack.html"><strong aria-hidden="true">9.9.</strong> Fluent Bit Slack</a></li><li class="chapter-item "><a href="../../dc/destinations/flb_stdout.html"><strong aria-hidden="true">9.10.</strong> Fluent Bit Stdout</a></li><li class="chapter-item "><a href="../../dc/destinations/rcl.html"><strong aria-hidden="true">9.11.</strong> RCL</a></li></ol></li><li class="chapter-item "><a href="../../dc/configuration_examples.html"><strong aria-hidden="true">10.</strong> Configuration examples</a></li><li class="chapter-item expanded "><a href="../../dc/demos.html"><strong aria-hidden="true">11.</strong> Demos</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../dc/demos/uptime_stdout.html"><strong aria-hidden="true">11.1.</strong> Uptime</a></li><li class="chapter-item "><a href="../../dc/demos/memory_uptime_stdout.html"><strong aria-hidden="true">11.2.</strong> Group memory and uptime</a></li><li class="chapter-item "><a href="../../dc/demos/tb3_stdout.html"><strong aria-hidden="true">11.3.</strong> Turtlebot3</a></li><li class="chapter-item expanded "><a href="../../dc/demos/tb3_aws_minio_pgsql.html" class="active"><strong aria-hidden="true">11.4.</strong> Turtlebot3 AWS Warehouse MinIO PostgreSQL</a></li><li class="chapter-item "><a href="../../dc/demos/qrcodes_minio_pgsql.html"><strong aria-hidden="true">11.5.</strong> QRcodes to PostgreSQL/MinIO</a></li><li class="chapter-item "><a href="../../dc/demos/custom_stdout.html"><strong aria-hidden="true">11.6.</strong> Custom plugin</a></li></ol></li><li class="chapter-item "><a href="../../dc/infrastructure_setup.html"><strong aria-hidden="true">12.</strong> Infrastructure setup</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../dc/infrastructure_setup/minio.html"><strong aria-hidden="true">12.1.</strong> MinIO</a></li><li class="chapter-item "><a href="../../dc/infrastructure_setup/postgresql.html"><strong aria-hidden="true">12.2.</strong> PostgreSQL</a></li><li class="chapter-item "><a href="../../dc/infrastructure_setup/ip_camera.html"><strong aria-hidden="true">12.3.</strong> Ip camera</a></li></ol></li><li class="chapter-item "><a href="../../dc/cli.html"><strong aria-hidden="true">13.</strong> CLI tools</a></li><li class="chapter-item "><a href="../../dc/requirements.html"><strong aria-hidden="true">14.</strong> Requirements</a></li><li class="chapter-item "><a href="../../dc/future_work.html"><strong aria-hidden="true">15.</strong> Future work and Roadmap</a></li><li class="chapter-item "><a href="../../dc/contributing.html"><strong aria-hidden="true">16.</strong> Contributing</a></li><li class="chapter-item "><a href="../../dc/faq.html"><strong aria-hidden="true">17.</strong> FAQ</a></li><li class="chapter-item "><a href="../../dc/about_contact.html"><strong aria-hidden="true">18.</strong> About and Contact</a></li></ol>
                <footer id="nav-separator"></footer>
                <a style="margin-right: 10px;" href="https://github.com/minipada/ros2_data_collection" target="_blank"><i  class="lni lni-github-original lni-32"></i></a>
                <a style="margin-right: 10px;" href="mailto:d.bensoussan@proton.me" target="_blank"><i  class="lni lni-envelope lni-32"></i></a>
                <div>Under <a target="_blank" style="color: var(--sidebar-active);"
                    href="https://tldrlegal.com/license/mozilla-public-license-2.0-(mpl-2)">MPL-2.0</a>
                license</a>
                </div>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Data Collection for ROS 2</h1>

                    <div class="right-buttons">
                        <a href="../../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/minipada/ros2_data_collection" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>
                        <a href="https://github.com/minipada/ros2_data_collection/edit/humble/doc/src/dc/demos/tb3_aws_minio_pgsql.md" title="Suggest an edit" aria-label="Suggest an edit">
                            <i id="git-edit-button" class="fa fa-edit"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="turtlebot3"><a class="header" href="#turtlebot3">Turtlebot3</a></h1>
<p>In this example, we add a robot and start collecting robot data to Stdout.</p>
<p>You will also need 3 terminal windows, to:</p>
<ol>
<li>Run the Nav2 turtlebot3 launchfile: it starts localization, navigation and RViz</li>
<li>Run navigation inspection demo</li>
<li>Run DC</li>
</ol>
<p>Using a different terminal window for DC helps reading its information.</p>
<h2 id="packages-in-the-workspace"><a class="header" href="#packages-in-the-workspace">Packages in the workspace</a></h2>
<p>In addition to the ros2_data_collection repo in your workspace, you will need to download the <a href="https://github.com/aws-robotics/aws-robomaker-small-warehouse-world/tree/ros2">aws warehouse package</a>:</p>
<pre><code class="language-bash">$ cd src
$ git clone https://github.com/aws-robotics/aws-robomaker-small-warehouse-world.git -b ros2
$ cd ..
$ colcon build
</code></pre>
<h2 id="setup-the-environment"><a class="header" href="#setup-the-environment">Setup the environment</a></h2>
<h3 id="python-dependencies"><a class="header" href="#python-dependencies">Python dependencies</a></h3>
<p>For this tutorial, we will need to install all dependencies:</p>
<pre><code class="language-bash">$ pip3 install -r requirements.txt -r requirements-dev.txt
</code></pre>
<h3 id="setup-infrastructure"><a class="header" href="#setup-infrastructure">Setup Infrastructure</a></h3>
<h4 id="minio"><a class="header" href="#minio">MinIO</a></h4>
<p>MinIO will be used as storage for images and other files. To start it, <a href="../infrastructure_setup/minio.html">follow the steps</a></p>
<p>Once you have your keys, edit the yaml configuration file at <a href="https://github.com/Minipada/ros2_data_collection/blob/humble/dc_demos/params/tb3_simulation_pgsql_minio.yaml">dc_demos/params/tb3_simulation_pgsql_minio.yaml</a> by editing all instances of:</p>
<ol>
<li>access_key_id</li>
<li>secret_access_key</li>
</ol>
<h4 id="postgresql"><a class="header" href="#postgresql">PostgreSQL</a></h4>
<p>PostgreSQL will be used as database storage for our JSON. Later on, backend engineers can make requests on those JSON based on measurement requested and time range. To start it, <a href="../infrastructure_setup/postgresql.html">follow the steps</a></p>
<p>The default yaml configuration file does not need change as it also uses default values.</p>
<h3 id="setup-simulation-environment"><a class="header" href="#setup-simulation-environment">Setup simulation environment</a></h3>
<p>In the terminal 1, source your environment, setup turtlebot configuration:</p>
<pre><code class="language-bash">$ source /opt/ros/humble/setup.bash
$ source install/setup.bash
$ export GAZEBO_MODEL_PATH=$GAZEBO_MODEL_PATH:/opt/ros/humble/share/turtlebot3_gazebo/models
$ export GAZEBO_RESOURCE_PATH=${PWD}/src/aws-robomaker-small-warehouse-world/
$ export TURTLEBOT3_MODEL=waffle
$ source /usr/share/gazebo/setup.bash
</code></pre>
<p>Verify the gazebo world can be loaded properly:</p>
<pre><code class="language-bash">$ gazebo /opt/ros/humble/share/aws_robomaker_small_warehouse_world/worlds/small_warehouse/small_warehouse.world
</code></pre>
<p>Gazebo will start with the warehouse environment. You can close it now.</p>
<div id="admonition-info" class="admonition info">
<div class="admonition-title">
<p>Info</p>
<p><a class="admonition-anchor-link" href="#admonition-info"></a></p>
</div>
<div>
<p>I believe requiring the source along with those export are needed because of <a href="https://github.com/aws-robotics/aws-robomaker-small-warehouse-world/issues/22">this issue</a></p>
</div>
</div>
<h2 id="terminal-1-start-navigation"><a class="header" href="#terminal-1-start-navigation">Terminal 1: Start Navigation</a></h2>
<p>Then, in the same terminal (1), start the Turtlebot launchfile:</p>
<pre><code class="language-bash">$ ros2 launch nav2_bringup tb3_simulation_launch.py \
    world:=/opt/ros/humble/share/aws_robomaker_small_warehouse_world/worlds/no_roof_small_warehouse/no_roof_small_warehouse.world \
    map:=/opt/ros/humble/share/aws_robomaker_small_warehouse_world/maps/005/map.yaml \
    headless:=False \
    x_pose:=3.45 \
    y_pose:=2.15 \
    yaw:=3.14
</code></pre>
<p>RViz and Gazebo will start: now you see the robot in Gazebo, and the map on RViz.</p>
<p><img src="../../images/demos-tb3_aws_minio_pgsql-rviz-1.png" alt="RViz" />
<img src="../../images/demos-tb3_aws_minio_pgsql-gz-1.png" alt="Gazebo" /></p>
<h2 id="terminal-2-start-dc"><a class="header" href="#terminal-2-start-dc">Terminal 2: Start DC</a></h2>
<p>Run colcon build to install the new configuration file:</p>
<pre><code class="language-bash">$ colcon build
</code></pre>
<p>Now, start the demo:</p>
<pre><code class="language-bash">$ ros2 launch dc_demos tb3_simulation_pgsql_minio.launch.py
</code></pre>
<p>The robot will start collecting data.</p>
<h2 id="terminal-3-start-autonomous-navigation"><a class="header" href="#terminal-3-start-autonomous-navigation">Terminal 3: Start autonomous navigation</a></h2>
<p>Execute</p>
<pre><code class="language-bash">$ ros2 run nav2_simple_commander demo_security
</code></pre>
<p>The robot will start moving and you will be able to see all visualizations activated in RViz:</p>
<p><img src="../../images/demos-tb3_aws_minio_pgsql-rviz-2.png" alt="RViz-moving" /></p>
<h2 id="visualize-the-data"><a class="header" href="#visualize-the-data">Visualize the data</a></h2>
<h3 id="in-the-database"><a class="header" href="#in-the-database">In the database</a></h3>
<p>Navigate to <a href="http://localhost:8080">localhost:8080</a></p>
<ol>
<li>Select <em>dc</em> database</li>
<li>Select <em>dc</em> table</li>
<li>Click on <em>Select data</em></li>
</ol>
<p>You will see rows filling the database. You can click on one to see its content:</p>
<p><img src="../../images/demos-tb3_aws_minio_pgsql-result-pgsql.gif" alt="Adminer-gif" /></p>
<h3 id="in-minio-file-storage"><a class="header" href="#in-minio-file-storage">In MinIO (file storage)</a></h3>
<p>Navigate to <a href="http://localhost:9001">localhost:9001</a></p>
<ol>
<li>Select <em>mybucket</em> bucket</li>
<li>Click until you reach camera or map</li>
<li>Continue until you reached a file, and click on preview (pgm can't be previewed)</li>
</ol>
<p>You will see rows filling the database. You can click on one to see its content:</p>
<p><img src="../../images/demos-tb3_aws_minio_pgsql-result-minio.gif" alt="Adminer-gif" /></p>
<h3 id="with-streamlit-dashboard"><a class="header" href="#with-streamlit-dashboard">With Streamlit dashboard</a></h3>
<p>A dashboard has been developed to help visualize the data collected.</p>
<div id="admonition-warning" class="admonition warning">
<div class="admonition-title">
<p>Warning</p>
<p><a class="admonition-anchor-link" href="#admonition-warning"></a></p>
</div>
<div>
<p>Make sure you have install python dependencies with pip!</p>
</div>
</div>
<p>Execute in a new terminal:</p>
<pre><code class="language-bash">$ cd src/ros2_data_collection/dc_demos/dc_demos/streamlit_dashboard/
# Replace by what was created at the start of this demo
$ export MINIO_ACCESS_KEY=&lt;YOUR_ACCESS_KEY&gt;
# Replace by what was created at the start of this demo
$ export MINIO_SECRET_KEY=&lt;YOUR_SECRET_KEY&gt;
$ streamlit run Streamlit_ROS_2.py

# This will be printed:

  You can now view your Streamlit app in your browser.

  Local URL: http://localhost:8502
  Network URL: http://192.168.2.105:8502
</code></pre>
<p>Reach the address on your browser: <a href="http://localhost:8502">localhost:8502</a>. Here is a video of it:</p>
<p><video src="../../images/demos-tb3_aws_minio_pgsql-streamlit.webm" controls="controls"></video></p>
<p>That's it! Now you can collect your data!</p>
<h2 id="understanding-the-configuration"><a class="header" href="#understanding-the-configuration">Understanding the configuration</a></h2>
<div id="admonition-info-1" class="admonition info">
<div class="admonition-title">
<p>Info</p>
<p><a class="admonition-anchor-link" href="#admonition-info-1"></a></p>
</div>
<div>
<p>The full configuration file can be found <a href="https://github.com/Minipada/ros2_data_collection/blob/humble/dc_demos/params/tb3_simulation_pgsql_minio.yaml">here</a>.</p>
</div>
</div>
<p>For this demo, we will reconstruct the yaml configuration element by element, given how large it is. Go through the explanation to understand how it works.</p>
<h3 id="measurement-server"><a class="header" href="#measurement-server">Measurement server</a></h3>
<h4 id="measurements"><a class="header" href="#measurements">Measurements</a></h4>
<p><code>measurement_plugins</code> sets which plugin to load. We collect</p>
<p>System measurements:</p>
<ol>
<li><a href="../measurements/cpu.html">CPU</a></li>
<li><a href="../measurements/os.html">OS</a></li>
<li><a href="../measurements/memory.html">Memory</a></li>
<li><a href="../measurements/uptime.html">Uptime</a></li>
</ol>
<p>Robot measurements:</p>
<ol>
<li><a href="../measurements/camera.html">Camera images</a></li>
<li><a href="../measurements/cmd_vel.html">Command velocities</a></li>
<li><a href="../measurements/distance_traveled.html">Distance traveled</a></li>
<li><a href="../measurements/position.html">Positions</a></li>
<li><a href="../measurements/speed.html">Speed</a></li>
</ol>
<p>Environment measurements:</p>
<ol>
<li><a href="../measurements/map.html">Map</a></li>
</ol>
<p>Infrastructure measurements:</p>
<ol>
<li><a href="../measurements/tcp_health.html">MinIO API health</a></li>
<li><a href="../measurements/tcp_health.html">MinIO Dashboard health</a></li>
<li><a href="../measurements/tcp_health.html">PostgreSQL health</a></li>
</ol>
<p>Each has their own configuration: polling interval, source topic, destination paths, topics used as input etc. Going through each of them would be too long here but you can check for each measurement its documentation and the general <a href="../measurements.html">documentation of measurements</a></p>
<h4 id="conditions"><a class="header" href="#conditions">Conditions</a></h4>
<p>We also initialize conditions:</p>
<ol>
<li>min_distance_traveled</li>
<li>max_distance_traveled</li>
</ol>
<p>They are used in the distance traveled measurement to only take values in a certain range.</p>
<h3 id="destination-server"><a class="header" href="#destination-server">Destination server</a></h3>
<p>Here we enable the PostgreSQL and MinIO plugins since it is where we send the data.</p>
<h4 id="postgresql-destination"><a class="header" href="#postgresql-destination">PostgreSQL destination</a></h4>
<p>We pass all topics generated by measurements. The node will subscribe to it and transfer the data to PostgreSQL. Note that not all data need to be sent to PostgreSQL, some could be sent elsewhere.</p>
<p>Along with the inputs, we pass the server configuration: username, password, database name etc.</p>
<h4 id="minio-destination"><a class="header" href="#minio-destination">MinIO destination</a></h4>
<p>We pass the topics we want to subscribe to. Here only map and camera since those are the ones generating files.</p>
<p>The <code>src_fields</code> and <code>upload_fields</code> are fields in the JSON sent by the measurement where local and remote paths are stored so the plugin knows where to put the files.</p>
<footer id="open-on-gh">Found a bug? <a href="https://github.com/minipada/ros2_data_collection/edit/main/doc/src/dc/demos/tb3_aws_minio_pgsql.md">Edit this page on GitHub.</a></footer>
                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../../dc/demos/tb3_stdout.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next" href="../../dc/demos/qrcodes_minio_pgsql.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../../dc/demos/tb3_stdout.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next" href="../../dc/demos/qrcodes_minio_pgsql.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>



        <script>
            window.playground_line_numbers = true;
        </script>

        <script>
            window.playground_copyable = true;
        </script>

        <script src="../../ace.js"></script>
        <script src="../../editor.js"></script>
        <script src="../../mode-rust.js"></script>
        <script src="../../theme-dawn.js"></script>
        <script src="../../theme-tomorrow_night.js"></script>

        <script src="../../elasticlunr.min.js"></script>
        <script src="../../mark.min.js"></script>
        <script src="../../searcher.js"></script>

        <script src="../../clipboard.min.js"></script>
        <script src="../../highlight.js"></script>
        <script src="../../book.js"></script>

        <!-- Custom JS scripts -->
        <script src="../../js/mermaid.js"></script>
        <script src="../../js/mermaid-init.js"></script>
        <script src="../../js/theme.js"></script>


    </body>
</html>
