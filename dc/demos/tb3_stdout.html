<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js navy">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Turtlebot3 - Data Collection for ROS 2</title>


        <!-- Custom HTML head -->
        
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="../../favicon.svg">
        <link rel="shortcut icon" href="../../favicon.png">
        <link rel="stylesheet" href="../../css/variables.css">
        <link rel="stylesheet" href="../../css/general.css">
        <link rel="stylesheet" href="../../css/chrome.css">
        <link rel="stylesheet" href="../../css/lineicon.css">
        <link rel="stylesheet" href="../../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../../highlight.css">
        <link rel="stylesheet" href="../../tomorrow-night.css">
        <link rel="stylesheet" href="../../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="../../open-in.css">
        <link rel="stylesheet" href="../.././css/mdbook-admonish.css">
        <link rel="stylesheet" href="../../css/logo.css">
        <link rel="stylesheet" href="../../css/lineicon.css">
        <link rel="stylesheet" href="../../css/theme.css">

        <!-- MathJax -->
        <script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

        <!-- Hotjar -->
        <script>
            if (window.location.href.startsWith("https://minipada.github.io/ros2_data_collection")) {
            (function(h,o,t,j,a,r){
                h.hj=h.hj||function(){(h.hj.q=h.hj.q||[]).push(arguments)};
                h._hjSettings={hjid:3435761,hjsv:6};
                a=o.getElementsByTagName('head')[0];
                r=o.createElement('script');r.async=1;
                r.src=t+h._hjSettings.hjid+j+h._hjSettings.hjsv;
                a.appendChild(r);
            })(window,document,'https://static.hotjar.com/c/hotjar-','.js?sv=');
            }
        </script>
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "../../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "navy";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('navy')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <a id="a-logo-dc" href="/"><img id="logo-dc"></a>
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item "><a href="../../dc/introduction.html"><strong aria-hidden="true">1.</strong> Introduction</a></li><li class="chapter-item "><a href="../../dc/setup.html"><strong aria-hidden="true">2.</strong> Setup</a></li><li class="chapter-item expanded "><a href="../../dc/demos.html"><strong aria-hidden="true">3.</strong> Demos</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../dc/demos/uptime_stdout.html"><strong aria-hidden="true">3.1.</strong> Uptime</a></li><li class="chapter-item "><a href="../../dc/demos/memory_uptime_stdout.html"><strong aria-hidden="true">3.2.</strong> Group memory and uptime</a></li><li class="chapter-item expanded "><a href="../../dc/demos/tb3_stdout.html" class="active"><strong aria-hidden="true">3.3.</strong> Turtlebot3</a></li><li class="chapter-item "><a href="../../dc/demos/tb3_aws_minio_pgsql.html"><strong aria-hidden="true">3.4.</strong> Turtlebot3 AWS Warehouse MinIO PostgreSQL</a></li><li class="chapter-item "><a href="../../dc/demos/qrcodes_minio_pgsql.html"><strong aria-hidden="true">3.5.</strong> QRcodes to PostgreSQL/MinIO</a></li><li class="chapter-item "><a href="../../dc/demos/custom_stdout.html"><strong aria-hidden="true">3.6.</strong> Custom plugin</a></li></ol></li><li class="chapter-item "><a href="../../dc/concepts.html"><strong aria-hidden="true">4.</strong> Concepts</a></li><li class="chapter-item "><a href="../../dc/data_pipeline.html"><strong aria-hidden="true">5.</strong> Data Pipeline</a></li><li class="chapter-item "><a href="../../dc/measurements.html"><strong aria-hidden="true">6.</strong> Measurements</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../dc/measurements/camera.html"><strong aria-hidden="true">6.1.</strong> Camera</a></li><li class="chapter-item "><a href="../../dc/measurements/cmd_vel.html"><strong aria-hidden="true">6.2.</strong> Command velocity</a></li><li class="chapter-item "><a href="../../dc/measurements/cpu.html"><strong aria-hidden="true">6.3.</strong> CPU</a></li><li class="chapter-item "><a href="../../dc/measurements/dummy.html"><strong aria-hidden="true">6.4.</strong> Dummy</a></li><li class="chapter-item "><a href="../../dc/measurements/distance_traveled.html"><strong aria-hidden="true">6.5.</strong> Distance traveled</a></li><li class="chapter-item "><a href="../../dc/measurements/ip_camera.html"><strong aria-hidden="true">6.6.</strong> IP Camera</a></li><li class="chapter-item "><a href="../../dc/measurements/map.html"><strong aria-hidden="true">6.7.</strong> Map</a></li><li class="chapter-item "><a href="../../dc/measurements/memory.html"><strong aria-hidden="true">6.8.</strong> Memory</a></li><li class="chapter-item "><a href="../../dc/measurements/network.html"><strong aria-hidden="true">6.9.</strong> Network</a></li><li class="chapter-item "><a href="../../dc/measurements/os.html"><strong aria-hidden="true">6.10.</strong> OS</a></li><li class="chapter-item "><a href="../../dc/measurements/permissions.html"><strong aria-hidden="true">6.11.</strong> Permissions</a></li><li class="chapter-item "><a href="../../dc/measurements/position.html"><strong aria-hidden="true">6.12.</strong> Position</a></li><li class="chapter-item "><a href="../../dc/measurements/speed.html"><strong aria-hidden="true">6.13.</strong> Speed</a></li><li class="chapter-item "><a href="../../dc/measurements/storage.html"><strong aria-hidden="true">6.14.</strong> Storage</a></li><li class="chapter-item "><a href="../../dc/measurements/string_stamped.html"><strong aria-hidden="true">6.15.</strong> String stamped</a></li><li class="chapter-item "><a href="../../dc/measurements/tcp_health.html"><strong aria-hidden="true">6.16.</strong> TCP Health</a></li><li class="chapter-item "><a href="../../dc/measurements/uptime.html"><strong aria-hidden="true">6.17.</strong> Uptime</a></li></ol></li><li class="chapter-item "><a href="../../dc/conditions.html"><strong aria-hidden="true">7.</strong> Conditions</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../dc/conditions/bool_equal.html"><strong aria-hidden="true">7.1.</strong> Bool equal</a></li><li class="chapter-item "><a href="../../dc/conditions/double_equal.html"><strong aria-hidden="true">7.2.</strong> Double equal</a></li><li class="chapter-item "><a href="../../dc/conditions/double_inferior.html"><strong aria-hidden="true">7.3.</strong> Double inferior</a></li><li class="chapter-item "><a href="../../dc/conditions/double_superior.html"><strong aria-hidden="true">7.4.</strong> Double superior</a></li><li class="chapter-item "><a href="../../dc/conditions/exist.html"><strong aria-hidden="true">7.5.</strong> Exist</a></li><li class="chapter-item "><a href="../../dc/conditions/integer_equal.html"><strong aria-hidden="true">7.6.</strong> Integer equal</a></li><li class="chapter-item "><a href="../../dc/conditions/integer_inferior.html"><strong aria-hidden="true">7.7.</strong> Integer inferior</a></li><li class="chapter-item "><a href="../../dc/conditions/integer_superior.html"><strong aria-hidden="true">7.8.</strong> Integer superior</a></li><li class="chapter-item "><a href="../../dc/conditions/list_bool_equal.html"><strong aria-hidden="true">7.9.</strong> List bool equal</a></li><li class="chapter-item "><a href="../../dc/conditions/list_double_equal.html"><strong aria-hidden="true">7.10.</strong> List double equal</a></li><li class="chapter-item "><a href="../../dc/conditions/list_integer_equal.html"><strong aria-hidden="true">7.11.</strong> List integer equal</a></li><li class="chapter-item "><a href="../../dc/conditions/list_string_equal.html"><strong aria-hidden="true">7.12.</strong> List string equal</a></li><li class="chapter-item "><a href="../../dc/conditions/moving.html"><strong aria-hidden="true">7.13.</strong> Moving</a></li><li class="chapter-item "><a href="../../dc/conditions/same_as_previous.html"><strong aria-hidden="true">7.14.</strong> Same as previous</a></li><li class="chapter-item "><a href="../../dc/conditions/string_match.html"><strong aria-hidden="true">7.15.</strong> String match</a></li></ol></li><li class="chapter-item "><a href="../../dc/data_validation.html"><strong aria-hidden="true">8.</strong> Data validation</a></li><li class="chapter-item "><a href="../../dc/groups.html"><strong aria-hidden="true">9.</strong> Groups</a></li><li class="chapter-item "><a href="../../dc/destinations.html"><strong aria-hidden="true">10.</strong> Destinations</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../dc/destinations/flb_kinesis_data_streams.html"><strong aria-hidden="true">10.1.</strong> Fluent Bit AWS Kinesis Data Streams</a></li><li class="chapter-item "><a href="../../dc/destinations/flb_s3.html"><strong aria-hidden="true">10.2.</strong> Fluent Bit AWS S3</a></li><li class="chapter-item "><a href="../../dc/destinations/flb_file.html"><strong aria-hidden="true">10.3.</strong> Fluent Bit File</a></li><li class="chapter-item "><a href="../../dc/destinations/flb_files_metrics.html"><strong aria-hidden="true">10.4.</strong> Fluent Bit Files metrics</a></li><li class="chapter-item "><a href="../../dc/destinations/flb_http.html"><strong aria-hidden="true">10.5.</strong> Fluent Bit HTTP</a></li><li class="chapter-item "><a href="../../dc/destinations/flb_minio.html"><strong aria-hidden="true">10.6.</strong> Fluent Bit Minio</a></li><li class="chapter-item "><a href="../../dc/destinations/flb_null.html"><strong aria-hidden="true">10.7.</strong> Fluent Bit NULL</a></li><li class="chapter-item "><a href="../../dc/destinations/flb_pgsql.html"><strong aria-hidden="true">10.8.</strong> Fluent Bit PostgreSQL</a></li><li class="chapter-item "><a href="../../dc/destinations/flb_slack.html"><strong aria-hidden="true">10.9.</strong> Fluent Bit Slack</a></li><li class="chapter-item "><a href="../../dc/destinations/flb_stdout.html"><strong aria-hidden="true">10.10.</strong> Fluent Bit Stdout</a></li><li class="chapter-item "><a href="../../dc/destinations/flb_tcp.html"><strong aria-hidden="true">10.11.</strong> Fluent Bit TCP</a></li><li class="chapter-item "><a href="../../dc/destinations/rcl.html"><strong aria-hidden="true">10.12.</strong> RCL</a></li></ol></li><li class="chapter-item "><a href="../../dc/configuration_examples.html"><strong aria-hidden="true">11.</strong> Configuration examples</a></li><li class="chapter-item "><a href="../../dc/infrastructure_setup.html"><strong aria-hidden="true">12.</strong> Infrastructure setup</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../dc/infrastructure_setup/minio.html"><strong aria-hidden="true">12.1.</strong> MinIO</a></li><li class="chapter-item "><a href="../../dc/infrastructure_setup/postgresql.html"><strong aria-hidden="true">12.2.</strong> PostgreSQL</a></li><li class="chapter-item "><a href="../../dc/infrastructure_setup/ip_camera.html"><strong aria-hidden="true">12.3.</strong> Ip camera</a></li></ol></li><li class="chapter-item "><a href="../../dc/cli.html"><strong aria-hidden="true">13.</strong> CLI tools</a></li><li class="chapter-item "><a href="../../dc/requirements.html"><strong aria-hidden="true">14.</strong> Requirements</a></li><li class="chapter-item "><a href="../../dc/future_work.html"><strong aria-hidden="true">15.</strong> Future work and Roadmap</a></li><li class="chapter-item "><a href="../../dc/contributing.html"><strong aria-hidden="true">16.</strong> Contributing</a></li><li class="chapter-item "><a href="../../dc/faq.html"><strong aria-hidden="true">17.</strong> FAQ</a></li><li class="chapter-item "><a href="../../dc/about_contact.html"><strong aria-hidden="true">18.</strong> About and Contact</a></li></ol>
                <footer id="nav-separator"></footer>
                <a style="margin-right: 10px;" href="https://github.com/minipada/ros2_data_collection" target="_blank"><i  class="lni lni-github-original lni-32"></i></a>
                <a style="margin-right: 10px;" href="mailto:d.bensoussan@proton.me" target="_blank"><i  class="lni lni-envelope lni-32"></i></a>
                <div>Under <a target="_blank" style="color: var(--sidebar-active);"
                    href="https://tldrlegal.com/license/mozilla-public-license-2.0-(mpl-2)">MPL-2.0</a>
                license</a>
                </div>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Data Collection for ROS 2</h1>

                    <div class="right-buttons">
                        <a href="../../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/minipada/ros2_data_collection" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>
                        <a href="https://github.com/minipada/ros2_data_collection/edit/humble/doc/src/dc/demos/tb3_stdout.md" title="Suggest an edit" aria-label="Suggest an edit">
                            <i id="git-edit-button" class="fa fa-edit"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="turtlebot3"><a class="header" href="#turtlebot3">Turtlebot3</a></h1>
<p>In this example, we add a robot and start collecting robot data to Stdout.</p>
<p>You will also need 2 terminal windows, to:</p>
<ol>
<li>Run the Nav2 turtlebot3 launchfile: it starts localization, navigation and RViz</li>
<li>Run DC</li>
</ol>
<p>Since RViz is pretty verbose, using 2 terminal windows will help reading the JSON printed on the terminal window.</p>
<h2 id="setup-the-environment"><a class="header" href="#setup-the-environment">Setup the environment</a></h2>
<p>In each, terminal, source your environment and setup turtlebot configuration:</p>
<pre><code class="language-bash">$ source /opt/ros/humble/setup.bash
$ source install/setup.bash
$ export GAZEBO_MODEL_PATH=$GAZEBO_MODEL_PATH:/opt/ros/humble/share/turtlebot3_gazebo/models
$ export TURTLEBOT3_MODEL=waffle
</code></pre>
<h2 id="start-navigation"><a class="header" href="#start-navigation">Start Navigation</a></h2>
<p>Then, start the Turtlebot launchfile:</p>
<pre><code class="language-bash">$ ros2 launch nav2_bringup tb3_simulation_launch.py headless:=False
</code></pre>
<p>RViz and Gazebo will start: you should now see the robot in Gazebo, and the map on RViz.</p>
<p>Set the robot position using the &quot;2D Pose Estimate&quot; button.</p>
<div id="admonition-info" class="admonition info">
<div class="admonition-title">
<p>Info</p>
<p><a class="admonition-anchor-link" href="#admonition-info"></a></p>
</div>
<div>
<p>If any problem occur, please take a look at the <a href="https://navigation.ros.org/getting_started/index.html#running-the-example">nav2 official documentation</a> which covers the case.</p>
</div>
</div>
<h2 id="start-dc"><a class="header" href="#start-dc">Start DC</a></h2>
<p>Execute</p>
<pre><code class="language-bash">$ ros2 launch dc_demos tb3_simulation_stdout.launch.py
</code></pre>
<p>At the end, the data is displayed:</p>
<pre><code>[component_container_isolated-1] [{&quot;date&quot;:1677690777.96911,&quot;width&quot;:384,&quot;height&quot;:384,&quot;remote_paths&quot;:{&quot;minio&quot;:{&quot;pgm&quot;:&quot;C3PO/2023/03/01/17/map/2023-03-01T17:12:57.pgm&quot;,&quot;yaml&quot;:&quot;C3PO/2023/03/01/17/map/2023-03-01T17:12:57.yaml&quot;}},&quot;resolution&quot;:0.05000000074505806,&quot;origin&quot;:{&quot;x&quot;:-10,&quot;y&quot;:-10},&quot;local_paths&quot;:{&quot;pgm&quot;:&quot;/root/dc_data/C3PO/2023/03/01/17/map/2023-03-01T17:12:57.pgm&quot;,&quot;yaml&quot;:&quot;/root/dc_data/C3PO/2023/03/01/17/map/2023-03-01T17:12:57.yaml&quot;},&quot;id&quot;:&quot;be781e5ffb1e7ee4f817fe7b63e92c32&quot;,&quot;robot_name&quot;:&quot;C3PO&quot;,&quot;run_id&quot;:&quot;234&quot;}]
[component_container_isolated-1] [{&quot;date&quot;:1677690782.883036,&quot;width&quot;:384,&quot;height&quot;:384,&quot;remote_paths&quot;:{&quot;minio&quot;:{&quot;pgm&quot;:&quot;C3PO/2023/03/01/17/map/2023-03-01T17:13:02.pgm&quot;,&quot;yaml&quot;:&quot;C3PO/2023/03/01/17/map/2023-03-01T17:13:02.yaml&quot;}},&quot;resolution&quot;:0.05000000074505806,&quot;origin&quot;:{&quot;x&quot;:-10,&quot;y&quot;:-10},&quot;local_paths&quot;:{&quot;pgm&quot;:&quot;/root/dc_data/C3PO/2023/03/01/17/map/2023-03-01T17:13:02.pgm&quot;,&quot;yaml&quot;:&quot;/root/dc_data/C3PO/2023/03/01/17/map/2023-03-01T17:13:02.yaml&quot;},&quot;id&quot;:&quot;be781e5ffb1e7ee4f817fe7b63e92c32&quot;,&quot;robot_name&quot;:&quot;C3PO&quot;,&quot;run_id&quot;:&quot;234&quot;}]
[component_container_isolated-1] [{&quot;position&quot;:{&quot;x&quot;:-0.7254206029057992,&quot;yaw&quot;:0.134098723062189,&quot;tags&quot;:[&quot;flb_stdout&quot;],&quot;y&quot;:-0.5116378019627142},&quot;cmd_vel&quot;:{&quot;tags&quot;:[&quot;flb_stdout&quot;],&quot;linear&quot;:{&quot;x&quot;:0.26,&quot;z&quot;:0,&quot;y&quot;:0},&quot;angular&quot;:{&quot;x&quot;:0,&quot;z&quot;:-0.157895,&quot;y&quot;:0}},&quot;speed&quot;:{&quot;tags&quot;:[&quot;flb_stdout&quot;],&quot;linear&quot;:{&quot;x&quot;:8.720555295508514e-05,&quot;z&quot;:0,&quot;y&quot;:4.219923511090644e-06},&quot;computed&quot;:8.730759543499989e-05,&quot;angular&quot;:{&quot;x&quot;:-0.0002958005596118955}},&quot;date&quot;:1677690787.878526,&quot;id&quot;:&quot;be781e5ffb1e7ee4f817fe7b63e92c32&quot;,&quot;robot_name&quot;:&quot;C3PO&quot;,&quot;run_id&quot;:&quot;234&quot;}]
[component_container_isolated-1] [{&quot;date&quot;:1677690787.883072,&quot;width&quot;:384,&quot;height&quot;:384,&quot;remote_paths&quot;:{&quot;minio&quot;:{&quot;pgm&quot;:&quot;C3PO/2023/03/01/17/map/2023-03-01T17:13:07.pgm&quot;,&quot;yaml&quot;:&quot;C3PO/2023/03/01/17/map/2023-03-01T17:13:07.yaml&quot;}},&quot;resolution&quot;:0.05000000074505806,&quot;origin&quot;:{&quot;x&quot;:-10,&quot;y&quot;:-10},&quot;local_paths&quot;:{&quot;pgm&quot;:&quot;/root/dc_data/C3PO/2023/03/01/17/map/2023-03-01T17:13:07.pgm&quot;,&quot;yaml&quot;:&quot;/root/dc_data/C3PO/2023/03/01/17/map/2023-03-01T17:13:07.yaml&quot;},&quot;id&quot;:&quot;be781e5ffb1e7ee4f817fe7b63e92c32&quot;,&quot;robot_name&quot;:&quot;C3PO&quot;,&quot;run_id&quot;:&quot;234&quot;}]
[component_container_isolated-1] [{&quot;position&quot;:{&quot;x&quot;:-0.1931822640325796,&quot;yaw&quot;:-0.08553498481283986,&quot;tags&quot;:[&quot;flb_stdout&quot;],&quot;y&quot;:-0.5267276846092974},&quot;cmd_vel&quot;:{&quot;tags&quot;:[&quot;flb_stdout&quot;],&quot;linear&quot;:{&quot;x&quot;:0.232632,&quot;z&quot;:0,&quot;y&quot;:0},&quot;angular&quot;:{&quot;x&quot;:0,&quot;z&quot;:-0.0526316,&quot;y&quot;:0}},&quot;speed&quot;:{&quot;tags&quot;:[&quot;flb_stdout&quot;],&quot;linear&quot;:{&quot;x&quot;:0.2466804589428482,&quot;z&quot;:0,&quot;y&quot;:4.147463233418404e-05},&quot;computed&quot;:0.2466804624294339,&quot;angular&quot;:{&quot;x&quot;:-0.1575310923819759}},&quot;date&quot;:1677690789.878385,&quot;id&quot;:&quot;be781e5ffb1e7ee4f817fe7b63e92c32&quot;,&quot;robot_name&quot;:&quot;C3PO&quot;,&quot;run_id&quot;:&quot;234&quot;}]
[component_container_isolated-1] [{&quot;position&quot;:{&quot;x&quot;:-0.06732902212346159,&quot;yaw&quot;:-0.06199357549188581,&quot;tags&quot;:[&quot;flb_stdout&quot;],&quot;y&quot;:-0.5350783704643411},&quot;cmd_vel&quot;:{&quot;tags&quot;:[&quot;flb_stdout&quot;],&quot;linear&quot;:{&quot;x&quot;:0.191579,&quot;z&quot;:0,&quot;y&quot;:0},&quot;angular&quot;:{&quot;x&quot;:0,&quot;z&quot;:-0.0526316,&quot;y&quot;:0}},&quot;speed&quot;:{&quot;tags&quot;:[&quot;flb_stdout&quot;],&quot;linear&quot;:{&quot;x&quot;:0.2464715530337069,&quot;z&quot;:0,&quot;y&quot;:1.735682541426087e-05},&quot;computed&quot;:0.2464715536448513,&quot;angular&quot;:{&quot;x&quot;:-0.05272644093984532}},&quot;date&quot;:1677690790.878357,&quot;id&quot;:&quot;be781e5ffb1e7ee4f817fe7b63e92c32&quot;,&quot;robot_name&quot;:&quot;C3PO&quot;,&quot;run_id&quot;:&quot;234&quot;}]
[component_container_isolated-1] [{&quot;position&quot;:{&quot;x&quot;:0.1426837169393564,&quot;yaw&quot;:-0.1292500346335131,&quot;tags&quot;:[&quot;flb_stdout&quot;],&quot;y&quot;:-0.5883037844577782},&quot;cmd_vel&quot;:{&quot;tags&quot;:[&quot;flb_stdout&quot;],&quot;linear&quot;:{&quot;x&quot;:0,&quot;z&quot;:0,&quot;y&quot;:0},&quot;angular&quot;:{&quot;x&quot;:0,&quot;z&quot;:0,&quot;y&quot;:0}},&quot;speed&quot;:{&quot;tags&quot;:[&quot;flb_stdout&quot;],&quot;linear&quot;:{&quot;x&quot;:0.1917414358977791,&quot;z&quot;:0,&quot;y&quot;:1.44170547699829e-05},&quot;computed&quot;:0.1917414364397889,&quot;angular&quot;:{&quot;x&quot;:-0.05280628215810287}},&quot;date&quot;:1677690791.878987,&quot;id&quot;:&quot;be781e5ffb1e7ee4f817fe7b63e92c32&quot;,&quot;robot_name&quot;:&quot;C3PO&quot;,&quot;run_id&quot;:&quot;234&quot;}]
[component_container_isolated-1] [{&quot;position&quot;:{&quot;x&quot;:0.2658444927274801,&quot;yaw&quot;:-0.1669572018597313,&quot;tags&quot;:[&quot;flb_stdout&quot;],&quot;y&quot;:-0.6121168728850158},&quot;cmd_vel&quot;:{&quot;tags&quot;:[&quot;flb_stdout&quot;],&quot;linear&quot;:{&quot;x&quot;:0,&quot;z&quot;:0,&quot;y&quot;:0},&quot;angular&quot;:{&quot;x&quot;:0,&quot;z&quot;:0,&quot;y&quot;:0}},&quot;speed&quot;:{&quot;tags&quot;:[&quot;flb_stdout&quot;],&quot;linear&quot;:{&quot;x&quot;:3.645119603853573e-05,&quot;z&quot;:0,&quot;y&quot;:3.14134397110158e-06},&quot;computed&quot;:3.658630528742332e-05,&quot;angular&quot;:{&quot;x&quot;:-0.0004012554003809027}},&quot;date&quot;:1677690792.879082,&quot;id&quot;:&quot;be781e5ffb1e7ee4f817fe7b63e92c32&quot;,&quot;robot_name&quot;:&quot;C3PO&quot;,&quot;run_id&quot;:&quot;234&quot;}]
[component_container_isolated-1] [{&quot;date&quot;:1677690792.883126,&quot;width&quot;:384,&quot;height&quot;:384,&quot;remote_paths&quot;:{&quot;minio&quot;:{&quot;pgm&quot;:&quot;C3PO/2023/03/01/17/map/2023-03-01T17:13:12.pgm&quot;,&quot;yaml&quot;:&quot;C3PO/2023/03/01/17/map/2023-03-01T17:13:12.yaml&quot;}},&quot;resolution&quot;:0.05000000074505806,&quot;origin&quot;:{&quot;x&quot;:-10,&quot;y&quot;:-10},&quot;local_paths&quot;:{&quot;pgm&quot;:&quot;/root/dc_data/C3PO/2023/03/01/17/map/2023-03-01T17:13:12.pgm&quot;,&quot;yaml&quot;:&quot;/root/dc_data/C3PO/2023/03/01/17/map/2023-03-01T17:13:12.yaml&quot;},&quot;id&quot;:&quot;be781e5ffb1e7ee4f817fe7b63e92c32&quot;,&quot;robot_name&quot;:&quot;C3PO&quot;,&quot;run_id&quot;:&quot;234&quot;}
</code></pre>
<p>Given the JSON is quite large, let's analyze 2 different records:</p>
<p>The first one being the data published on the robot group:</p>
<pre><code class="language-json">[
  {
    &quot;cmd_vel&quot;: {
      &quot;linear&quot;: {
        &quot;x&quot;: 0.246316,
        &quot;y&quot;: 0,
        &quot;z&quot;: 0
      },
      &quot;angular&quot;: {
        &quot;x&quot;: 0,
        &quot;y&quot;: 0,
        &quot;z&quot;: 0.263158
      }
    },
    &quot;date&quot;: 1677694799.685468,
    &quot;position&quot;: {
      &quot;x&quot;: -0.6033772358727438,
      &quot;yaw&quot;: -0.7146495585355921,
      &quot;y&quot;: -1.633862970534114
    },
    &quot;speed&quot;: {
      &quot;angular&quot;: {
        &quot;x&quot;: -0.0002542699063698451
      },
      &quot;computed&quot;: 3.279051750818494e-05,
      &quot;linear&quot;: {
        &quot;x&quot;: 3.244397182637543e-05,
        &quot;y&quot;: 4.754653571390878e-06,
        &quot;z&quot;: 0
      }
    },
    &quot;name&quot;: &quot;robot&quot;,
    &quot;id&quot;: &quot;be781e5ffb1e7ee4f817fe7b63e92c32&quot;,
    &quot;robot_name&quot;: &quot;C3PO&quot;,
    &quot;run_id&quot;: &quot;240&quot;
  }
]
</code></pre>
<p>This record contains the speed, cmd_vel and position from the group &quot;robot&quot;. Not that the tags for each measurement have been dropped. This is because they won't be used in this particular group (they can be used as a single measurement)</p>
<pre><code class="language-json">[
  {
    &quot;width&quot;: 384,
    &quot;remote_paths&quot;: {
      &quot;minio&quot;: {
        &quot;yaml&quot;: &quot;C3PO/2023/03/01/18/map/2023-03-01T18:20:16.yaml&quot;,
        &quot;pgm&quot;: &quot;C3PO/2023/03/01/18/map/2023-03-01T18:20:16.pgm&quot;
      }
    },
    &quot;name&quot;: &quot;map&quot;,
    &quot;resolution&quot;: 0.05000000074505806,
    &quot;origin&quot;: {
      &quot;x&quot;: -10,
      &quot;y&quot;: -10
    },
    &quot;local_paths&quot;: {
      &quot;yaml&quot;: &quot;/root/dc_data/C3PO/2023/03/01/18/map/2023-03-01T18:20:16.yaml&quot;,
      &quot;pgm&quot;: &quot;/root/dc_data/C3PO/2023/03/01/18/map/2023-03-01T18:20:16.pgm&quot;
    },
    &quot;date&quot;: 1677694816.690489,
    &quot;height&quot;: 384,
    &quot;id&quot;: &quot;be781e5ffb1e7ee4f817fe7b63e92c32&quot;,
    &quot;robot_name&quot;: &quot;C3PO&quot;,
    &quot;run_id&quot;: &quot;240&quot;
  }
]
</code></pre>
<p>This record contains the map data from the measurement.</p>
<h2 id="configuration"><a class="header" href="#configuration">Configuration</a></h2>
<h3 id="measurement"><a class="header" href="#measurement">Measurement</a></h3>
<pre><code class="language-yaml">measurement_server:
  ros__parameters:
    custom_str_params: [&quot;robot_name&quot;]
    robot_name: &quot;C3PO&quot;
    measurement_plugins: [&quot;cmd_vel&quot;, &quot;map&quot;, &quot;position&quot;, &quot;speed&quot;]
    run_id:
      enabled: true
      counter: true
      counter_path: &quot;$HOME/run_id&quot;
      uuid: false
    save_local_base_path: &quot;$HOME/dc_data/&quot;
    all_base_path: &quot;=robot_name/%Y/%m/%d/%H&quot;
    cmd_vel:
      plugin: &quot;dc_measurements/CmdVel&quot;
      tags: [&quot;flb_stdout&quot;]
      group_key: &quot;cmd_vel&quot;
      enable_validator: true
      topic_output: &quot;/dc/measurement/cmd_vel&quot;
    position:
      plugin: &quot;dc_measurements/Position&quot;
      tags: [&quot;flb_stdout&quot;]
      group_key: &quot;position&quot;
      topic_output: &quot;/dc/measurement/position&quot;
      polling_interval: 1000
      enable_validator: true
      init_collect: true
      global_frame: &quot;map&quot;
      robot_base_frame: &quot;base_link&quot;
      transform_timeout: 0.1
    speed:
      plugin: &quot;dc_measurements/Speed&quot;
      tags: [&quot;flb_stdout&quot;]
      group_key: &quot;speed&quot;
      odom_topic: &quot;/odom&quot;
      topic_output: &quot;/dc/measurement/speed&quot;
    map:
      plugin: &quot;dc_measurements/Map&quot;
      tags: [&quot;flb_stdout&quot;]
      group_key: &quot;map&quot;
      polling_interval: 5000
      save_path: &quot;map/%Y-%m-%dT%H:%M:%S&quot;
      topic_output: &quot;/dc/measurement/map&quot;
      save_map_timeout: 4.0
      remote_prefixes: [&quot;&quot;]
      remote_keys: [&quot;minio&quot;]
</code></pre>
<p><strong>save_local_base_path (Optional)</strong>: Used as a common base for all saved files from measurement plugins. <em>all_base_path</em> is concatenated to it afterwards for defining the path where files are saved.</p>
<p><strong>all_base_path (Optional)</strong>: Used as a common base for some measurements to save files. Is concatenated to <em>save_local_base_path</em>. Note the =robot_name, which is later replaced by C3PO (the variable defined in custom_str_params)</p>
<p><strong>map.remote_keys</strong>: creates a dictionary inside <strong>remote_paths</strong> which is named by the strings in this field, which contains fields used by your API to fetch the remote URLs of the files.</p>
<h3 id="group"><a class="header" href="#group">Group</a></h3>
<pre><code class="language-yaml">group_server:
  ros__parameters:
    groups: [&quot;robot&quot;]
    robot:
      inputs:
        [
          &quot;/dc/measurement/cmd_vel&quot;,
          &quot;/dc/measurement/position&quot;,
          &quot;/dc/measurement/speed&quot;,
        ]
      output: &quot;/dc/group/robot&quot;
      sync_delay: 5.0
      group_key: &quot;robot&quot;
      tags: [&quot;flb_stdout&quot;]
      include_group_name: true
</code></pre>
<p>Create a group with data from cmd_vel, position and speed. Even though it appears there is nothing new here, I shall like to precise something important. In the previous demo, we mentioned that if all messages are not received by the group, it will drop it. It matters in this case because cmd_vel is not published all the time in this example (not when it is not moving), this means the data will be collected <strong>only</strong> when the robot moves (when a controller sends a command).</p>
<p>If you wished to collect the position and the speed constantly, you could take cmd_vel out of this group and add it in the destination.</p>
<h4 id="destinations"><a class="header" href="#destinations">Destinations</a></h4>
<pre><code class="language-yaml">destination_server:
  ros__parameters:
    flb:
      flush: 1
      flb_grace: 1
      log_level: &quot;info&quot;
      storage_path: &quot;/var/log/flb-storage/&quot;
      storage_sync: &quot;full&quot;
      storage_checksum: &quot;off&quot;
      storage_backlog_mem_limit: &quot;1M&quot;
      scheduler_cap: 200
      scheduler_base: 5
      http_server: true
      http_listen: &quot;0.0.0.0&quot;
      http_port: 2020
      in_storage_type: &quot;filesystem&quot;
      in_storage_pause_on_chunks_overlimit: &quot;off&quot;
    destination_plugins: [&quot;flb_stdout&quot;]
    custom_str_params_list: [&quot;robot_name&quot;, &quot;id&quot;]
    custom_str_params:
      robot_name:
        name: robot_name
        value: &quot;C3PO&quot;
      # Requires systemd package
      id:
        name: id
        value_from_file: /etc/machine-id
    flb_stdout:
      plugin: &quot;dc_destinations/FlbStdout&quot;
      inputs: [&quot;/dc/group/robot&quot;, &quot;/dc/measurement/map&quot;]
      time_format: &quot;double&quot;
      time_key: &quot;date&quot;
      debug: false
</code></pre>
<p>Nothing new here, we simply edited the inputs in flb_stdout to <code>[&quot;/dc/group/robot&quot;, &quot;/dc/measurement/map&quot;]</code> to get the data from the robot group and the map.</p>
<h2 id="console-output"><a class="header" href="#console-output">Console output</a></h2>
<p>Now that the node started, let us see what's displayed in the console</p>
<pre><code class="language-bash">[component_container_isolated-1] [INFO] [1677696067.792012776] [dc_container]: Load Library: /root/ws/install/dc_measurements/lib/libmeasurement_server_core.so
[component_container_isolated-1] [INFO] [1677696067.795921257] [dc_container]: Found class: rclcpp_components::NodeFactoryTemplate&lt;measurement_server::MeasurementServer&gt;
[component_container_isolated-1] [INFO] [1677696067.795956318] [dc_container]: Instantiate class: rclcpp_components::NodeFactoryTemplate&lt;measurement_server::MeasurementServer&gt;
[component_container_isolated-1] [INFO] [1677696067.811804437] [measurement_server]:
[component_container_isolated-1] 	measurement_server lifecycle node launched.
[component_container_isolated-1] 	Waiting on external lifecycle transitions to activate
[component_container_isolated-1] 	See https://design.ros2.org/articles/node_lifecycle.html for more information.
[component_container_isolated-1] [INFO] [1677696067.818755098] [measurement_server]: Base save path expanded to /root/dc_data/
[component_container_isolated-1] [INFO] [1677696067.818799565] [measurement_server]: All Base path expanded to C3PO/%Y/%m/%d/%H
[INFO] [launch_ros.actions.load_composable_nodes]: Loaded node '/measurement_server' in container 'dc_container'
[component_container_isolated-1] [INFO] [1677696067.821344112] [dc_container]: Load Library: /root/ws/install/dc_destinations/lib/libdestination_server_core.so
[component_container_isolated-1] [INFO] [1677696067.826089144] [dc_container]: Found class: rclcpp_components::NodeFactoryTemplate&lt;destination_server::DestinationServer&gt;
[component_container_isolated-1] [INFO] [1677696067.826138848] [dc_container]: Instantiate class: rclcpp_components::NodeFactoryTemplate&lt;destination_server::DestinationServer&gt;
[component_container_isolated-1] [INFO] [1677696067.845160790] [destination_server]:
[component_container_isolated-1] 	destination_server lifecycle node launched.
[component_container_isolated-1] 	Waiting on external lifecycle transitions to activate
[component_container_isolated-1] 	See https://design.ros2.org/articles/node_lifecycle.html for more information.
[INFO] [launch_ros.actions.load_composable_nodes]: Loaded node '/destination_server' in container 'dc_container'
[component_container_isolated-1] [INFO] [1677696067.856784495] [dc_container]: Load Library: /opt/ros/humble/lib/libnav2_lifecycle_manager_core.so
[component_container_isolated-1] [INFO] [1677696067.857836219] [dc_container]: Found class: rclcpp_components::NodeFactoryTemplate&lt;nav2_lifecycle_manager::LifecycleManager&gt;
[component_container_isolated-1] [INFO] [1677696067.857877118] [dc_container]: Instantiate class: rclcpp_components::NodeFactoryTemplate&lt;nav2_lifecycle_manager::LifecycleManager&gt;
[component_container_isolated-1] [INFO] [1677696067.875491851] [lifecycle_manager_navigation]: Creating
[INFO] [launch_ros.actions.load_composable_nodes]: Loaded node '/lifecycle_manager_navigation' in container 'dc_container'
[component_container_isolated-1] [INFO] [1677696067.881290824] [lifecycle_manager_navigation]: Creating and initializing lifecycle service clients
[component_container_isolated-1] [INFO] [1677696067.889491127] [lifecycle_manager_navigation]: Starting managed nodes bringup...
</code></pre>
<p>Measurement server and destination server are starting in the Lifecycle, you can read more about it <a href="../concepts.html#lifecycle-nodes-and-bond">here</a></p>
<p>&quot;Base save path&quot; and &quot;All Base path&quot; are also saved and expanded. Note &quot;=robot_name&quot; has been replaced by C3PO:</p>
<pre><code class="language-bash">[component_container_isolated-1] [INFO] [1677696067.818755098] [measurement_server]: Base save path expanded to /root/dc_data/
[component_container_isolated-1] [INFO] [1677696067.818799565] [measurement_server]: All Base path expanded to C3PO/%Y/%m/%d/%H
</code></pre>
<p>Afterward, the measurement_server starts:</p>
<pre><code>[component_container_isolated-1] [INFO] [1677694796.667666978] [lifecycle_manager_navigation]: Configuring measurement_server
[component_container_isolated-1] [INFO] [1677694796.667887325] [measurement_server]: Configuring
[component_container_isolated-1] [INFO] [1677694796.680348817] [measurement_server]: Creating measurement plugin cmd_vel: Type dc_measurements/CmdVel, Group key: cmd_vel, Polling interval: 1000, Debug: 0, Validator enabled: 1, Schema path: , Tags: [flb_stdout], Init collect: 1, Init Max measurement: 0, Include measurement name: 0, Include measurement plugin name: 0, Remote keys: , Remote prefixes: , Include measurement plugin name: 0, Max measurement on condition: 0, If all condition: , If any condition: , If none condition:
[component_container_isolated-1] [INFO] [1677694796.682517594] [measurement_server]: Configuring cmd_vel
[component_container_isolated-1] [INFO] [1677694796.684392643] [measurement_server]: Done configuring cmd_vel
[component_container_isolated-1] [INFO] [1677694796.684643767] [measurement_server]: Looking for schema at /root/ws/install/dc_measurements/share/dc_measurements/plugins/measurements/json/cmd_vel.json
[component_container_isolated-1] [INFO] [1677694796.684685350] [measurement_server]: schema: {&quot;$defs&quot;:{&quot;vector3&quot;:{&quot;properties&quot;:{&quot;x&quot;:{&quot;description&quot;:&quot;X speed&quot;,&quot;type&quot;:&quot;number&quot;},&quot;y&quot;:{&quot;description&quot;:&quot;Y speed&quot;,&quot;type&quot;:&quot;number&quot;},&quot;z&quot;:{&quot;description&quot;:&quot;Z speed&quot;,&quot;type&quot;:&quot;number&quot;}},&quot;type&quot;:&quot;object&quot;}},&quot;$schema&quot;:&quot;http://json-schema.org/draft-07/schema#&quot;,&quot;description&quot;:&quot;Command velocity sent to the robot&quot;,&quot;properties&quot;:{&quot;angular&quot;:{&quot;description&quot;:&quot;Angular velocity as a vector&quot;,&quot;items&quot;:{&quot;$ref&quot;:&quot;#/$defs/vector3&quot;},&quot;type&quot;:&quot;object&quot;},&quot;linear&quot;:{&quot;description&quot;:&quot;Linear velocity as a vector&quot;,&quot;items&quot;:{&quot;$ref&quot;:&quot;#/$defs/vector3&quot;},&quot;type&quot;:&quot;object&quot;}},&quot;title&quot;:&quot;Cmd_vel&quot;,&quot;type&quot;:&quot;object&quot;}
[component_container_isolated-1] [INFO] [1677694796.688143164] [measurement_server]: Creating measurement plugin map: Type dc_measurements/Map, Group key: map, Polling interval: 5000, Debug: 0, Validator enabled: 1, Schema path: , Tags: [flb_stdout], Init collect: 1, Init Max measurement: 0, Include measurement name: 1, Include measurement plugin name: 0, Remote keys: minio, Remote prefixes: , Include measurement plugin name: 0, Max measurement on condition: 0, If all condition: , If any condition: , If none condition:
[component_container_isolated-1] [INFO] [1677694796.689090088] [measurement_server]: Configuring map
[component_container_isolated-1] [INFO] [1677694796.690180661] [measurement_server]: Done configuring map
[component_container_isolated-1] [INFO] [1677694796.690522923] [measurement_server]: Looking for schema at /root/ws/install/dc_measurements/share/dc_measurements/plugins/measurements/json/map.json
[component_container_isolated-1] [INFO] [1677694796.690587274] [measurement_server]: schema: {&quot;$defs&quot;:{&quot;origin&quot;:{&quot;description&quot;:&quot;The 2-D pose of the lower-left pixel in the map, as (x, y, yaw), with yaw as counterclockwise rotation (yaw=0 means no rotation). Many parts of the system currently ignore yaw.&quot;,&quot;properties&quot;:{&quot;x&quot;:{&quot;description&quot;:&quot;X origin of the robot&quot;,&quot;type&quot;:&quot;number&quot;},&quot;y&quot;:{&quot;description&quot;:&quot;Y origin of the robot&quot;,&quot;type&quot;:&quot;number&quot;}},&quot;type&quot;:&quot;object&quot;},&quot;paths&quot;:{&quot;properties&quot;:{&quot;pgm&quot;:{&quot;description&quot;:&quot;Path to the map PGM file containing the gray-scale image&quot;,&quot;type&quot;:&quot;string&quot;},&quot;yaml&quot;:{&quot;description&quot;:&quot;Path to the map YAML file containing map metadata&quot;,&quot;type&quot;:&quot;string&quot;}},&quot;type&quot;:&quot;object&quot;}},&quot;$schema&quot;:&quot;http://json-schema.org/draft-07/schema#&quot;,&quot;description&quot;:&quot;Map saved metadata and paths&quot;,&quot;properties&quot;:{&quot;height&quot;:{&quot;description&quot;:&quot;Height of the PGM&quot;,&quot;minimum&quot;:0,&quot;type&quot;:&quot;integer&quot;},&quot;local_paths&quot;:{&quot;description&quot;:&quot;Paths where metadata and image are stored&quot;,&quot;items&quot;:{&quot;$ref&quot;:&quot;#/$defs/paths&quot;},&quot;type&quot;:&quot;object&quot;},&quot;origin&quot;:{&quot;description&quot;:&quot;Robot origin position in meters&quot;,&quot;items&quot;:{&quot;$ref&quot;:&quot;#/$defs/origin&quot;},&quot;type&quot;:&quot;object&quot;},&quot;remote_paths&quot;:{&quot;additionalProperties&quot;:{&quot;items&quot;:{&quot;$ref&quot;:&quot;#/$defs/paths&quot;},&quot;type&quot;:&quot;object&quot;},&quot;description&quot;:&quot;Dictionary of paths where metadata and image will be remotely stored&quot;,&quot;type&quot;:&quot;object&quot;},&quot;resolution&quot;:{&quot;description&quot;:&quot;Resolution of the map, meters/pixel&quot;,&quot;minimum&quot;:0,&quot;type&quot;:&quot;number&quot;},&quot;width&quot;:{&quot;description&quot;:&quot;Width of the PGM&quot;,&quot;minimum&quot;:0,&quot;type&quot;:&quot;integer&quot;}},&quot;title&quot;:&quot;Map&quot;,&quot;type&quot;:&quot;object&quot;}
[component_container_isolated-1] [INFO] [1677694796.693890952] [measurement_server]: Creating measurement plugin position: Type dc_measurements/Position, Group key: position, Polling interval: 1000, Debug: 0, Validator enabled: 1, Schema path: , Tags: [flb_stdout], Init collect: 1, Init Max measurement: 0, Include measurement name: 0, Include measurement plugin name: 0, Remote keys: , Remote prefixes: , Include measurement plugin name: 0, Max measurement on condition: 0, If all condition: , If any condition: , If none condition:
[component_container_isolated-1] [INFO] [1677694796.694797887] [measurement_server]: Configuring position
[component_container_isolated-1] [INFO] [1677694796.695799962] [measurement_server]: Done configuring position
[component_container_isolated-1] [INFO] [1677694796.696060904] [measurement_server]: Looking for schema at /root/ws/install/dc_measurements/share/dc_measurements/plugins/measurements/json/position.json
[component_container_isolated-1] [INFO] [1677694796.696114257] [measurement_server]: schema: {&quot;$schema&quot;:&quot;http://json-schema.org/draft-07/schema#&quot;,&quot;description&quot;:&quot;Position and orientation of the robot&quot;,&quot;properties&quot;:{&quot;x&quot;:{&quot;description&quot;:&quot;X position of the robot&quot;,&quot;type&quot;:&quot;number&quot;},&quot;y&quot;:{&quot;description&quot;:&quot;Y position of the robot&quot;,&quot;type&quot;:&quot;number&quot;},&quot;yaw&quot;:{&quot;description&quot;:&quot;Yaw angle of the robot&quot;,&quot;type&quot;:&quot;number&quot;}},&quot;title&quot;:&quot;Position&quot;,&quot;type&quot;:&quot;object&quot;}
[component_container_isolated-1] [INFO] [1677694796.699956883] [measurement_server]: Creating measurement plugin speed: Type dc_measurements/Speed, Group key: speed, Polling interval: 1000, Debug: 0, Validator enabled: 1, Schema path: , Tags: [flb_stdout], Init collect: 1, Init Max measurement: 0, Include measurement name: 0, Include measurement plugin name: 0, Remote keys: , Remote prefixes: , Include measurement plugin name: 0, Max measurement on condition: 0, If all condition: , If any condition: , If none condition:
[component_container_isolated-1] [INFO] [1677694796.701722429] [measurement_server]: Configuring speed
[component_container_isolated-1] [INFO] [1677694796.703057966] [measurement_server]: Done configuring speed
[component_container_isolated-1] [INFO] [1677694796.703357744] [measurement_server]: Looking for schema at /root/ws/install/dc_measurements/share/dc_measurements/plugins/measurements/json/speed.json
[component_container_isolated-1] [INFO] [1677694796.703413430] [measurement_server]: schema: {&quot;$defs&quot;:{&quot;vector3&quot;:{&quot;properties&quot;:{&quot;x&quot;:{&quot;description&quot;:&quot;X speed&quot;,&quot;type&quot;:&quot;number&quot;},&quot;y&quot;:{&quot;description&quot;:&quot;Y speed&quot;,&quot;type&quot;:&quot;number&quot;},&quot;z&quot;:{&quot;description&quot;:&quot;Z speed&quot;,&quot;type&quot;:&quot;number&quot;}},&quot;type&quot;:&quot;object&quot;}},&quot;$schema&quot;:&quot;http://json-schema.org/draft-07/schema#&quot;,&quot;description&quot;:&quot;Computed, linear and angular speed of the robot&quot;,&quot;properties&quot;:{&quot;angular&quot;:{&quot;description&quot;:&quot;Angular velocity as a vector&quot;,&quot;items&quot;:{&quot;$ref&quot;:&quot;#/$defs/vector3&quot;},&quot;type&quot;:&quot;object&quot;},&quot;computed&quot;:{&quot;description&quot;:&quot;Computed speed in meter/s&quot;,&quot;type&quot;:&quot;number&quot;},&quot;linear&quot;:{&quot;description&quot;:&quot;Linear velocity as a vector&quot;,&quot;items&quot;:{&quot;$ref&quot;:&quot;#/$defs/vector3&quot;},&quot;type&quot;:&quot;object&quot;}},&quot;title&quot;:&quot;Speed&quot;,&quot;type&quot;:&quot;object&quot;}
</code></pre>
<p>Plugins are loaded one by one (here only one is, the uptime one) and configured. The configuration for each is displayed and the validation schema is also loaded and its path printed.</p>
<p>Then, the destination_server starts:</p>
<pre><code>[component_container_isolated-1] [INFO] [1677694796.706019709] [lifecycle_manager_navigation]: Configuring destination_server
[component_container_isolated-1] [INFO] [1677694796.706162231] [destination_server]: Configuring
[component_container_isolated-1] [INFO] [1677694796.706907595] [destination_server]: Fluent Bit service initialized
[component_container_isolated-1] [INFO] [1677694796.707868171] [destination_server]: Creating destination plugin flb_stdout: Type dc_destinations/FlbStdout, Debug: 0, Time format: double. Time key: date
[component_container_isolated-1] [INFO] [1677694796.709554983] [destination_server]: Configuring Flb plugin flb_stdout
[component_container_isolated-1] [INFO] [1677694796.710263626] [destination_server]: Loaded lua filter. Match=ros2, code=function concatenate(tag, timestamp, record) if (type(record[&quot;tags&quot;]) == &quot;table&quot;) then record[&quot;tags&quot;] = table.concat(record[&quot;tags&quot;], &quot;,&quot;) end  return 2, timestamp, record end
[component_container_isolated-1] [INFO] [1677694796.710309154] [destination_server]: Loaded rewrite_tag filter. Match=ros2, Rule=$tags .*(flb_stdout).* flb_stdout true
[component_container_isolated-1] [INFO] [1677694796.710382723] [destination_server]: Done configuring Flb plugin flb_stdout
[component_container_isolated-1] [INFO] [1677694796.710401937] [destination_server]: Loading input ros2 shared library /root/ws/install/fluent_bit_plugins/lib/flb-in_ros2.so...
[component_container_isolated-1] [INFO] [1677694796.711494520] [destination_server]: Loaded input ros2 shared library /root/ws/install/fluent_bit_plugins/lib/flb-in_ros2.so
[component_container_isolated-1] [INFO] [1677694796.711617719] [destination_server]: Flb ros2 plugin initialized. ret=0
[component_container_isolated-1] [INFO] [1677694796.711638189] [destination_server]: Starting Flb engine...
[component_container_isolated-1] [2023/03/01 18:19:56] [ info] [fluent bit] version=2.0.7, commit=1ab360f79c, pid=79925
[component_container_isolated-1] [2023/03/01 18:19:56] [ info] [storage] ver=1.3.0, type=memory+filesystem, sync=full, checksum=off, max_chunks_up=128
[component_container_isolated-1] [2023/03/01 18:19:56] [ info] [storage] backlog input plugin: storage_backlog.1
[component_container_isolated-1] [2023/03/01 18:19:56] [ info] [cmetrics] version=0.5.7
[component_container_isolated-1] [2023/03/01 18:19:56] [ info] [ctraces ] version=0.2.5
[component_container_isolated-1] [2023/03/01 18:19:56] [ info] [input:ros2:ros2.0] initializing
[component_container_isolated-1] [2023/03/01 18:19:56] [ info] [input:ros2:ros2.0] storage_strategy='filesystem' (memory + filesystem)
[component_container_isolated-1] [2023/03/01 18:19:56] [ info] Started node fluentbit_rclc
[component_container_isolated-1] [2023/03/01 18:19:56] [ info] Created subscriber /dc/group/robot
[component_container_isolated-1] [2023/03/01 18:19:56] [ info] Created subscriber /dc/measurement/map
[component_container_isolated-1] [2023/03/01 18:19:56] [ info] [input:storage_backlog:storage_backlog.1] initializing
[component_container_isolated-1] [2023/03/01 18:19:56] [ info] [input:storage_backlog:storage_backlog.1] storage_strategy='memory' (memory only)
[component_container_isolated-1] [2023/03/01 18:19:56] [ info] [input:storage_backlog:storage_backlog.1] queue memory limit: 976.6K
[component_container_isolated-1] [2023/03/01 18:19:56] [ info] [input:emitter:emitter_for_rewrite_tag.2] initializing
[component_container_isolated-1] [2023/03/01 18:19:56] [ info] [input:emitter:emitter_for_rewrite_tag.2] storage_strategy='filesystem' (memory + filesystem)
[component_container_isolated-1] [2023/03/01 18:19:56] [ info] [output:stdout:stdout.0] worker #0 started
[component_container_isolated-1] [2023/03/01 18:19:56] [ info] [http_server] listen iface=0.0.0.0 tcp_port=2020
[component_container_isolated-1] [2023/03/01 18:19:56] [ info] [sp] stream processor started
[component_container_isolated-1] [INFO] [1677694796.763937083] [destination_server]: Started Flb engine
</code></pre>
<p>All the same as with previous demos:</p>
<p>It starts the <a href="../destinations/flb_stdout.html">FlbStdout destination plugin</a>, filters used internally by Fluent to edit Timestamps and tags. It then loads the ROS 2 Fluent Bit shared library and initialize it with the topics we provided as parameter.</p>
<p>Afterward, Fluent Bit starts, it prints its version, storage strategy and buffer configuration and lists which plugins are loaded.</p>
<p>Then, the measurement and destination server nodes are activated:</p>
<pre><code>[component_container_isolated-1] [INFO] [1677668906.745180268] [lifecycle_manager_navigation]: Activating measurement_server
[component_container_isolated-1] [INFO] [1677668906.745462265] [measurement_server]: Activating
[component_container_isolated-1] [INFO] [1677668906.745558665] [measurement_server]: Activating uptime
[component_container_isolated-1] [INFO] [1677668906.746014639] [measurement_server]: Creating bond (measurement_server) to lifecycle manager.
[component_container_isolated-1] [INFO] [1677668906.853199899] [lifecycle_manager_navigation]: Server measurement_server connected with bond.
[component_container_isolated-1] [INFO] [1677668906.853316226] [lifecycle_manager_navigation]: Activating destination_server
[component_container_isolated-1] [INFO] [1677668906.853620571] [destination_server]: Activating
[component_container_isolated-1] [INFO] [1677668906.853722659] [destination_server]: Activating flb_stdout
[component_container_isolated-1] [INFO] [1677668906.853796078] [destination_server]: Creating bond (destination_server) to lifecycle manager.
[component_container_isolated-1] [INFO] [1677668906.961666207] [lifecycle_manager_navigation]: Server destination_server connected with bond.
[component_container_isolated-1] [INFO] [1677668906.961777773] [lifecycle_manager_navigation]: Managed nodes are active
[component_container_isolated-1] [INFO] [1677668906.961820078] [lifecycle_manager_navigation]: Creating bond timer...
</code></pre>
<p>Finally, we see the data:</p>
<pre><code>[component_container_isolated-1] [{&quot;remote_paths&quot;:{&quot;minio&quot;:{&quot;pgm&quot;:&quot;C3PO/2023/03/01/18/map/2023-03-01T18:19:56.pgm&quot;,&quot;yaml&quot;:&quot;C3PO/2023/03/01/18/map/2023-03-01T18:19:56.yaml&quot;}},&quot;date&quot;:1677694796.765904,&quot;height&quot;:384,&quot;name&quot;:&quot;map&quot;,&quot;origin&quot;:{&quot;x&quot;:-10,&quot;y&quot;:-10},&quot;local_paths&quot;:{&quot;pgm&quot;:&quot;/root/dc_data/C3PO/2023/03/01/18/map/2023-03-01T18:19:56.pgm&quot;,&quot;yaml&quot;:&quot;/root/dc_data/C3PO/2023/03/01/18/map/2023-03-01T18:19:56.yaml&quot;},&quot;resolution&quot;:0.05000000074505806,&quot;width&quot;:384,&quot;id&quot;:&quot;be781e5ffb1e7ee4f817fe7b63e92c32&quot;,&quot;robot_name&quot;:&quot;C3PO&quot;,&quot;run_id&quot;:&quot;240&quot;}]
[component_container_isolated-1] [{&quot;cmd_vel&quot;:{&quot;linear&quot;:{&quot;x&quot;:0.246316,&quot;y&quot;:0,&quot;z&quot;:0},&quot;angular&quot;:{&quot;x&quot;:0,&quot;y&quot;:0,&quot;z&quot;:0.263158}},&quot;date&quot;:1677694799.685468,&quot;position&quot;:{&quot;x&quot;:-0.6033772358727438,&quot;yaw&quot;:-0.7146495585355921,&quot;y&quot;:-1.633862970534114},&quot;speed&quot;:{&quot;angular&quot;:{&quot;x&quot;:-0.0002542699063698451},&quot;computed&quot;:3.279051750818494e-05,&quot;linear&quot;:{&quot;x&quot;:3.244397182637543e-05,&quot;y&quot;:4.754653571390878e-06,&quot;z&quot;:0}},&quot;name&quot;:&quot;robot&quot;,&quot;id&quot;:&quot;be781e5ffb1e7ee4f817fe7b63e92c32&quot;,&quot;robot_name&quot;:&quot;C3PO&quot;,&quot;run_id&quot;:&quot;240&quot;}]
[component_container_isolated-1] [{&quot;cmd_vel&quot;:{&quot;linear&quot;:{&quot;x&quot;:0.246316,&quot;y&quot;:0,&quot;z&quot;:0},&quot;angular&quot;:{&quot;x&quot;:0,&quot;y&quot;:0,&quot;z&quot;:0.263158}},&quot;date&quot;:1677694800.685094,&quot;position&quot;:{&quot;x&quot;:-0.5307920077356227,&quot;yaw&quot;:-0.645872441707418,&quot;y&quot;:-1.693502983783379},&quot;speed&quot;:{&quot;angular&quot;:{&quot;x&quot;:0.2127361022319145},&quot;computed&quot;:0.2459393937023935,&quot;linear&quot;:{&quot;x&quot;:0.2459393844826374,&quot;y&quot;:-6.734242603700924e-05,&quot;z&quot;:0}},&quot;name&quot;:&quot;robot&quot;,&quot;id&quot;:&quot;be781e5ffb1e7ee4f817fe7b63e92c32&quot;,&quot;robot_name&quot;:&quot;C3PO&quot;,&quot;run_id&quot;:&quot;240&quot;}]
[component_container_isolated-1] [{&quot;cmd_vel&quot;:{&quot;linear&quot;:{&quot;x&quot;:0.26,&quot;y&quot;:0,&quot;z&quot;:0},&quot;angular&quot;:{&quot;x&quot;:0,&quot;y&quot;:0,&quot;z&quot;:0.368421}},&quot;date&quot;:1677694801.685017,&quot;position&quot;:{&quot;x&quot;:-0.3195900881047479,&quot;yaw&quot;:-0.3944485529461182,&quot;y&quot;:-1.813946939716471},&quot;speed&quot;:{&quot;angular&quot;:{&quot;x&quot;:0.2623361481938653},&quot;computed&quot;:0.24584231041888,&quot;linear&quot;:{&quot;x&quot;:0.2458423037516516,&quot;y&quot;:-5.725533732485466e-05,&quot;z&quot;:0}},&quot;name&quot;:&quot;robot&quot;,&quot;id&quot;:&quot;be781e5ffb1e7ee4f817fe7b63e92c32&quot;,&quot;robot_name&quot;:&quot;C3PO&quot;,&quot;run_id&quot;:&quot;240&quot;}]
</code></pre>
<p>So...what happened?</p>
<ol>
<li>The Nav2 turtlebot3 simulation starts, a robot is able to localize and move (once you use the 2-D pose estimate on RViz)</li>
<li>The measurement plugins start publishing data to /dc/measurement/map, /dc/measurement/cmd_vel, /dc/measurement/position and /dc/measurement/speed, which contain the JSONs, tags and timestamp of the message</li>
<li>In parallel, each time the map plugin sends a ROS message, it also saves the files on the filesystem. Open a file browser to the path you set in the configuration to a path mentioned in the map JSON</li>
<li>The &quot;robot&quot; group node subscribes to /dc/measurement/cmd_vel, /dc/measurement/position and /dc/measurement/speed and publish on /dc/group/robot when it collects data from all 3 topics</li>
<li>Run ID and robot_name is appended in the JSON of each</li>
<li>The ROS 2 Fluent Bit plugin, which subscribes to the topics, receive the data and pass it on to Fluent Bit</li>
<li>Fluent Bit receives it, applies the timestamp filter (which modifies the timestamp to the desired format)</li>
<li>Fluent Bit applies changes the tag with another filter. This tag is used to match to the destination afterward.</li>
<li>Data is flushed</li>
<li>The Fluent Bit stdout output plugin receives the data because tags match (the flb_stdout tag is used) and forwards it to Stdout</li>
</ol>
<footer id="open-on-gh">Found a bug? <a href="https://github.com/minipada/ros2_data_collection/edit/main/doc/src/dc/demos/tb3_stdout.md">Edit this page on GitHub.</a></footer>
                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../../dc/demos/memory_uptime_stdout.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next" href="../../dc/demos/tb3_aws_minio_pgsql.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../../dc/demos/memory_uptime_stdout.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next" href="../../dc/demos/tb3_aws_minio_pgsql.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>



        <script>
            window.playground_line_numbers = true;
        </script>

        <script>
            window.playground_copyable = true;
        </script>

        <script src="../../ace.js"></script>
        <script src="../../editor.js"></script>
        <script src="../../mode-rust.js"></script>
        <script src="../../theme-dawn.js"></script>
        <script src="../../theme-tomorrow_night.js"></script>

        <script src="../../elasticlunr.min.js"></script>
        <script src="../../mark.min.js"></script>
        <script src="../../searcher.js"></script>

        <script src="../../clipboard.min.js"></script>
        <script src="../../highlight.js"></script>
        <script src="../../book.js"></script>

        <!-- Custom JS scripts -->
        <script src="../../js/mermaid.js"></script>
        <script src="../../js/mermaid-init.js"></script>
        <script src="../../js/theme.js"></script>


    </body>
</html>
